<!DOCTYPE html>
<html lang="en">

<head><meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<link href="https://fonts.googleapis.com/css?family=Merriweather:300|Raleway:400,700" rel="stylesheet">
<link rel="stylesheet" href="/infra-blog/assets/css/style.css">
<link rel="stylesheet" href="/infra-blog/assets/css/post-detail.css">
<style>
/* Post Detail Page Styling */
.post-container article {
  background: #fff;
  border-radius: 12px;
  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
  padding: 40px;
  margin: 30px auto;
  max-width: 800px;
}

@media screen and (max-width: 768px) {
  .post-container article {
    margin: 20px;
    padding: 25px;
    border-radius: 8px;
  }
}

.post-container article .post-header {
  border-bottom: 2px solid #f5f5f5;
  padding-bottom: 25px;
  margin-bottom: 30px;
}

.post-container article .post-header .post-title {
  font-size: 2.2em;
  font-weight: 700;
  color: #2c3e50;
  line-height: 1.3;
  margin-bottom: 15px;
}

@media screen and (max-width: 768px) {
  .post-container article .post-header .post-title {
    font-size: 1.8em;
  }
}

.post-container article .post-header .post-meta {
  display: flex;
  align-items: center;
  gap: 20px;
  flex-wrap: wrap;
}

.post-container article .post-header .post-meta .post-date {
  display: flex;
  align-items: center;
  color: #666;
  font-size: 0.9em;
}

.post-container article .post-header .post-meta .post-date i {
  margin-right: 8px;
  color: #888;
}

.post-container article .post-header .post-meta .post-categories-wrapper {
  display: flex;
  align-items: center;
}

.post-container article .post-header .post-meta .post-categories-wrapper i {
  margin-right: 8px;
  color: #888;
}

.post-container article .post-header .post-meta .post-categories-wrapper .post-categories {
  display: flex;
  gap: 8px;
  list-style: none;
  margin: 0;
  padding: 0;
}

.post-container article .post-header .post-meta .post-categories-wrapper .post-categories li {
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  color: white;
  padding: 4px 12px;
  border-radius: 20px;
  font-size: 0.8em;
  font-weight: 500;
  text-transform: capitalize;
}

.post-container article .post-content {
  font-size: 1.1em;
  line-height: 1.8;
  color: #333;
}

.post-container article .post-content p {
  margin-bottom: 1.2em;
}

.post-container article .post-content h1,
.post-container article .post-content h2,
.post-container article .post-content h3,
.post-container article .post-content h4,
.post-container article .post-content h5,
.post-container article .post-content h6 {
  color: #2c3e50;
  margin: 1.5em 0 0.8em 0;
  font-weight: 600;
}

.post-container article .post-content h2 {
  font-size: 1.8em;
  border-bottom: 2px solid #3498db;
  padding-bottom: 10px;
}

.post-container article .post-content h3 {
  font-size: 1.5em;
  color: #34495e;
}

.post-container article .post-content code {
  background: #f8f9fa;
  padding: 2px 6px;
  border-radius: 4px;
  font-size: 0.9em;
  color: #e74c3c;
}

.post-container article .post-content pre {
  background: #f8f9fa;
  border: 1px solid #e9ecef;
  border-radius: 6px;
  padding: 15px;
  overflow-x: auto;
  margin: 1.5em 0;
}

.post-container article .post-content pre code {
  background: none;
  color: #333;
  padding: 0;
}

.post-container article .post-content blockquote {
  border-left: 4px solid #3498db;
  background: #f8f9fa;
  padding: 15px 20px;
  margin: 1.5em 0;
  font-style: italic;
  color: #555;
}

.post-container article .post-content img {
  max-width: 100%;
  height: auto;
  border-radius: 8px;
  margin: 1.5em 0;
  box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
}

.post-container article .post-content ul,
.post-container article .post-content ol {
  padding-left: 1.5em;
  margin-bottom: 1.2em;
}

.post-container article .post-content ul li,
.post-container article .post-content ol li {
  margin-bottom: 0.5em;
}

.post-container article .post-content a {
  color: #3498db;
  text-decoration: none;
  border-bottom: 1px solid transparent;
  transition: all 0.3s ease;
}

.post-container article .post-content a:hover {
  border-bottom-color: #3498db;
}

.post-container article .post-footer {
  border-top: 2px solid #f5f5f5;
  padding-top: 25px;
  margin-top: 40px;
}

.post-container article .post-footer .post-navigation {
  display: flex;
  justify-content: space-between;
  align-items: center;
  gap: 20px;
}

@media screen and (max-width: 768px) {
  .post-container article .post-footer .post-navigation {
    flex-direction: column;
    gap: 15px;
  }
}

.post-container article .post-footer .post-navigation .nav-previous,
.post-container article .post-footer .post-navigation .nav-next {
  flex: 1;
}

.post-container article .post-footer .post-navigation .nav-previous a,
.post-container article .post-footer .post-navigation .nav-next a {
  display: flex;
  align-items: center;
  padding: 15px 20px;
  background: #f8f9fa;
  border-radius: 8px;
  text-decoration: none;
  color: #333;
  transition: all 0.3s ease;
  border: 2px solid transparent;
}

.post-container article .post-footer .post-navigation .nav-previous a:hover,
.post-container article .post-footer .post-navigation .nav-next a:hover {
  background: #e9ecef;
  border-color: #3498db;
  transform: translateY(-2px);
}

.post-container article .post-footer .post-navigation .nav-previous a i,
.post-container article .post-footer .post-navigation .nav-next a i {
  color: #3498db;
  margin: 0 8px;
}

.post-container article .post-footer .post-navigation .nav-previous a .nav-title,
.post-container article .post-footer .post-navigation .nav-next a .nav-title {
  font-weight: 500;
}

.post-container article .post-footer .post-navigation .nav-previous a {
  justify-content: flex-start;
}

.post-container article .post-footer .post-navigation .nav-next a {
  justify-content: flex-end;
  text-align: right;
}
</style>
<title>ë„¤íŠ¸ì›Œí‚¹ ì™„ì „ ê°€ì´ë“œ 5í¸ - ë„¤íŠ¸ì›Œí¬ ë³´ì•ˆê³¼ íŠ¸ëŸ¬ë¸”ìŠˆíŒ… | Complete Network Guide Part 5 - Network Security & Troubleshooting</title>

<script type="text/javascript" src="/infra-blog/assets/js/darkmode.js"></script>

</head><body>
  <main class="container">
    <section class="about">
      <div class="about-header condensed">
      <div class="about-title">
      <a href="/infra-blog/">
        
        <img src="/infra-blog/assets/portfolio.png" alt="Infrastructure Engineer" />
        
      </a>
      <h2 id="title">
        <a href="/infra-blog/">Infrastructure Engineer</a>
      </h2>
      </div><p class="tagline">DevOps & Cloud Infrastructure Specialist</p></div>
      
      <ul class="social about-footer condensed"><a href="https://github.com/leeyonghe" target="_blank">
          <li>
            <i class="icon-github-circled"></i>
          </li>
        </a><a href="https://www.linkedin.com/in/lee-yong-hee-18912454/" target="_blank">
          <li>
            <i class="icon-linkedin-squared"></i>
          </li>
        </a><!----></ul><p class="about-footer condensed">&copy;
        2025</p><div class="about-footer condensed">
        <p>Dark Mode
          <i class="icon-moon"></i>
          <label class="switch">
            <input type="checkbox" class="dark-mode-toggle">
            <span class="slider round" onclick="toggleDarkMode()"></span>
          </label>
        </p>
      </div>
    </section>
    <section class="content">
      <style>
/* Post Detail Page Styling - Direct Inline */
.post-container article {
  background: #fff !important;
  border: none !important;
  border-top: none !important;
  border-right: none !important;
  border-bottom: none !important;
  border-left: none !important;
  border-width: 0 !important;
  border-style: none !important;
  outline: none !important;
  border-radius: 12px !important;
  box-shadow: none !important;
  padding: 40px !important;
  margin: 30px auto !important;
  max-width: 800px !important;
}

.post-container article .post-header .post-title {
  font-size: 2.2em !important;
  font-weight: 700 !important;
  color: #2c3e50 !important;
  line-height: 1.3 !important;
}

.post-container article .post-header {
  border-bottom: none !important;
  padding-bottom: 25px !important;
  margin-bottom: 30px !important;
}

.post-container article .post-content {
  font-size: 1.1em !important;
  line-height: 1.8 !important;
  color: #333 !important;
}

.post-container article .post-content h2 {
  font-size: 1.8em !important;
  border-bottom: none !important;
  padding-bottom: 10px !important;
  color: #2c3e50 !important;
}

.post-container article .post-header .post-meta .post-categories li {
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%) !important;
  color: white !important;
  padding: 4px 12px !important;
  border-radius: 20px !important;
  font-size: 0.8em !important;
  list-style: none !important;
  display: inline-block !important;
  margin-right: 8px !important;
}

.post-container article .post-footer {
  border-top: none !important;
  padding-top: 25px !important;
  margin-top: 40px !important;
}

/* ëª¨ë“  borderì™€ box-shadow ê°•ì œ ì œê±° */
.post-container article *,
.post-container article *::before,
.post-container article *::after {
  border: none !important;
  border-top: none !important;
  border-right: none !important;
  border-bottom: none !important;
  border-left: none !important;
  border-width: 0 !important;
  border-style: none !important;
  outline: none !important;
  box-shadow: none !important;
}

/* ì½”ë“œ ë¸”ë¡ê³¼ pre íƒœê·¸ë„ border, box-shadow ì œê±° */
.post-container article pre,
.post-container article code,
.post-container article .highlight,
.post-container article .highlighter-rouge {
  border: none !important;
  outline: none !important;
  box-shadow: none !important;
}
</style><div class="post-container">
  <article>
    <header class="post-header">
    <h1 class="post-title">ë„¤íŠ¸ì›Œí‚¹ ì™„ì „ ê°€ì´ë“œ 5í¸ - ë„¤íŠ¸ì›Œí¬ ë³´ì•ˆê³¼ íŠ¸ëŸ¬ë¸”ìŠˆíŒ… | Complete Network Guide Part 5 - Network Security &amp; Troubleshooting</h1>
    <div class="post-meta">
      <div class="post-date">
        <i class="icon-calendar"></i>
        <time datetime="2025-03-07T03:00:00+00:00">Mar 7, 2025</time>
      </div><div class="post-categories-wrapper">
        <i class="icon-tag"></i>
        <ul class="post-categories"><li>Networking</li><li>Security</li></ul>
      </div></div>
  </header>

  <div class="post-content">
    <p>ë„¤íŠ¸ì›Œí¬ ë³´ì•ˆì˜ ìµœì‹  ê¸°ìˆ ê³¼ ê³ ê¸‰ íŠ¸ëŸ¬ë¸”ìŠˆíŒ… ê¸°ë²•ì„ ì‹¤ë¬´ ì¤‘ì‹¬ìœ¼ë¡œ ì™„ì „íˆ ë§ˆìŠ¤í„°í•´ë³´ê² ìŠµë‹ˆë‹¤.</p>

<h2 id="ì°¨ì„¸ëŒ€-ë°©í™”ë²½-ngfw--next-generation-firewall">ì°¨ì„¸ëŒ€ ë°©í™”ë²½ (NGFW) | Next-Generation Firewall</h2>

<h3 id="-ngfw-ê¸°ëŠ¥ê³¼-íŠ¹ì§•">ğŸ”¥ NGFW ê¸°ëŠ¥ê³¼ íŠ¹ì§•</h3>

<h4 id="ì „í†µ-ë°©í™”ë²½-vs-ngfw-ë¹„êµ">ì „í†µ ë°©í™”ë²½ vs NGFW ë¹„êµ</h4>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Traditional Firewall:
- L3/L4 íŒ¨í‚· í•„í„°ë§ <span class="o">(</span>IP, Port<span class="o">)</span>
- Stateful ì—°ê²° ì¶”ì 
- NAT/PAT ê¸°ëŠ¥

Next-Generation Firewall <span class="o">(</span>NGFW<span class="o">)</span>:
- Application Awareness <span class="o">(</span>L7<span class="o">)</span>
- Intrusion Prevention <span class="o">(</span>IPS<span class="o">)</span>
- SSL/TLS Decryption
- User Identity Integration
- Advanced Threat Protection
- Sandboxing
</code></pre></div></div>

<h4 id="palo-alto-ngfw-ì„¤ì •-ì‹¤ìŠµ">Palo Alto NGFW ì„¤ì • ì‹¤ìŠµ</h4>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># ë³´ì•ˆ ì •ì±… ì„¤ì •</span>
<span class="c"># ì• í”Œë¦¬ì¼€ì´ì…˜ ê¸°ë°˜ ì •ì±…</span>
configure
<span class="nb">set </span>rulebase security rules <span class="s2">"Allow-Office365"</span> from any
<span class="nb">set </span>rulebase security rules <span class="s2">"Allow-Office365"</span> to any
<span class="nb">set </span>rulebase security rules <span class="s2">"Allow-Office365"</span> <span class="nb">source </span>any
<span class="nb">set </span>rulebase security rules <span class="s2">"Allow-Office365"</span> destination any
<span class="nb">set </span>rulebase security rules <span class="s2">"Allow-Office365"</span> application <span class="o">[</span> ms-office365 outlook-web-access <span class="o">]</span>
<span class="nb">set </span>rulebase security rules <span class="s2">"Allow-Office365"</span> service application-default
<span class="nb">set </span>rulebase security rules <span class="s2">"Allow-Office365"</span> action allow

<span class="c"># ì‚¬ìš©ì ê¸°ë°˜ ì •ì±…</span>
<span class="nb">set </span>rulebase security rules <span class="s2">"Block-Social-Media"</span> from trust
<span class="nb">set </span>rulebase security rules <span class="s2">"Block-Social-Media"</span> to untrust
<span class="nb">set </span>rulebase security rules <span class="s2">"Block-Social-Media"</span> source-user <span class="o">[</span> <span class="s2">"DOMAIN</span><span class="se">\s</span><span class="s2">ales-team"</span> <span class="o">]</span>
<span class="nb">set </span>rulebase security rules <span class="s2">"Block-Social-Media"</span> application <span class="o">[</span> facebook twitter instagram <span class="o">]</span>
<span class="nb">set </span>rulebase security rules <span class="s2">"Block-Social-Media"</span> action deny

<span class="c"># SSL Decryption ì •ì±…</span>
<span class="nb">set </span>shared ssl-decrypt ssl-decrypt-policy <span class="s2">"Decrypt-Inbound"</span> rules <span class="s2">"web-traffic"</span>
<span class="nb">set </span>shared ssl-decrypt ssl-decrypt-policy <span class="s2">"Decrypt-Inbound"</span> rules <span class="s2">"web-traffic"</span> category <span class="o">[</span> <span class="s2">"business-and-economy"</span> <span class="s2">"computer-and-internet-info"</span> <span class="o">]</span>
<span class="nb">set </span>shared ssl-decrypt ssl-decrypt-policy <span class="s2">"Decrypt-Inbound"</span> rules <span class="s2">"web-traffic"</span> action decrypt
</code></pre></div></div>

<h4 id="pfsense-ì˜¤í”ˆì†ŒìŠ¤-ë°©í™”ë²½-ì„¤ì •">pfSense ì˜¤í”ˆì†ŒìŠ¤ ë°©í™”ë²½ ì„¤ì •</h4>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># pfSense íŒ¨í‚¤ì§€ ì„¤ì¹˜</span>
pkg <span class="nb">install </span>pfSense-pkg-suricata
pkg <span class="nb">install </span>pfSense-pkg-pfBlockerNG

<span class="c"># Suricata IPS ì„¤ì •</span>
<span class="c"># /usr/local/etc/suricata/suricata.yaml</span>
HOME_NET: <span class="s2">"[192.168.1.0/24,10.0.0.0/8]"</span>
EXTERNAL_NET: <span class="s2">"!</span><span class="nv">$HOME_NET</span><span class="s2">"</span>

rule-files:
  - emerging-threats.rules
  - botcc.rules
  - emerging-malware.rules

<span class="c"># ì‚¬ìš©ì ì •ì˜ ë£°</span>
<span class="c"># /usr/local/etc/suricata/rules/local.rules</span>
alert tcp <span class="nv">$HOME_NET</span> any -&gt; <span class="nv">$EXTERNAL_NET</span> 80 <span class="o">(</span>msg:<span class="s2">"HTTP outbound connection"</span><span class="p">;</span> sid:1000001<span class="p">;</span> rev:1<span class="p">;</span><span class="o">)</span>
alert tcp any any -&gt; <span class="nv">$HOME_NET</span> 22 <span class="o">(</span>msg:<span class="s2">"SSH connection attempt"</span><span class="p">;</span> threshold: <span class="nb">type </span>both, track by_src, count 5, seconds 60<span class="p">;</span> sid:1000002<span class="p">;</span> rev:1<span class="p">;</span><span class="o">)</span>

<span class="c"># pfBlockerNG GeoIP ì°¨ë‹¨</span>
<span class="c"># ëŸ¬ì‹œì•„, ì¤‘êµ­, ë¶í•œ IP ëŒ€ì—­ ì°¨ë‹¨</span>
Asia_Russia: Deny_Inbound, Deny_Outbound
Asia_China: Deny_Inbound, Permit_Outbound
Asia_North_Korea: Deny_Both
</code></pre></div></div>

<h3 id="ï¸-idsips-ì‹œìŠ¤í…œ">ğŸ›¡ï¸ IDS/IPS ì‹œìŠ¤í…œ</h3>

<h4 id="suricata-idsips-ë°°í¬">Suricata IDS/IPS ë°°í¬</h4>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Suricata ì„¤ì¹˜ (Ubuntu)</span>
<span class="nb">sudo </span>add-apt-repository ppa:oisf/suricata-stable
<span class="nb">sudo </span>apt update
<span class="nb">sudo </span>apt <span class="nb">install </span>suricata

<span class="c"># ë„¤íŠ¸ì›Œí¬ ì¸í„°í˜ì´ìŠ¤ ì„¤ì •</span>
<span class="c"># /etc/suricata/suricata.yaml</span>
af-packet:
  - interface: eth0
    cluster-id: 99
    cluster-type: cluster_flow
    defrag: <span class="nb">yes
    </span>use-mmap: <span class="nb">yes
    </span>mmap-locked: <span class="nb">yes</span>

<span class="c"># ë£°ì…‹ ì—…ë°ì´íŠ¸</span>
<span class="nb">sudo </span>suricata-update
<span class="nb">sudo </span>suricata-update list-sources
<span class="nb">sudo </span>suricata-update enable-source et/pro  <span class="c"># Emerging Threats Pro</span>
<span class="nb">sudo </span>suricata-update enable-source ptresearch/attackdetection

<span class="c"># ì»¤ìŠ¤í…€ ë£° ì‘ì„±</span>
<span class="c"># /etc/suricata/rules/local.rules</span>
<span class="c"># DDoS ê³µê²© íƒì§€</span>
alert tcp any any -&gt; <span class="nv">$HOME_NET</span> any <span class="o">(</span>msg:<span class="s2">"Possible DDoS attack"</span><span class="p">;</span> flags:S<span class="p">;</span> threshold: <span class="nb">type </span>both, track by_src, count 100, seconds 10<span class="p">;</span> sid:1000003<span class="p">;</span> rev:1<span class="p">;</span><span class="o">)</span>

<span class="c"># SQL ì¸ì ì…˜ íƒì§€  </span>
alert http any any -&gt; <span class="nv">$HOME_NET</span> any <span class="o">(</span>msg:<span class="s2">"SQL Injection Attack"</span><span class="p">;</span> content:<span class="s2">"union select"</span><span class="p">;</span> nocase<span class="p">;</span> http_uri<span class="p">;</span> sid:1000004<span class="p">;</span> rev:1<span class="p">;</span><span class="o">)</span>

<span class="c"># í¬ë¦¬ë´ì…œ ìŠ¤í„°í•‘ íƒì§€</span>
alert http any any -&gt; <span class="nv">$HOME_NET</span> any <span class="o">(</span>msg:<span class="s2">"Credential Stuffing Attack"</span><span class="p">;</span> content:<span class="s2">"POST"</span><span class="p">;</span> http_method<span class="p">;</span> threshold: <span class="nb">type </span>both, track by_src, count 50, seconds 60<span class="p">;</span> sid:1000005<span class="p">;</span> rev:1<span class="p">;</span><span class="o">)</span>
</code></pre></div></div>

<h4 id="zeek-bro-ë„¤íŠ¸ì›Œí¬-ë¶„ì„">Zeek (Bro) ë„¤íŠ¸ì›Œí¬ ë¶„ì„</h4>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Zeek ì„¤ì¹˜</span>
<span class="nb">sudo </span>apt <span class="nb">install </span>zeek

<span class="c"># ë„¤íŠ¸ì›Œí¬ ì¸í„°í˜ì´ìŠ¤ ì„¤ì •</span>
<span class="c"># /opt/zeek/etc/node.cfg</span>
<span class="o">[</span>zeek]
<span class="nb">type</span><span class="o">=</span>standalone
<span class="nv">host</span><span class="o">=</span>localhost
<span class="nv">interface</span><span class="o">=</span>eth0

<span class="c"># ì»¤ìŠ¤í…€ ìŠ¤í¬ë¦½íŠ¸ ì‘ì„±</span>
<span class="c"># /opt/zeek/share/zeek/site/local.zeek</span>
@load base/protocols/http
@load base/protocols/dns
@load base/protocols/ssl

<span class="c"># HTTP íŠ¸ë˜í”½ ëª¨ë‹ˆí„°ë§</span>
event http_request<span class="o">(</span>c: connection, method: string, original_URI: string, unescaped_URI: string, version: string<span class="o">)</span>
<span class="o">{</span>
    <span class="k">if</span> <span class="o">(</span> /<span class="se">\.</span><span class="o">(</span>exe|zip|rar|7z<span class="o">)</span><span class="nv">$/</span> <span class="k">in </span>unescaped_URI <span class="o">)</span>
        print <span class="nb">fmt</span><span class="o">(</span><span class="s2">"%s ë‹¤ìš´ë¡œë“œ: %s -&gt; %s%s"</span>, 
                 strftime<span class="o">(</span><span class="s2">"%Y-%m-%d %H:%M:%S"</span>, network_time<span class="o">())</span>, 
                 c<span class="nv">$id$orig_h</span>, c<span class="nv">$id$resp_h</span>, unescaped_URI<span class="o">)</span><span class="p">;</span>
<span class="o">}</span>

<span class="c"># DNS ëª¨ë‹ˆí„°ë§</span>
event dns_request<span class="o">(</span>c: connection, msg: dns_msg, query: string, qtype: count, qclass: count<span class="o">)</span>
<span class="o">{</span>
    <span class="k">if</span> <span class="o">(</span> /[0-9]<span class="o">{</span>1,3<span class="o">}</span><span class="se">\.</span><span class="o">[</span>0-9]<span class="o">{</span>1,3<span class="o">}</span><span class="se">\.</span><span class="o">[</span>0-9]<span class="o">{</span>1,3<span class="o">}</span><span class="se">\.</span><span class="o">[</span>0-9]<span class="o">{</span>1,3<span class="o">}</span><span class="se">\.</span><span class="k">in</span><span class="nt">-addr</span><span class="se">\.</span>arpa/ <span class="o">!</span><span class="k">in </span>query <span class="o">)</span>
    <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span> /<span class="se">\.</span>tk<span class="nv">$|</span><span class="se">\.</span>ml<span class="nv">$|</span><span class="se">\.</span>ga<span class="nv">$|</span><span class="se">\.</span>cf<span class="nv">$/</span> <span class="k">in </span>query <span class="o">)</span>
            print <span class="nb">fmt</span><span class="o">(</span><span class="s2">"ì˜ì‹¬ìŠ¤ëŸ¬ìš´ ë„ë©”ì¸ ì§ˆì˜: %s -&gt; %s"</span>, c<span class="nv">$id$orig_h</span>, query<span class="o">)</span><span class="p">;</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="c"># ì„œë¹„ìŠ¤ ì‹œì‘</span>
<span class="nb">sudo </span>zeekctl deploy
<span class="nb">sudo </span>zeekctl status
</code></pre></div></div>

<h2 id="ì œë¡œ-íŠ¸ëŸ¬ìŠ¤íŠ¸-ë„¤íŠ¸ì›Œí¬--zero-trust-network">ì œë¡œ íŠ¸ëŸ¬ìŠ¤íŠ¸ ë„¤íŠ¸ì›Œí¬ | Zero Trust Network</h2>

<h3 id="-ì œë¡œ-íŠ¸ëŸ¬ìŠ¤íŠ¸-ì•„í‚¤í…ì²˜">ğŸ”’ ì œë¡œ íŠ¸ëŸ¬ìŠ¤íŠ¸ ì•„í‚¤í…ì²˜</h3>

<h4 id="ì œë¡œ-íŠ¸ëŸ¬ìŠ¤íŠ¸-ì›ì¹™">ì œë¡œ íŠ¸ëŸ¬ìŠ¤íŠ¸ ì›ì¹™</h4>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Never Trust, Always Verify:
- ê¸°ë³¸ì ìœ¼ë¡œ ëª¨ë“  íŠ¸ë˜í”½ ì°¨ë‹¨
- ëª…ì‹œì  ê²€ì¦ê³¼ ì¸ê°€
- ìµœì†Œ ê¶Œí•œ ì›ì¹™

Verify Explicitly:
- ì‚¬ìš©ì ì‹ ì› í™•ì¸
- ë””ë°”ì´ìŠ¤ ìƒíƒœ ê²€ì¦
- ë„¤íŠ¸ì›Œí¬ ìœ„ì¹˜ ë¬´ê´€

Least Privileged Access:
- Just-in-Time <span class="o">(</span>JIT<span class="o">)</span> ì•¡ì„¸ìŠ¤
- Just-Enough-Access <span class="o">(</span>JEA<span class="o">)</span>
- ìœ„í—˜ ê¸°ë°˜ ì ì‘í˜• ì •ì±…

Assume Breach:
- ì„¸ê·¸ë©˜í…Œì´ì…˜ê³¼ ê²©ë¦¬
- íš¡ì  ì´ë™ ì°¨ë‹¨
- ì§€ì†ì  ëª¨ë‹ˆí„°ë§
</code></pre></div></div>

<h4 id="ë§ˆì´í¬ë¡œ-ì„¸ê·¸ë©˜í…Œì´ì…˜-êµ¬í˜„">ë§ˆì´í¬ë¡œ ì„¸ê·¸ë©˜í…Œì´ì…˜ êµ¬í˜„</h4>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Cisco ACI ë§ˆì´í¬ë¡œ ì„¸ê·¸ë©˜í…Œì´ì…˜</span>
<span class="c"># ì• í”Œë¦¬ì¼€ì´ì…˜ í”„ë¡œíŒŒì¼ ìƒì„±</span>
apic1# configure
apic1<span class="o">(</span>config<span class="o">)</span><span class="c"># tenant production</span>
apic1<span class="o">(</span>config-tenant<span class="o">)</span><span class="c"># application app-web</span>
apic1<span class="o">(</span>config-tenant-app<span class="o">)</span><span class="c"># epg web-tier</span>
apic1<span class="o">(</span>config-tenant-app-epg<span class="o">)</span><span class="c"># bridge-domain web-bd</span>
apic1<span class="o">(</span>config-tenant-app-epg<span class="o">)</span><span class="c"># exit</span>

<span class="c"># ê³„ì•½ (Contract) ì •ì˜</span>
apic1<span class="o">(</span>config-tenant-app<span class="o">)</span><span class="c"># contract web-to-db</span>
apic1<span class="o">(</span>config-tenant-app-contract<span class="o">)</span><span class="c"># subject db-access</span>
apic1<span class="o">(</span>config-tenant-app-contract-subject<span class="o">)</span><span class="c"># filter mysql-filter</span>
apic1<span class="o">(</span>config-tenant-app-contract-subject-filter<span class="o">)</span><span class="c"># entry mysql</span>
apic1<span class="o">(</span>config-tenant-app-contract-subject-filter-entry<span class="o">)</span><span class="c"># ether-type ip</span>
apic1<span class="o">(</span>config-tenant-app-contract-subject-filter-entry<span class="o">)</span><span class="c"># ip-protocol tcp</span>
apic1<span class="o">(</span>config-tenant-app-contract-subject-filter-entry<span class="o">)</span><span class="c"># destination-port-range from 3306 to 3306</span>

<span class="c"># VMware NSX ë§ˆì´í¬ë¡œ ì„¸ê·¸ë©˜í…Œì´ì…˜</span>
<span class="c"># ë¶„ì‚° ë°©í™”ë²½ ì •ì±…</span>
nsxcli&gt; configure firewall
nsxcli<span class="o">(</span>firewall<span class="o">)&gt;</span> add rule web-tier-protection
nsxcli<span class="o">(</span>firewall-rule<span class="o">)&gt;</span> <span class="nb">set source </span>security-group web-servers
nsxcli<span class="o">(</span>firewall-rule<span class="o">)&gt;</span> <span class="nb">set </span>destination security-group db-servers
nsxcli<span class="o">(</span>firewall-rule<span class="o">)&gt;</span> <span class="nb">set </span>service MYSQL
nsxcli<span class="o">(</span>firewall-rule<span class="o">)&gt;</span> <span class="nb">set </span>action allow
nsxcli<span class="o">(</span>firewall-rule<span class="o">)&gt;</span> <span class="nb">set </span>applied-to security-group web-servers
nsxcli<span class="o">(</span>firewall-rule<span class="o">)&gt;</span> commit
</code></pre></div></div>

<h4 id="kubernetes-ë„¤íŠ¸ì›Œí¬-ì •ì±…">Kubernetes ë„¤íŠ¸ì›Œí¬ ì •ì±…</h4>
<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># ë„¤ì„ìŠ¤í˜ì´ìŠ¤ ê²©ë¦¬ ì •ì±…</span>
<span class="na">apiVersion</span><span class="pi">:</span> <span class="s">networking.k8s.io/v1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">NetworkPolicy</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">default-deny-all</span>
  <span class="na">namespace</span><span class="pi">:</span> <span class="s">production</span>
<span class="na">spec</span><span class="pi">:</span>
  <span class="na">podSelector</span><span class="pi">:</span> <span class="pi">{}</span>
  <span class="na">policyTypes</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="s">Ingress</span>
  <span class="pi">-</span> <span class="s">Egress</span>

<span class="nn">---</span>
<span class="c1"># ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ ì •ì±…</span>
<span class="na">apiVersion</span><span class="pi">:</span> <span class="s">networking.k8s.io/v1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">NetworkPolicy</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">web-app-policy</span>
  <span class="na">namespace</span><span class="pi">:</span> <span class="s">production</span>
<span class="na">spec</span><span class="pi">:</span>
  <span class="na">podSelector</span><span class="pi">:</span>
    <span class="na">matchLabels</span><span class="pi">:</span>
      <span class="na">app</span><span class="pi">:</span> <span class="s">web-frontend</span>
  <span class="na">policyTypes</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="s">Ingress</span>
  <span class="pi">-</span> <span class="s">Egress</span>
  <span class="na">ingress</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="na">from</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">namespaceSelector</span><span class="pi">:</span>
        <span class="na">matchLabels</span><span class="pi">:</span>
          <span class="na">name</span><span class="pi">:</span> <span class="s">ingress-nginx</span>
    <span class="na">ports</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">protocol</span><span class="pi">:</span> <span class="s">TCP</span>
      <span class="na">port</span><span class="pi">:</span> <span class="m">8080</span>
  <span class="na">egress</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="na">to</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">podSelector</span><span class="pi">:</span>
        <span class="na">matchLabels</span><span class="pi">:</span>
          <span class="na">app</span><span class="pi">:</span> <span class="s">api-backend</span>
    <span class="na">ports</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">protocol</span><span class="pi">:</span> <span class="s">TCP</span>
      <span class="na">port</span><span class="pi">:</span> <span class="m">3000</span>
  <span class="pi">-</span> <span class="na">to</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">namespaceSelector</span><span class="pi">:</span>
        <span class="na">matchLabels</span><span class="pi">:</span>
          <span class="na">name</span><span class="pi">:</span> <span class="s">kube-system</span>
    <span class="na">ports</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">protocol</span><span class="pi">:</span> <span class="s">UDP</span>
      <span class="na">port</span><span class="pi">:</span> <span class="m">53</span>  <span class="c1"># DNS</span>

<span class="nn">---</span>
<span class="c1"># ë°ì´í„°ë² ì´ìŠ¤ ì •ì±…</span>
<span class="na">apiVersion</span><span class="pi">:</span> <span class="s">networking.k8s.io/v1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">NetworkPolicy</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">database-policy</span>
  <span class="na">namespace</span><span class="pi">:</span> <span class="s">production</span>
<span class="na">spec</span><span class="pi">:</span>
  <span class="na">podSelector</span><span class="pi">:</span>
    <span class="na">matchLabels</span><span class="pi">:</span>
      <span class="na">app</span><span class="pi">:</span> <span class="s">mysql-db</span>
  <span class="na">policyTypes</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="s">Ingress</span>
  <span class="na">ingress</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="na">from</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">podSelector</span><span class="pi">:</span>
        <span class="na">matchLabels</span><span class="pi">:</span>
          <span class="na">app</span><span class="pi">:</span> <span class="s">api-backend</span>
    <span class="na">ports</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">protocol</span><span class="pi">:</span> <span class="s">TCP</span>
      <span class="na">port</span><span class="pi">:</span> <span class="m">3306</span>
</code></pre></div></div>

<h2 id="ë„¤íŠ¸ì›Œí¬-í¬ë Œì‹--network-forensics">ë„¤íŠ¸ì›Œí¬ í¬ë Œì‹ | Network Forensics</h2>

<h3 id="-íŒ¨í‚·-ë¶„ì„ê³¼-ì¦ê±°-ìˆ˜ì§‘">ğŸ” íŒ¨í‚· ë¶„ì„ê³¼ ì¦ê±° ìˆ˜ì§‘</h3>

<h4 id="wireshark-ê³ ê¸‰-ë¶„ì„-ê¸°ë²•">Wireshark ê³ ê¸‰ ë¶„ì„ ê¸°ë²•</h4>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># ì˜ì‹¬ìŠ¤ëŸ¬ìš´ íŠ¸ë˜í”½ í•„í„°ë§</span>
<span class="c"># ëŒ€ëŸ‰ ë°ì´í„° ì „ì†¡ íƒì§€</span>
tcp.len <span class="o">&gt;</span> 1400 and ip.src <span class="o">==</span> 192.168.1.100

<span class="c"># DNS í„°ë„ë§ íƒì§€</span>
dns.qry.name contains <span class="s2">"."</span>
dns.qry.name matches <span class="s2">"^[a-f0-9]{20,}</span><span class="se">\\</span><span class="s2">."</span>

<span class="c"># HTTP POST ë°ì´í„° exfiltration</span>
http.request.method <span class="o">==</span> <span class="s2">"POST"</span> and http.content_length <span class="o">&gt;</span> 10000

<span class="c"># ë¹„ì •ìƒì ì¸ í¬íŠ¸ ì‚¬ìš©</span>
tcp.port <span class="o">==</span> 443 and not ssl.handshake.type
tcp.port <span class="o">==</span> 80 and ssl.handshake.type

<span class="c"># ì»¤ë§¨ë“œ ì•¤ ì»¨íŠ¸ë¡¤ í†µì‹  íŒ¨í„´</span>
<span class="o">(</span>tcp.flags.push <span class="o">==</span> 1<span class="o">)</span> and <span class="o">(</span>tcp.len &lt; 100<span class="o">)</span> and <span class="o">(</span>tcp.len <span class="o">&gt;</span> 10<span class="o">)</span>

<span class="c"># í†µê³„ ë¶„ì„ì„ ìœ„í•œ tshark ì‚¬ìš©</span>
<span class="c"># ìƒìœ„ í†µì‹  í˜¸ìŠ¤íŠ¸</span>
tshark <span class="nt">-r</span> capture.pcap <span class="nt">-q</span> <span class="nt">-z</span> conv,ip | <span class="nb">sort</span> <span class="nt">-k7</span> <span class="nt">-nr</span> | <span class="nb">head</span> <span class="nt">-20</span>

<span class="c"># í”„ë¡œí† ì½œ ë¶„í¬</span>
tshark <span class="nt">-r</span> capture.pcap <span class="nt">-q</span> <span class="nt">-z</span> prot,colinfo

<span class="c"># ì‹œê°„ë³„ íŠ¸ë˜í”½ ë¶„ì„</span>
tshark <span class="nt">-r</span> capture.pcap <span class="nt">-T</span> fields <span class="nt">-e</span> frame.time <span class="nt">-e</span> ip.src <span class="nt">-e</span> ip.dst <span class="nt">-e</span> tcp.srcport <span class="nt">-e</span> tcp.dstport | 
<span class="nb">awk</span> <span class="s1">'{print $1 " " $2 ":" $4 " -&gt; " $3 ":" $5}'</span> | <span class="nb">sort</span> | <span class="nb">uniq</span> <span class="nt">-c</span> | <span class="nb">sort</span> <span class="nt">-nr</span>
</code></pre></div></div>

<h4 id="ë„¤íŠ¸ì›Œí¬-í”Œë¡œìš°-ë¶„ì„-nfcapd">ë„¤íŠ¸ì›Œí¬ í”Œë¡œìš° ë¶„ì„ (nfcapd)</h4>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># nfcapd ì„¤ì • ë° ì‹œì‘</span>
nfcapd <span class="nt">-w</span> <span class="nt">-D</span> <span class="nt">-p</span> 9995 <span class="nt">-l</span> /var/cache/nfcapd

<span class="c"># ë¼ìš°í„°ì—ì„œ NetFlow í™œì„±í™” (Cisco)</span>
interface FastEthernet0/1
 ip flow ingress
 ip flow egress

ip flow-export <span class="nb">source </span>FastEthernet0/1
ip flow-export version 9
ip flow-export destination 192.168.1.100 9995

<span class="c"># í”Œë¡œìš° ë°ì´í„° ë¶„ì„</span>
<span class="c"># ìƒìœ„ í†µì‹ ëŸ‰ í˜¸ìŠ¤íŠ¸</span>
nfdump <span class="nt">-r</span> /var/cache/nfcapd/nfcapd.<span class="k">*</span> <span class="nt">-s</span> srcip/bytes <span class="nt">-n</span> 20

<span class="c"># íŠ¹ì • ì‹œê°„ëŒ€ ë¶„ì„</span>
nfdump <span class="nt">-r</span> /var/cache/nfcapd/nfcapd.<span class="k">*</span> <span class="nt">-t</span> 2024-03-30.10:00:00-2024-03-30.11:00:00 <span class="nt">-s</span> dstip/packets

<span class="c"># ì˜ì‹¬ìŠ¤ëŸ¬ìš´ í¬íŠ¸ ì‚¬ìš© </span>
nfdump <span class="nt">-r</span> /var/cache/nfcapd/nfcapd.<span class="k">*</span> <span class="s1">'port &gt; 10000 and port &lt; 65000'</span> <span class="nt">-s</span> srcip/flows

<span class="c"># ëŒ€ìš©ëŸ‰ ì „ì†¡ íƒì§€</span>
nfdump <span class="nt">-r</span> /var/cache/nfcapd/nfcapd.<span class="k">*</span> <span class="s1">'bytes &gt; 100000000'</span> <span class="nt">-o</span> extended
</code></pre></div></div>

<h3 id="ï¸-ìœ„í˜‘-í—ŒíŒ…-threat-hunting">ğŸ•µï¸ ìœ„í˜‘ í—ŒíŒ… (Threat Hunting)</h3>

<h4 id="elk-ìŠ¤íƒ-ê¸°ë°˜-ìœ„í˜‘-í—ŒíŒ…">ELK ìŠ¤íƒ ê¸°ë°˜ ìœ„í˜‘ í—ŒíŒ…</h4>
<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Logstash ì„¤ì • - ë„¤íŠ¸ì›Œí¬ ë¡œê·¸ íŒŒì‹±</span>
<span class="c1"># /etc/logstash/conf.d/network-logs.conf</span>
<span class="s">input {</span>
  <span class="s">beats {</span>
    <span class="s">port =&gt; </span><span class="m">5044</span>
  <span class="err">}</span>
  <span class="s">syslog {</span>
    <span class="s">port =&gt; </span><span class="m">514</span>
    <span class="s">type =&gt; "firewall"</span>
  <span class="s">}</span>
<span class="err">}</span>

<span class="s">filter {</span>
  <span class="s">if [type] == "firewall" {</span>
    <span class="s">grok {</span>
      <span class="s">match =&gt; {</span> 
        <span class="s">"message" =&gt; "%{TIMESTAMP_ISO8601:timestamp} %{WORD:device} %{WORD:action} %{IP:src_ip}:%{INT:src_port} -&gt; %{IP:dst_ip}:%{INT:dst_port} %{WORD:protocol}"</span>
      <span class="s">}</span>
    <span class="s">}</span>
    
    <span class="s">geoip {</span>
      <span class="s">source =&gt; "src_ip"</span>
      <span class="s">target =&gt; "src_geoip"</span>
    <span class="s">}</span>
    
    <span class="s">if [src_geoip][country_name] in ["Russia", "China", "North Korea"] {</span>
      <span class="s">mutate {</span>
        <span class="s">add_tag =&gt; [ "suspicious_geo" ]</span>
      <span class="s">}</span>
    <span class="s">}</span>
  <span class="s">}</span>
<span class="err">}</span>

<span class="s">output {</span>
  <span class="s">elasticsearch {</span>
    <span class="s">hosts =&gt; ["localhost:9200"]</span>
    <span class="s">index =&gt; "network-logs-%{+YYYY.MM.dd}"</span>
  <span class="s">}</span>
<span class="err">}</span>
</code></pre></div></div>

<h4 id="kibana-ìœ„í˜‘-í—ŒíŒ…-ì¿¼ë¦¬">Kibana ìœ„í˜‘ í—ŒíŒ… ì¿¼ë¦¬</h4>
<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"query"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"bool"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"must"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="nl">"range"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nl">"@timestamp"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
              </span><span class="nl">"gte"</span><span class="p">:</span><span class="w"> </span><span class="s2">"now-1h"</span><span class="w">
            </span><span class="p">}</span><span class="w">
          </span><span class="p">}</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="nl">"terms"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nl">"tags"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"suspicious_geo"</span><span class="p">]</span><span class="w">
          </span><span class="p">}</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">],</span><span class="w">
      </span><span class="nl">"should"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="nl">"range"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nl">"bytes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
              </span><span class="nl">"gte"</span><span class="p">:</span><span class="w"> </span><span class="mi">1000000</span><span class="w">
            </span><span class="p">}</span><span class="w">
          </span><span class="p">}</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="nl">"script"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nl">"script"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
              </span><span class="nl">"source"</span><span class="p">:</span><span class="w"> </span><span class="s2">"doc['dst_port'].value &gt; 10000 &amp;&amp; doc['dst_port'].value &lt; 65000"</span><span class="w">
            </span><span class="p">}</span><span class="w">
          </span><span class="p">}</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">]</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nl">"aggs"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"suspicious_ips"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"terms"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"field"</span><span class="p">:</span><span class="w"> </span><span class="s2">"src_ip"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"size"</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="nl">"aggs"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"unique_ports"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="nl">"cardinality"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nl">"field"</span><span class="p">:</span><span class="w"> </span><span class="s2">"dst_port"</span><span class="w">
          </span><span class="p">}</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="nl">"total_bytes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="nl">"sum"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nl">"field"</span><span class="p">:</span><span class="w"> </span><span class="s2">"bytes"</span><span class="w">
          </span><span class="p">}</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<h4 id="yara-ë£°-ê¸°ë°˜-ë„¤íŠ¸ì›Œí¬-íƒì§€">YARA ë£° ê¸°ë°˜ ë„¤íŠ¸ì›Œí¬ íƒì§€</h4>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># YARA ë£° ì˜ˆì‹œ - ì•…ì„±ì½”ë“œ í†µì‹  íŒ¨í„´</span>
rule APT_Communication_Pattern
<span class="o">{</span>
    meta:
        description <span class="o">=</span> <span class="s2">"APT ê·¸ë£¹ í†µì‹  íŒ¨í„´ íƒì§€"</span>
        author <span class="o">=</span> <span class="s2">"Security Team"</span>
        <span class="nb">date</span> <span class="o">=</span> <span class="s2">"2024-03-30"</span>
        
    strings:
        <span class="nv">$user_agent</span> <span class="o">=</span> <span class="s2">"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)"</span>
        <span class="nv">$uri_pattern</span> <span class="o">=</span> /<span class="se">\/</span><span class="o">[</span>a-f0-9]<span class="o">{</span>8<span class="o">}</span><span class="se">\/</span><span class="o">[</span>a-f0-9]<span class="o">{</span>8<span class="o">}</span>/
        <span class="nv">$post_data</span> <span class="o">=</span> <span class="o">{</span> 48 54 54 50 2F 31 2E 31 20 32 30 30 20 4F 4B <span class="o">}</span>  // <span class="s2">"HTTP/1.1 200 OK"</span>
        
    condition:
        <span class="nv">$user_agent</span> and <span class="nv">$uri_pattern</span> and <span class="nv">$post_data</span>
<span class="o">}</span>

rule DNS_Tunneling
<span class="o">{</span>
    meta:
        description <span class="o">=</span> <span class="s2">"DNS í„°ë„ë§ íŒ¨í„´ íƒì§€"</span>
        
    strings:
        <span class="nv">$long_subdomain</span> <span class="o">=</span> /[a-zA-Z0-9]<span class="o">{</span>50,<span class="o">}</span><span class="se">\.</span>.<span class="k">*</span><span class="se">\.</span><span class="o">(</span>com|net|org<span class="o">)</span>/
        <span class="nv">$base64_pattern</span> <span class="o">=</span> /[A-Za-z0-9+<span class="se">\/</span><span class="o">]{</span>20,<span class="o">}={</span>0,2<span class="o">}</span>/
        
    condition:
        <span class="nv">$long_subdomain</span> or <span class="nv">$base64_pattern</span>
<span class="o">}</span>

<span class="c"># ë„¤íŠ¸ì›Œí¬ íŠ¸ë˜í”½ì— YARA ì ìš©</span>
suricata <span class="nt">-c</span> /etc/suricata/suricata.yaml <span class="nt">-i</span> eth0 <span class="nt">--runmode</span> single
</code></pre></div></div>

<h2 id="ê³ ê¸‰-íŠ¸ëŸ¬ë¸”ìŠˆíŒ…--advanced-troubleshooting">ê³ ê¸‰ íŠ¸ëŸ¬ë¸”ìŠˆíŒ… | Advanced Troubleshooting</h2>

<h3 id="-ë„¤íŠ¸ì›Œí¬-ì„±ëŠ¥-ë¬¸ì œ-í•´ê²°">ğŸ”§ ë„¤íŠ¸ì›Œí¬ ì„±ëŠ¥ ë¬¸ì œ í•´ê²°</h3>

<h4 id="ëŒ€ì—­í­ê³¼-ì§€ì—°ì‹œê°„-ë¶„ì„">ëŒ€ì—­í­ê³¼ ì§€ì—°ì‹œê°„ ë¶„ì„</h4>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># iperf3ë¥¼ ì´ìš©í•œ ì„±ëŠ¥ ì¸¡ì •</span>
<span class="c"># ì„œë²„ ì¸¡</span>
iperf3 <span class="nt">-s</span> <span class="nt">-p</span> 5201

<span class="c"># í´ë¼ì´ì–¸íŠ¸ ì¸¡ - TCP í…ŒìŠ¤íŠ¸</span>
iperf3 <span class="nt">-c</span> 192.168.1.100 <span class="nt">-t</span> 30 <span class="nt">-i</span> 1 <span class="nt">-P</span> 4
<span class="c"># -t: í…ŒìŠ¤íŠ¸ ì‹œê°„, -i: ì¸í„°ë²Œ, -P: ë³‘ë ¬ ì—°ê²°</span>

<span class="c"># UDP í…ŒìŠ¤íŠ¸ (íŒ¨í‚· ì†ì‹¤ í™•ì¸)</span>
iperf3 <span class="nt">-c</span> 192.168.1.100 <span class="nt">-u</span> <span class="nt">-b</span> 100M <span class="nt">-t</span> 30

<span class="c"># ì–‘ë°©í–¥ í…ŒìŠ¤íŠ¸</span>
iperf3 <span class="nt">-c</span> 192.168.1.100 <span class="nt">--bidir</span> <span class="nt">-t</span> 30

<span class="c"># MTU í¬ê¸° ìµœì í™” í…ŒìŠ¤íŠ¸</span>
ping <span class="nt">-M</span> <span class="k">do</span> <span class="nt">-s</span> 1472 192.168.1.100  <span class="c"># Linux</span>
ping <span class="nt">-f</span> <span class="nt">-l</span> 1472 192.168.1.100     <span class="c"># Windows</span>

<span class="c"># ì ì§„ì  MTU í…ŒìŠ¤íŠ¸ ìŠ¤í¬ë¦½íŠ¸</span>
<span class="c">#!/bin/bash</span>
<span class="k">for </span>size <span class="k">in</span> <span class="o">{</span>1200..1500..50<span class="o">}</span><span class="p">;</span> <span class="k">do
    </span><span class="nb">echo</span> <span class="s2">"Testing MTU size: </span><span class="nv">$size</span><span class="s2">"</span>
    ping <span class="nt">-M</span> <span class="k">do</span> <span class="nt">-s</span> <span class="nv">$size</span> <span class="nt">-c</span> 1 192.168.1.100 <span class="o">&gt;</span> /dev/null 2&gt;&amp;1
    <span class="k">if</span> <span class="o">[</span> <span class="nv">$?</span> <span class="nt">-eq</span> 0 <span class="o">]</span><span class="p">;</span> <span class="k">then
        </span><span class="nb">echo</span> <span class="s2">"âœ… MTU </span><span class="nv">$size</span><span class="s2">: Success"</span>
    <span class="k">else
        </span><span class="nb">echo</span> <span class="s2">"âŒ MTU </span><span class="nv">$size</span><span class="s2">: Failed"</span>
    <span class="k">fi
done</span>
</code></pre></div></div>

<h4 id="ë„¤íŠ¸ì›Œí¬-ì§€ì—°ì‹œê°„-ìƒì„¸-ë¶„ì„">ë„¤íŠ¸ì›Œí¬ ì§€ì—°ì‹œê°„ ìƒì„¸ ë¶„ì„</h4>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># hping3ë¥¼ ì´ìš©í•œ ë‹¤ì–‘í•œ í…ŒìŠ¤íŠ¸</span>
<span class="c"># TCP SYN í”ŒëŸ¬ë“œ í…ŒìŠ¤íŠ¸</span>
hping3 <span class="nt">-S</span> <span class="nt">-p</span> 80 <span class="nt">-i</span> u1000 192.168.1.100

<span class="c"># UDP í¬íŠ¸ ìŠ¤ìº”</span>
hping3 <span class="nt">--udp</span> <span class="nt">-p</span> 53 <span class="nt">-c</span> 3 192.168.1.100

<span class="c"># ICMP íƒ€ì„ìŠ¤íƒ¬í”„ ìš”ì²­</span>
hping3 <span class="nt">--icmp-ts</span> 192.168.1.100

<span class="c"># traceroute ê³ ê¸‰ ì˜µì…˜</span>
<span class="c"># TCP traceroute</span>
traceroute <span class="nt">-T</span> <span class="nt">-p</span> 443 google.com

<span class="c"># UDP traceroute  </span>
traceroute <span class="nt">-U</span> <span class="nt">-p</span> 53 8.8.8.8

<span class="c"># Paris traceroute (ë¡œë“œ ë°¸ëŸ°ì‹± ê³ ë ¤)</span>
paris-traceroute google.com

<span class="c"># mtr - ì‹¤ì‹œê°„ traceroute</span>
mtr <span class="nt">--report</span> <span class="nt">--report-cycles</span> 100 <span class="nt">--no-dns</span> google.com
</code></pre></div></div>

<h3 id="-ë„¤íŠ¸ì›Œí¬-ëª¨ë‹ˆí„°ë§ê³¼-ë¶„ì„">ğŸ“Š ë„¤íŠ¸ì›Œí¬ ëª¨ë‹ˆí„°ë§ê³¼ ë¶„ì„</h3>

<h4 id="snmp-ê¸°ë°˜-ëª¨ë‹ˆí„°ë§">SNMP ê¸°ë°˜ ëª¨ë‹ˆí„°ë§</h4>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="n">pysnmp.hlapi</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="n">time</span>
<span class="kn">import</span> <span class="n">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>

<span class="k">class</span> <span class="nc">NetworkMonitor</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">host</span><span class="p">,</span> <span class="n">community</span><span class="o">=</span><span class="sh">'</span><span class="s">public</span><span class="sh">'</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">host</span> <span class="o">=</span> <span class="n">host</span>
        <span class="n">self</span><span class="p">.</span><span class="n">community</span> <span class="o">=</span> <span class="n">community</span>
        
    <span class="k">def</span> <span class="nf">get_interface_stats</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">interface_index</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ì¸í„°í˜ì´ìŠ¤ í†µê³„ ìˆ˜ì§‘</span><span class="sh">"""</span>
        <span class="n">oids</span> <span class="o">=</span> <span class="p">{</span>
            <span class="sh">'</span><span class="s">ifInOctets</span><span class="sh">'</span><span class="p">:</span> <span class="sa">f</span><span class="sh">'</span><span class="s">1.3.6.1.2.1.2.2.1.10.</span><span class="si">{</span><span class="n">interface_index</span><span class="si">}</span><span class="sh">'</span><span class="p">,</span>
            <span class="sh">'</span><span class="s">ifOutOctets</span><span class="sh">'</span><span class="p">:</span> <span class="sa">f</span><span class="sh">'</span><span class="s">1.3.6.1.2.1.2.2.1.16.</span><span class="si">{</span><span class="n">interface_index</span><span class="si">}</span><span class="sh">'</span><span class="p">,</span>
            <span class="sh">'</span><span class="s">ifSpeed</span><span class="sh">'</span><span class="p">:</span> <span class="sa">f</span><span class="sh">'</span><span class="s">1.3.6.1.2.1.2.2.1.5.</span><span class="si">{</span><span class="n">interface_index</span><span class="si">}</span><span class="sh">'</span><span class="p">,</span>
            <span class="sh">'</span><span class="s">ifOperStatus</span><span class="sh">'</span><span class="p">:</span> <span class="sa">f</span><span class="sh">'</span><span class="s">1.3.6.1.2.1.2.2.1.8.</span><span class="si">{</span><span class="n">interface_index</span><span class="si">}</span><span class="sh">'</span>
        <span class="p">}</span>
        
        <span class="n">results</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">oid</span> <span class="ow">in</span> <span class="n">oids</span><span class="p">.</span><span class="nf">items</span><span class="p">():</span>
            <span class="nf">for </span><span class="p">(</span><span class="n">errorIndication</span><span class="p">,</span> <span class="n">errorStatus</span><span class="p">,</span> <span class="n">errorIndex</span><span class="p">,</span> <span class="n">varBinds</span><span class="p">)</span> <span class="ow">in</span> <span class="nf">nextCmd</span><span class="p">(</span>
                <span class="nc">SnmpEngine</span><span class="p">(),</span>
                <span class="nc">CommunityData</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">community</span><span class="p">),</span>
                <span class="nc">UdpTransportTarget</span><span class="p">((</span><span class="n">self</span><span class="p">.</span><span class="n">host</span><span class="p">,</span> <span class="mi">161</span><span class="p">)),</span>
                <span class="nc">ContextData</span><span class="p">(),</span>
                <span class="nc">ObjectType</span><span class="p">(</span><span class="nc">ObjectIdentity</span><span class="p">(</span><span class="n">oid</span><span class="p">)),</span>
                <span class="n">lexicographicMode</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
                
                <span class="k">if</span> <span class="n">errorIndication</span><span class="p">:</span>
                    <span class="nf">print</span><span class="p">(</span><span class="n">errorIndication</span><span class="p">)</span>
                    <span class="k">break</span>
                <span class="k">elif</span> <span class="n">errorStatus</span><span class="p">:</span>
                    <span class="nf">print</span><span class="p">(</span><span class="sh">'</span><span class="s">%s at %s</span><span class="sh">'</span> <span class="o">%</span> <span class="p">(</span><span class="n">errorStatus</span><span class="p">.</span><span class="nf">prettyPrint</span><span class="p">(),</span>
                                        <span class="n">errorIndex</span> <span class="ow">and</span> <span class="n">varBinds</span><span class="p">[</span><span class="nf">int</span><span class="p">(</span><span class="n">errorIndex</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="ow">or</span> <span class="sh">'</span><span class="s">?</span><span class="sh">'</span><span class="p">))</span>
                    <span class="k">break</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">varBind</span> <span class="ow">in</span> <span class="n">varBinds</span><span class="p">:</span>
                        <span class="n">results</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="nf">int</span><span class="p">(</span><span class="n">varBind</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                    <span class="k">break</span>
                    
        <span class="k">return</span> <span class="n">results</span>
    
    <span class="k">def</span> <span class="nf">calculate_bandwidth_utilization</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">interval</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">samples</span><span class="o">=</span><span class="mi">60</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ëŒ€ì—­í­ ì‚¬ìš©ë¥  ê³„ì‚°</span><span class="sh">"""</span>
        <span class="n">prev_stats</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">get_interface_stats</span><span class="p">()</span>
        <span class="n">time</span><span class="p">.</span><span class="nf">sleep</span><span class="p">(</span><span class="n">interval</span><span class="p">)</span>
        
        <span class="n">utilizations</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">timestamps</span> <span class="o">=</span> <span class="p">[]</span>
        
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">samples</span><span class="p">):</span>
            <span class="n">current_stats</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">get_interface_stats</span><span class="p">()</span>
            
            <span class="c1"># ë°”ì´íŠ¸ ì¦ê°€ëŸ‰ ê³„ì‚°
</span>            <span class="n">in_bytes</span> <span class="o">=</span> <span class="n">current_stats</span><span class="p">[</span><span class="sh">'</span><span class="s">ifInOctets</span><span class="sh">'</span><span class="p">]</span> <span class="o">-</span> <span class="n">prev_stats</span><span class="p">[</span><span class="sh">'</span><span class="s">ifInOctets</span><span class="sh">'</span><span class="p">]</span>
            <span class="n">out_bytes</span> <span class="o">=</span> <span class="n">current_stats</span><span class="p">[</span><span class="sh">'</span><span class="s">ifOutOctets</span><span class="sh">'</span><span class="p">]</span> <span class="o">-</span> <span class="n">prev_stats</span><span class="p">[</span><span class="sh">'</span><span class="s">ifOutOctets</span><span class="sh">'</span><span class="p">]</span>
            
            <span class="c1"># ë¹„íŠ¸ë¡œ ë³€í™˜í•˜ê³  ì´ˆë‹¹ ê³„ì‚°
</span>            <span class="n">in_bps</span> <span class="o">=</span> <span class="p">(</span><span class="n">in_bytes</span> <span class="o">*</span> <span class="mi">8</span><span class="p">)</span> <span class="o">/</span> <span class="n">interval</span>
            <span class="n">out_bps</span> <span class="o">=</span> <span class="p">(</span><span class="n">out_bytes</span> <span class="o">*</span> <span class="mi">8</span><span class="p">)</span> <span class="o">/</span> <span class="n">interval</span>
            
            <span class="c1"># ì‚¬ìš©ë¥  ê³„ì‚° (%)
</span>            <span class="n">interface_speed</span> <span class="o">=</span> <span class="n">current_stats</span><span class="p">[</span><span class="sh">'</span><span class="s">ifSpeed</span><span class="sh">'</span><span class="p">]</span>
            <span class="n">in_utilization</span> <span class="o">=</span> <span class="p">(</span><span class="n">in_bps</span> <span class="o">/</span> <span class="n">interface_speed</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>
            <span class="n">out_utilization</span> <span class="o">=</span> <span class="p">(</span><span class="n">out_bps</span> <span class="o">/</span> <span class="n">interface_speed</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>
            
            <span class="n">utilizations</span><span class="p">.</span><span class="nf">append</span><span class="p">({</span>
                <span class="sh">'</span><span class="s">timestamp</span><span class="sh">'</span><span class="p">:</span> <span class="n">time</span><span class="p">.</span><span class="nf">time</span><span class="p">(),</span>
                <span class="sh">'</span><span class="s">in_utilization</span><span class="sh">'</span><span class="p">:</span> <span class="n">in_utilization</span><span class="p">,</span>
                <span class="sh">'</span><span class="s">out_utilization</span><span class="sh">'</span><span class="p">:</span> <span class="n">out_utilization</span><span class="p">,</span>
                <span class="sh">'</span><span class="s">in_bps</span><span class="sh">'</span><span class="p">:</span> <span class="n">in_bps</span><span class="p">,</span>
                <span class="sh">'</span><span class="s">out_bps</span><span class="sh">'</span><span class="p">:</span> <span class="n">out_bps</span>
            <span class="p">})</span>
            
            <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">ì‹œê°„: </span><span class="si">{</span><span class="n">time</span><span class="p">.</span><span class="n">strftime</span><span class="p">(</span><span class="sh">'</span><span class="s">%H</span><span class="si">:</span><span class="o">%</span><span class="n">M</span><span class="si">:</span><span class="o">%</span><span class="n">S</span><span class="sh">'</span><span class="s">)</span><span class="si">}</span><span class="s">, </span><span class="sh">"</span>
                  <span class="sa">f</span><span class="sh">"</span><span class="s">In: </span><span class="si">{</span><span class="n">in_utilization</span><span class="si">:</span><span class="p">.</span><span class="mi">2</span><span class="n">f</span><span class="si">}</span><span class="s">% (</span><span class="si">{</span><span class="n">in_bps</span><span class="o">/</span><span class="mi">1000000</span><span class="si">:</span><span class="p">.</span><span class="mi">2</span><span class="n">f</span><span class="si">}</span><span class="s">Mbps), </span><span class="sh">"</span>
                  <span class="sa">f</span><span class="sh">"</span><span class="s">Out: </span><span class="si">{</span><span class="n">out_utilization</span><span class="si">:</span><span class="p">.</span><span class="mi">2</span><span class="n">f</span><span class="si">}</span><span class="s">% (</span><span class="si">{</span><span class="n">out_bps</span><span class="o">/</span><span class="mi">1000000</span><span class="si">:</span><span class="p">.</span><span class="mi">2</span><span class="n">f</span><span class="si">}</span><span class="s">Mbps)</span><span class="sh">"</span><span class="p">)</span>
            
            <span class="n">prev_stats</span> <span class="o">=</span> <span class="n">current_stats</span>
            <span class="n">time</span><span class="p">.</span><span class="nf">sleep</span><span class="p">(</span><span class="n">interval</span><span class="p">)</span>
            
        <span class="k">return</span> <span class="n">utilizations</span>

<span class="c1"># ì‚¬ìš© ì˜ˆì‹œ
</span><span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="sh">"</span><span class="s">__main__</span><span class="sh">"</span><span class="p">:</span>
    <span class="n">monitor</span> <span class="o">=</span> <span class="nc">NetworkMonitor</span><span class="p">(</span><span class="sh">'</span><span class="s">192.168.1.1</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">monitor</span><span class="p">.</span><span class="nf">calculate_bandwidth_utilization</span><span class="p">()</span>
    
    <span class="c1"># ê·¸ë˜í”„ ìƒì„±
</span>    <span class="n">timestamps</span> <span class="o">=</span> <span class="p">[</span><span class="n">d</span><span class="p">[</span><span class="sh">'</span><span class="s">timestamp</span><span class="sh">'</span><span class="p">]</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">data</span><span class="p">]</span>
    <span class="n">in_util</span> <span class="o">=</span> <span class="p">[</span><span class="n">d</span><span class="p">[</span><span class="sh">'</span><span class="s">in_utilization</span><span class="sh">'</span><span class="p">]</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">data</span><span class="p">]</span>
    <span class="n">out_util</span> <span class="o">=</span> <span class="p">[</span><span class="n">d</span><span class="p">[</span><span class="sh">'</span><span class="s">out_utilization</span><span class="sh">'</span><span class="p">]</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">data</span><span class="p">]</span>
    
    <span class="n">plt</span><span class="p">.</span><span class="nf">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
    <span class="n">plt</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">timestamps</span><span class="p">,</span> <span class="n">in_util</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sh">'</span><span class="s">Inbound</span><span class="sh">'</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="sh">'</span><span class="s">blue</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">timestamps</span><span class="p">,</span> <span class="n">out_util</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sh">'</span><span class="s">Outbound</span><span class="sh">'</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="sh">'</span><span class="s">red</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="nf">xlabel</span><span class="p">(</span><span class="sh">'</span><span class="s">Time</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="nf">ylabel</span><span class="p">(</span><span class="sh">'</span><span class="s">Bandwidth Utilization (%)</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="nf">title</span><span class="p">(</span><span class="sh">'</span><span class="s">Network Interface Utilization</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="nf">legend</span><span class="p">()</span>
    <span class="n">plt</span><span class="p">.</span><span class="nf">grid</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>
</code></pre></div></div>

<h3 id="-ë„¤íŠ¸ì›Œí¬-ì¥ì• -ëŒ€ì‘-í”„ë¡œì„¸ìŠ¤">ğŸš¨ ë„¤íŠ¸ì›Œí¬ ì¥ì•  ëŒ€ì‘ í”„ë¡œì„¸ìŠ¤</h3>

<h4 id="ìë™í™”ëœ-ì¥ì• -ëŒ€ì‘-ìŠ¤í¬ë¦½íŠ¸">ìë™í™”ëœ ì¥ì•  ëŒ€ì‘ ìŠ¤í¬ë¦½íŠ¸</h4>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#!/bin/bash</span>
<span class="c"># ë„¤íŠ¸ì›Œí¬ ì¥ì•  ìë™ ì§„ë‹¨ ë° ëŒ€ì‘ ìŠ¤í¬ë¦½íŠ¸</span>

<span class="nv">LOG_FILE</span><span class="o">=</span><span class="s2">"/var/log/network_troubleshoot.log"</span>
<span class="nv">ALERT_THRESHOLD</span><span class="o">=</span>5  <span class="c"># 5% íŒ¨í‚· ì†ì‹¤ ì„ê³„ê°’</span>

log_message<span class="o">()</span> <span class="o">{</span>
    <span class="nb">echo</span> <span class="s2">"[</span><span class="si">$(</span><span class="nb">date</span> <span class="s1">'+%Y-%m-%d %H:%M:%S'</span><span class="si">)</span><span class="s2">] </span><span class="nv">$1</span><span class="s2">"</span> <span class="o">&gt;&gt;</span> <span class="nv">$LOG_FILE</span>
    <span class="nb">echo</span> <span class="s2">"</span><span class="nv">$1</span><span class="s2">"</span>
<span class="o">}</span>

<span class="c"># 1ë‹¨ê³„: ê¸°ë³¸ ì—°ê²°ì„± í™•ì¸</span>
check_connectivity<span class="o">()</span> <span class="o">{</span>
    log_message <span class="s2">"=== 1ë‹¨ê³„: ê¸°ë³¸ ì—°ê²°ì„± í™•ì¸ ==="</span>
    
    <span class="c"># ê²Œì´íŠ¸ì›¨ì´ í•‘ í…ŒìŠ¤íŠ¸</span>
    <span class="nv">gateway</span><span class="o">=</span><span class="si">$(</span>ip route | <span class="nb">grep </span>default | <span class="nb">awk</span> <span class="s1">'{print $3}'</span> | <span class="nb">head</span> <span class="nt">-1</span><span class="si">)</span>
    log_message <span class="s2">"ê¸°ë³¸ ê²Œì´íŠ¸ì›¨ì´: </span><span class="nv">$gateway</span><span class="s2">"</span>
    
    <span class="nv">packet_loss</span><span class="o">=</span><span class="si">$(</span>ping <span class="nt">-c</span> 5 <span class="nv">$gateway</span> | <span class="nb">grep</span> <span class="s2">"packet loss"</span> | <span class="nb">awk</span> <span class="s1">'{print $6}'</span> | <span class="nb">sed</span> <span class="s1">'s/%//'</span><span class="si">)</span>
    
    <span class="k">if</span> <span class="o">((</span> <span class="si">$(</span><span class="nb">echo</span> <span class="s2">"</span><span class="nv">$packet_loss</span><span class="s2"> &gt; </span><span class="nv">$ALERT_THRESHOLD</span><span class="s2">"</span> | bc <span class="nt">-l</span><span class="si">)</span> <span class="o">))</span><span class="p">;</span> <span class="k">then
        </span>log_message <span class="s2">"âŒ ê²Œì´íŠ¸ì›¨ì´ ì—°ê²° ë¬¸ì œ ê°ì§€: </span><span class="k">${</span><span class="nv">packet_loss</span><span class="k">}</span><span class="s2">% íŒ¨í‚· ì†ì‹¤"</span>
        <span class="k">return </span>1
    <span class="k">else
        </span>log_message <span class="s2">"âœ… ê²Œì´íŠ¸ì›¨ì´ ì—°ê²° ì •ìƒ: </span><span class="k">${</span><span class="nv">packet_loss</span><span class="k">}</span><span class="s2">% íŒ¨í‚· ì†ì‹¤"</span>
        <span class="k">return </span>0
    <span class="k">fi</span>
<span class="o">}</span>

<span class="c"># 2ë‹¨ê³„: DNS í•´ìƒë„ í™•ì¸  </span>
check_dns<span class="o">()</span> <span class="o">{</span>
    log_message <span class="s2">"=== 2ë‹¨ê³„: DNS í•´ìƒë„ í™•ì¸ ==="</span>
    
    <span class="nv">dns_servers</span><span class="o">=(</span><span class="s2">"8.8.8.8"</span> <span class="s2">"1.1.1.1"</span> <span class="s2">"168.126.63.1"</span><span class="o">)</span>
    <span class="nv">test_domains</span><span class="o">=(</span><span class="s2">"google.com"</span> <span class="s2">"naver.com"</span> <span class="s2">"github.com"</span><span class="o">)</span>
    
    <span class="k">for </span>server <span class="k">in</span> <span class="s2">"</span><span class="k">${</span><span class="nv">dns_servers</span><span class="p">[@]</span><span class="k">}</span><span class="s2">"</span><span class="p">;</span> <span class="k">do
        for </span>domain <span class="k">in</span> <span class="s2">"</span><span class="k">${</span><span class="nv">test_domains</span><span class="p">[@]</span><span class="k">}</span><span class="s2">"</span><span class="p">;</span> <span class="k">do
            </span><span class="nv">response_time</span><span class="o">=</span><span class="si">$(</span>dig @<span class="nv">$server</span> <span class="nv">$domain</span> +short +time<span class="o">=</span>3 2&gt;&amp;1<span class="si">)</span>
            <span class="k">if</span> <span class="o">[</span> <span class="nv">$?</span> <span class="nt">-eq</span> 0 <span class="o">]</span> <span class="o">&amp;&amp;</span> <span class="o">[</span> <span class="nt">-n</span> <span class="s2">"</span><span class="nv">$response_time</span><span class="s2">"</span> <span class="o">]</span><span class="p">;</span> <span class="k">then
                </span>log_message <span class="s2">"âœ… DNS ì„œë²„ </span><span class="nv">$server</span><span class="s2">: </span><span class="nv">$domain</span><span class="s2"> í•´ìƒë„ ì„±ê³µ"</span>
            <span class="k">else
                </span>log_message <span class="s2">"âŒ DNS ì„œë²„ </span><span class="nv">$server</span><span class="s2">: </span><span class="nv">$domain</span><span class="s2"> í•´ìƒë„ ì‹¤íŒ¨"</span>
            <span class="k">fi
        done
    done</span>
<span class="o">}</span>

<span class="c"># 3ë‹¨ê³„: ì¸í„°í˜ì´ìŠ¤ ìƒíƒœ í™•ì¸</span>
check_interfaces<span class="o">()</span> <span class="o">{</span>
    log_message <span class="s2">"=== 3ë‹¨ê³„: ë„¤íŠ¸ì›Œí¬ ì¸í„°í˜ì´ìŠ¤ í™•ì¸ ==="</span>
    
    ip <span class="nb">link </span>show | <span class="nb">grep</span> <span class="nt">-E</span> <span class="s2">"^[0-9]+:"</span> | <span class="k">while </span><span class="nb">read </span>line<span class="p">;</span> <span class="k">do
        </span><span class="nv">interface</span><span class="o">=</span><span class="si">$(</span><span class="nb">echo</span> <span class="nv">$line</span> | <span class="nb">cut</span> <span class="nt">-d</span>: <span class="nt">-f2</span> | <span class="nb">sed</span> <span class="s1">'s/ //'</span><span class="si">)</span>
        <span class="nv">status</span><span class="o">=</span><span class="si">$(</span><span class="nb">echo</span> <span class="nv">$line</span> | <span class="nb">grep</span> <span class="nt">-o</span> <span class="s2">"state [A-Z]*"</span> | <span class="nb">cut</span> <span class="nt">-d</span><span class="s1">' '</span> <span class="nt">-f2</span><span class="si">)</span>
        
        <span class="k">if</span> <span class="o">[</span> <span class="s2">"</span><span class="nv">$status</span><span class="s2">"</span> <span class="o">=</span> <span class="s2">"UP"</span> <span class="o">]</span><span class="p">;</span> <span class="k">then
            </span>log_message <span class="s2">"âœ… ì¸í„°í˜ì´ìŠ¤ </span><span class="nv">$interface</span><span class="s2">: </span><span class="nv">$status</span><span class="s2">"</span>
        <span class="k">else
            </span>log_message <span class="s2">"âŒ ì¸í„°í˜ì´ìŠ¤ </span><span class="nv">$interface</span><span class="s2">: </span><span class="nv">$status</span><span class="s2">"</span>
            
            <span class="c"># ì¸í„°í˜ì´ìŠ¤ ì¬ì‹œì‘ ì‹œë„</span>
            log_message <span class="s2">"ì¸í„°í˜ì´ìŠ¤ </span><span class="nv">$interface</span><span class="s2"> ì¬ì‹œì‘ ì‹œë„ì¤‘..."</span>
            <span class="nb">sudo </span>ip <span class="nb">link set</span> <span class="nv">$interface</span> down
            <span class="nb">sleep </span>2
            <span class="nb">sudo </span>ip <span class="nb">link set</span> <span class="nv">$interface</span> up
            <span class="nb">sleep </span>5
            
            <span class="c"># ì¬í™•ì¸</span>
            <span class="nv">new_status</span><span class="o">=</span><span class="si">$(</span>ip <span class="nb">link </span>show <span class="nv">$interface</span> | <span class="nb">grep</span> <span class="nt">-o</span> <span class="s2">"state [A-Z]*"</span> | <span class="nb">cut</span> <span class="nt">-d</span><span class="s1">' '</span> <span class="nt">-f2</span><span class="si">)</span>
            log_message <span class="s2">"ì¬ì‹œì‘ í›„ ìƒíƒœ: </span><span class="nv">$new_status</span><span class="s2">"</span>
        <span class="k">fi
    done</span>
<span class="o">}</span>

<span class="c"># 4ë‹¨ê³„: ë¼ìš°íŒ… í…Œì´ë¸” í™•ì¸</span>
check_routing<span class="o">()</span> <span class="o">{</span>
    log_message <span class="s2">"=== 4ë‹¨ê³„: ë¼ìš°íŒ… í…Œì´ë¸” í™•ì¸ ==="</span>
    
    <span class="c"># ê¸°ë³¸ ê²Œì´íŠ¸ì›¨ì´ í™•ì¸</span>
    <span class="nv">default_routes</span><span class="o">=</span><span class="si">$(</span>ip route | <span class="nb">grep </span>default | <span class="nb">wc</span> <span class="nt">-l</span><span class="si">)</span>
    <span class="k">if</span> <span class="o">[</span> <span class="nv">$default_routes</span> <span class="nt">-eq</span> 0 <span class="o">]</span><span class="p">;</span> <span class="k">then
        </span>log_message <span class="s2">"âŒ ê¸°ë³¸ ê²Œì´íŠ¸ì›¨ì´ê°€ ì„¤ì •ë˜ì§€ ì•ŠìŒ"</span>
        
        <span class="c"># DHCP ê°±ì‹  ì‹œë„</span>
        log_message <span class="s2">"DHCP ê°±ì‹  ì‹œë„ì¤‘..."</span>
        <span class="nb">sudo </span>dhclient <span class="nt">-r</span>
        <span class="nb">sudo </span>dhclient
    <span class="k">elif</span> <span class="o">[</span> <span class="nv">$default_routes</span> <span class="nt">-gt</span> 1 <span class="o">]</span><span class="p">;</span> <span class="k">then
        </span>log_message <span class="s2">"âš ï¸  ì—¬ëŸ¬ ê°œì˜ ê¸°ë³¸ ê²Œì´íŠ¸ì›¨ì´ ê°ì§€"</span>
        ip route | <span class="nb">grep </span>default
    <span class="k">else
        </span>log_message <span class="s2">"âœ… ê¸°ë³¸ ê²Œì´íŠ¸ì›¨ì´ ì •ìƒ"</span>
    <span class="k">fi</span>
    
    <span class="c"># ë¼ìš°íŒ… í…Œì´ë¸” ì¶œë ¥</span>
    log_message <span class="s2">"í˜„ì¬ ë¼ìš°íŒ… í…Œì´ë¸”:"</span>
    ip route <span class="o">&gt;&gt;</span> <span class="nv">$LOG_FILE</span>
<span class="o">}</span>

<span class="c"># 5ë‹¨ê³„: í¬íŠ¸ ìŠ¤ìº” (ì„œë¹„ìŠ¤ ê°€ìš©ì„± í™•ì¸)</span>
check_services<span class="o">()</span> <span class="o">{</span>
    log_message <span class="s2">"=== 5ë‹¨ê³„: í•µì‹¬ ì„œë¹„ìŠ¤ í™•ì¸ ==="</span>
    
    <span class="nv">services</span><span class="o">=(</span>
        <span class="s2">"8.8.8.8:53:DNS"</span>
        <span class="s2">"google.com:80:HTTP"</span>
        <span class="s2">"google.com:443:HTTPS"</span>
        <span class="s2">"github.com:22:SSH"</span>
    <span class="o">)</span>
    
    <span class="k">for </span>service <span class="k">in</span> <span class="s2">"</span><span class="k">${</span><span class="nv">services</span><span class="p">[@]</span><span class="k">}</span><span class="s2">"</span><span class="p">;</span> <span class="k">do
        </span><span class="nv">IFS</span><span class="o">=</span><span class="s1">':'</span> <span class="nb">read</span> <span class="nt">-r</span> host port name <span class="o">&lt;&lt;&lt;</span> <span class="s2">"</span><span class="nv">$service</span><span class="s2">"</span>
        
        <span class="k">if </span><span class="nb">timeout </span>5 bash <span class="nt">-c</span> <span class="s2">"echo &gt;/dev/tcp/</span><span class="nv">$host</span><span class="s2">/</span><span class="nv">$port</span><span class="s2">"</span> 2&gt;/dev/null<span class="p">;</span> <span class="k">then
            </span>log_message <span class="s2">"âœ… </span><span class="nv">$name</span><span class="s2"> (</span><span class="nv">$host</span><span class="s2">:</span><span class="nv">$port</span><span class="s2">): ì ‘ê·¼ ê°€ëŠ¥"</span>
        <span class="k">else
            </span>log_message <span class="s2">"âŒ </span><span class="nv">$name</span><span class="s2"> (</span><span class="nv">$host</span><span class="s2">:</span><span class="nv">$port</span><span class="s2">): ì ‘ê·¼ ë¶ˆê°€"</span>
        <span class="k">fi
    done</span>
<span class="o">}</span>

<span class="c"># 6ë‹¨ê³„: ìë™ ë³µêµ¬ ì‹œë„</span>
auto_recovery<span class="o">()</span> <span class="o">{</span>
    log_message <span class="s2">"=== 6ë‹¨ê³„: ìë™ ë³µêµ¬ ì‹œë„ ==="</span>
    
    <span class="c"># ë„¤íŠ¸ì›Œí¬ ê´€ë¦¬ì ì¬ì‹œì‘</span>
    <span class="k">if </span>systemctl is-active NetworkManager <span class="o">&gt;</span>/dev/null 2&gt;&amp;1<span class="p">;</span> <span class="k">then
        </span>log_message <span class="s2">"NetworkManager ì¬ì‹œì‘ ì¤‘..."</span>
        <span class="nb">sudo </span>systemctl restart NetworkManager
        <span class="nb">sleep </span>10
    <span class="k">fi</span>
    
    <span class="c"># ë°©í™”ë²½ ê·œì¹™ ì´ˆê¸°í™” (ì„ì‹œ)</span>
    log_message <span class="s2">"ë°©í™”ë²½ ê·œì¹™ ì„ì‹œ í—ˆìš©..."</span>
    <span class="nb">sudo </span>iptables <span class="nt">-P</span> INPUT ACCEPT
    <span class="nb">sudo </span>iptables <span class="nt">-P</span> FORWARD ACCEPT
    <span class="nb">sudo </span>iptables <span class="nt">-P</span> OUTPUT ACCEPT
    
    <span class="c"># DNS ìºì‹œ í”ŒëŸ¬ì‹œ</span>
    log_message <span class="s2">"DNS ìºì‹œ í”ŒëŸ¬ì‹œ..."</span>
    <span class="nb">sudo </span>systemctl restart systemd-resolved
    
    log_message <span class="s2">"ìë™ ë³µêµ¬ ì™„ë£Œ. 5ë¶„ í›„ ì¬í…ŒìŠ¤íŠ¸ ì˜ˆì •..."</span>
<span class="o">}</span>

<span class="c"># ë©”ì¸ ì‹¤í–‰ í•¨ìˆ˜</span>
main<span class="o">()</span> <span class="o">{</span>
    log_message <span class="s2">"==================== ë„¤íŠ¸ì›Œí¬ ì§„ë‹¨ ì‹œì‘ ===================="</span>
    
    <span class="nv">failure_count</span><span class="o">=</span>0
    
    check_connectivity <span class="o">||</span> <span class="o">((</span>failure_count++<span class="o">))</span>
    check_dns <span class="o">||</span> <span class="o">((</span>failure_count++<span class="o">))</span>  
    check_interfaces <span class="o">||</span> <span class="o">((</span>failure_count++<span class="o">))</span>
    check_routing <span class="o">||</span> <span class="o">((</span>failure_count++<span class="o">))</span>
    check_services <span class="o">||</span> <span class="o">((</span>failure_count++<span class="o">))</span>
    
    <span class="k">if</span> <span class="o">[</span> <span class="nv">$failure_count</span> <span class="nt">-gt</span> 2 <span class="o">]</span><span class="p">;</span> <span class="k">then
        </span>log_message <span class="s2">"âš ï¸  ì‹¬ê°í•œ ë„¤íŠ¸ì›Œí¬ ë¬¸ì œ ê°ì§€ (</span><span class="nv">$failure_count</span><span class="s2"> ê°œ ì‹¤íŒ¨)"</span>
        auto_recovery
        
        <span class="c"># 5ë¶„ í›„ ì¬í…ŒìŠ¤íŠ¸</span>
        <span class="nb">sleep </span>300
        log_message <span class="s2">"==================== ë³µêµ¬ í›„ ì¬ì§„ë‹¨ ===================="</span>
        main
    <span class="k">else
        </span>log_message <span class="s2">"âœ… ë„¤íŠ¸ì›Œí¬ ìƒíƒœ ì •ìƒ (ì‹¤íŒ¨: </span><span class="nv">$failure_count</span><span class="s2"> ê°œ)"</span>
    <span class="k">fi
    
    </span>log_message <span class="s2">"==================== ì§„ë‹¨ ì™„ë£Œ ===================="</span>
<span class="o">}</span>

<span class="c"># ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰</span>
main
</code></pre></div></div>

<h2 id="ìµœì‹ -ë³´ì•ˆ-ìœ„í˜‘ê³¼-ëŒ€ì‘">ìµœì‹  ë³´ì•ˆ ìœ„í˜‘ê³¼ ëŒ€ì‘</h2>

<h3 id="-aiml-ê¸°ë°˜-ìœ„í˜‘-íƒì§€">ğŸ¯ AI/ML ê¸°ë°˜ ìœ„í˜‘ íƒì§€</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="kn">import</span> <span class="n">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">from</span> <span class="n">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">IsolationForest</span>
<span class="kn">from</span> <span class="n">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="kn">import</span> <span class="n">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>

<span class="k">class</span> <span class="nc">NetworkAnomalyDetector</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">model</span> <span class="o">=</span> <span class="nc">IsolationForest</span><span class="p">(</span><span class="n">contamination</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
        <span class="n">self</span><span class="p">.</span><span class="n">scaler</span> <span class="o">=</span> <span class="nc">StandardScaler</span><span class="p">()</span>
        
    <span class="k">def</span> <span class="nf">prepare_features</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">network_data</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ë„¤íŠ¸ì›Œí¬ ë°ì´í„°ì—ì„œ í”¼ì²˜ ì¶”ì¶œ</span><span class="sh">"""</span>
        <span class="n">features</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nc">DataFrame</span><span class="p">()</span>
        
        <span class="c1"># ì‹œê°„ëŒ€ë³„ íŠ¸ë˜í”½ íŒ¨í„´
</span>        <span class="n">features</span><span class="p">[</span><span class="sh">'</span><span class="s">hour</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nf">to_datetime</span><span class="p">(</span><span class="n">network_data</span><span class="p">[</span><span class="sh">'</span><span class="s">timestamp</span><span class="sh">'</span><span class="p">]).</span><span class="n">dt</span><span class="p">.</span><span class="n">hour</span>
        <span class="n">features</span><span class="p">[</span><span class="sh">'</span><span class="s">day_of_week</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nf">to_datetime</span><span class="p">(</span><span class="n">network_data</span><span class="p">[</span><span class="sh">'</span><span class="s">timestamp</span><span class="sh">'</span><span class="p">]).</span><span class="n">dt</span><span class="p">.</span><span class="n">dayofweek</span>
        
        <span class="c1"># íŠ¸ë˜í”½ ë³¼ë¥¨
</span>        <span class="n">features</span><span class="p">[</span><span class="sh">'</span><span class="s">bytes_per_second</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">network_data</span><span class="p">[</span><span class="sh">'</span><span class="s">bytes</span><span class="sh">'</span><span class="p">]</span> <span class="o">/</span> <span class="n">network_data</span><span class="p">[</span><span class="sh">'</span><span class="s">duration</span><span class="sh">'</span><span class="p">]</span>
        <span class="n">features</span><span class="p">[</span><span class="sh">'</span><span class="s">packets_per_second</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">network_data</span><span class="p">[</span><span class="sh">'</span><span class="s">packets</span><span class="sh">'</span><span class="p">]</span> <span class="o">/</span> <span class="n">network_data</span><span class="p">[</span><span class="sh">'</span><span class="s">duration</span><span class="sh">'</span><span class="p">]</span>
        
        <span class="c1"># ì—°ê²° íŒ¨í„´
</span>        <span class="n">features</span><span class="p">[</span><span class="sh">'</span><span class="s">unique_src_ports</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">network_data</span><span class="p">.</span><span class="nf">groupby</span><span class="p">(</span><span class="sh">'</span><span class="s">src_ip</span><span class="sh">'</span><span class="p">)[</span><span class="sh">'</span><span class="s">src_port</span><span class="sh">'</span><span class="p">].</span><span class="nf">nunique</span><span class="p">()</span>
        <span class="n">features</span><span class="p">[</span><span class="sh">'</span><span class="s">unique_dst_ports</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">network_data</span><span class="p">.</span><span class="nf">groupby</span><span class="p">(</span><span class="sh">'</span><span class="s">src_ip</span><span class="sh">'</span><span class="p">)[</span><span class="sh">'</span><span class="s">dst_port</span><span class="sh">'</span><span class="p">].</span><span class="nf">nunique</span><span class="p">()</span> 
        <span class="n">features</span><span class="p">[</span><span class="sh">'</span><span class="s">connection_count</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">network_data</span><span class="p">.</span><span class="nf">groupby</span><span class="p">(</span><span class="sh">'</span><span class="s">src_ip</span><span class="sh">'</span><span class="p">).</span><span class="nf">size</span><span class="p">()</span>
        
        <span class="c1"># í”„ë¡œí† ì½œ ë¶„í¬
</span>        <span class="n">protocol_counts</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nf">get_dummies</span><span class="p">(</span><span class="n">network_data</span><span class="p">[</span><span class="sh">'</span><span class="s">protocol</span><span class="sh">'</span><span class="p">])</span>
        <span class="n">features</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nf">concat</span><span class="p">([</span><span class="n">features</span><span class="p">.</span><span class="nf">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="bp">True</span><span class="p">),</span> 
                            <span class="n">protocol_counts</span><span class="p">.</span><span class="nf">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="bp">True</span><span class="p">)],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">features</span><span class="p">.</span><span class="nf">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">train</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">training_data</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ì •ìƒ íŠ¸ë˜í”½ìœ¼ë¡œ ëª¨ë¸ í•™ìŠµ</span><span class="sh">"""</span>
        <span class="n">features</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">prepare_features</span><span class="p">(</span><span class="n">training_data</span><span class="p">)</span>
        <span class="n">scaled_features</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">scaler</span><span class="p">.</span><span class="nf">fit_transform</span><span class="p">(</span><span class="n">features</span><span class="p">)</span>
        <span class="n">self</span><span class="p">.</span><span class="n">model</span><span class="p">.</span><span class="nf">fit</span><span class="p">(</span><span class="n">scaled_features</span><span class="p">)</span>
        
    <span class="k">def</span> <span class="nf">detect_anomalies</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">test_data</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ì´ìƒ íŠ¸ë˜í”½ íƒì§€</span><span class="sh">"""</span>
        <span class="n">features</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">prepare_features</span><span class="p">(</span><span class="n">test_data</span><span class="p">)</span>
        <span class="n">scaled_features</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">scaler</span><span class="p">.</span><span class="nf">transform</span><span class="p">(</span><span class="n">features</span><span class="p">)</span>
        
        <span class="c1"># ì´ìƒ ì ìˆ˜ ê³„ì‚° (-1: ì´ìƒ, 1: ì •ìƒ)
</span>        <span class="n">predictions</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">model</span><span class="p">.</span><span class="nf">predict</span><span class="p">(</span><span class="n">scaled_features</span><span class="p">)</span>
        <span class="n">anomaly_scores</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">model</span><span class="p">.</span><span class="nf">score_samples</span><span class="p">(</span><span class="n">scaled_features</span><span class="p">)</span>
        
        <span class="c1"># ê²°ê³¼ ë°ì´í„°í”„ë ˆì„ ìƒì„±
</span>        <span class="n">results</span> <span class="o">=</span> <span class="n">test_data</span><span class="p">.</span><span class="nf">copy</span><span class="p">()</span>
        <span class="n">results</span><span class="p">[</span><span class="sh">'</span><span class="s">is_anomaly</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">predictions</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span>
        <span class="n">results</span><span class="p">[</span><span class="sh">'</span><span class="s">anomaly_score</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">anomaly_scores</span>
        
        <span class="k">return</span> <span class="n">results</span>
    
    <span class="k">def</span> <span class="nf">visualize_anomalies</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">results</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ì´ìƒ íƒì§€ ê²°ê³¼ ì‹œê°í™”</span><span class="sh">"""</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
        
        <span class="c1"># ì‹œê°„ë³„ ì´ìƒ íŠ¸ë˜í”½
</span>        <span class="n">hourly_anomalies</span> <span class="o">=</span> <span class="n">results</span><span class="p">.</span><span class="nf">groupby</span><span class="p">(</span>
            <span class="n">pd</span><span class="p">.</span><span class="nf">to_datetime</span><span class="p">(</span><span class="n">results</span><span class="p">[</span><span class="sh">'</span><span class="s">timestamp</span><span class="sh">'</span><span class="p">]).</span><span class="n">dt</span><span class="p">.</span><span class="n">hour</span>
        <span class="p">)[</span><span class="sh">'</span><span class="s">is_anomaly</span><span class="sh">'</span><span class="p">].</span><span class="nf">sum</span><span class="p">()</span>
        
        <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">].</span><span class="nf">bar</span><span class="p">(</span><span class="n">hourly_anomalies</span><span class="p">.</span><span class="n">index</span><span class="p">,</span> <span class="n">hourly_anomalies</span><span class="p">.</span><span class="n">values</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">].</span><span class="nf">set_title</span><span class="p">(</span><span class="sh">'</span><span class="s">ì‹œê°„ëŒ€ë³„ ì´ìƒ íŠ¸ë˜í”½</span><span class="sh">'</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">].</span><span class="nf">set_xlabel</span><span class="p">(</span><span class="sh">'</span><span class="s">ì‹œê°„</span><span class="sh">'</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">].</span><span class="nf">set_ylabel</span><span class="p">(</span><span class="sh">'</span><span class="s">ì´ìƒ íŠ¸ë˜í”½ ìˆ˜</span><span class="sh">'</span><span class="p">)</span>
        
        <span class="c1"># IPë³„ ì´ìƒ ì ìˆ˜ ë¶„í¬
</span>        <span class="n">ip_scores</span> <span class="o">=</span> <span class="n">results</span><span class="p">.</span><span class="nf">groupby</span><span class="p">(</span><span class="sh">'</span><span class="s">src_ip</span><span class="sh">'</span><span class="p">)[</span><span class="sh">'</span><span class="s">anomaly_score</span><span class="sh">'</span><span class="p">].</span><span class="nf">mean</span><span class="p">().</span><span class="nf">sort_values</span><span class="p">()</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">].</span><span class="nf">barh</span><span class="p">(</span><span class="nf">range</span><span class="p">(</span><span class="nf">len</span><span class="p">(</span><span class="n">ip_scores</span><span class="p">.</span><span class="nf">tail</span><span class="p">(</span><span class="mi">10</span><span class="p">))),</span> <span class="n">ip_scores</span><span class="p">.</span><span class="nf">tail</span><span class="p">(</span><span class="mi">10</span><span class="p">).</span><span class="n">values</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">].</span><span class="nf">set_yticks</span><span class="p">(</span><span class="nf">range</span><span class="p">(</span><span class="nf">len</span><span class="p">(</span><span class="n">ip_scores</span><span class="p">.</span><span class="nf">tail</span><span class="p">(</span><span class="mi">10</span><span class="p">))))</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">].</span><span class="nf">set_yticklabels</span><span class="p">(</span><span class="n">ip_scores</span><span class="p">.</span><span class="nf">tail</span><span class="p">(</span><span class="mi">10</span><span class="p">).</span><span class="n">index</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">].</span><span class="nf">set_title</span><span class="p">(</span><span class="sh">'</span><span class="s">ìƒìœ„ 10ê°œ ì˜ì‹¬ IP</span><span class="sh">'</span><span class="p">)</span>
        
        <span class="c1"># í¬íŠ¸ ìŠ¤ìº” íŒ¨í„´
</span>        <span class="n">port_scan_ips</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="n">results</span><span class="p">[</span><span class="sh">'</span><span class="s">unique_dst_ports</span><span class="sh">'</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">100</span><span class="p">][</span><span class="sh">'</span><span class="s">src_ip</span><span class="sh">'</span><span class="p">].</span><span class="nf">value_counts</span><span class="p">()</span>
        <span class="k">if</span> <span class="nf">len</span><span class="p">(</span><span class="n">port_scan_ips</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">].</span><span class="nf">bar</span><span class="p">(</span><span class="nf">range</span><span class="p">(</span><span class="nf">len</span><span class="p">(</span><span class="n">port_scan_ips</span><span class="p">.</span><span class="nf">head</span><span class="p">(</span><span class="mi">10</span><span class="p">))),</span> <span class="n">port_scan_ips</span><span class="p">.</span><span class="nf">head</span><span class="p">(</span><span class="mi">10</span><span class="p">).</span><span class="n">values</span><span class="p">)</span>
            <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">].</span><span class="nf">set_xticks</span><span class="p">(</span><span class="nf">range</span><span class="p">(</span><span class="nf">len</span><span class="p">(</span><span class="n">port_scan_ips</span><span class="p">.</span><span class="nf">head</span><span class="p">(</span><span class="mi">10</span><span class="p">))))</span>
            <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">].</span><span class="nf">set_xticklabels</span><span class="p">(</span><span class="n">port_scan_ips</span><span class="p">.</span><span class="nf">head</span><span class="p">(</span><span class="mi">10</span><span class="p">).</span><span class="n">index</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>
            <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">].</span><span class="nf">set_title</span><span class="p">(</span><span class="sh">'</span><span class="s">í¬íŠ¸ ìŠ¤ìº” ì˜ì‹¬ IP</span><span class="sh">'</span><span class="p">)</span>
        
        <span class="c1"># ë°ì´í„° ì „ì†¡ëŸ‰ ë¶„í¬
</span>        <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">].</span><span class="nf">scatter</span><span class="p">(</span><span class="n">results</span><span class="p">[</span><span class="sh">'</span><span class="s">bytes</span><span class="sh">'</span><span class="p">],</span> <span class="n">results</span><span class="p">[</span><span class="sh">'</span><span class="s">anomaly_score</span><span class="sh">'</span><span class="p">],</span> 
                         <span class="n">c</span><span class="o">=</span><span class="n">results</span><span class="p">[</span><span class="sh">'</span><span class="s">is_anomaly</span><span class="sh">'</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">].</span><span class="nf">set_xlabel</span><span class="p">(</span><span class="sh">'</span><span class="s">ì „ì†¡ ë°”ì´íŠ¸</span><span class="sh">'</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">].</span><span class="nf">set_ylabel</span><span class="p">(</span><span class="sh">'</span><span class="s">ì´ìƒ ì ìˆ˜</span><span class="sh">'</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">].</span><span class="nf">set_title</span><span class="p">(</span><span class="sh">'</span><span class="s">ë°ì´í„° ì „ì†¡ëŸ‰ vs ì´ìƒ ì ìˆ˜</span><span class="sh">'</span><span class="p">)</span>
        
        <span class="n">plt</span><span class="p">.</span><span class="nf">tight_layout</span><span class="p">()</span>
        <span class="n">plt</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>

<span class="c1"># ì‚¬ìš© ì˜ˆì‹œ
</span><span class="n">detector</span> <span class="o">=</span> <span class="nc">NetworkAnomalyDetector</span><span class="p">()</span>

<span class="c1"># ëª¨ì˜ ë„¤íŠ¸ì›Œí¬ ë°ì´í„° ìƒì„±
</span><span class="n">training_data</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nc">DataFrame</span><span class="p">({</span>
    <span class="sh">'</span><span class="s">timestamp</span><span class="sh">'</span><span class="p">:</span> <span class="n">pd</span><span class="p">.</span><span class="nf">date_range</span><span class="p">(</span><span class="sh">'</span><span class="s">2024-03-01</span><span class="sh">'</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="sh">'</span><span class="s">1min</span><span class="sh">'</span><span class="p">),</span>
    <span class="sh">'</span><span class="s">src_ip</span><span class="sh">'</span><span class="p">:</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">choice</span><span class="p">([</span><span class="sh">'</span><span class="s">192.168.1.100</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">192.168.1.101</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">192.168.1.102</span><span class="sh">'</span><span class="p">],</span> <span class="mi">10000</span><span class="p">),</span>
    <span class="sh">'</span><span class="s">dst_ip</span><span class="sh">'</span><span class="p">:</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">choice</span><span class="p">([</span><span class="sh">'</span><span class="s">8.8.8.8</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">1.1.1.1</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">208.67.222.222</span><span class="sh">'</span><span class="p">],</span> <span class="mi">10000</span><span class="p">),</span>
    <span class="sh">'</span><span class="s">src_port</span><span class="sh">'</span><span class="p">:</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">randint</span><span class="p">(</span><span class="mi">1024</span><span class="p">,</span> <span class="mi">65535</span><span class="p">,</span> <span class="mi">10000</span><span class="p">),</span>
    <span class="sh">'</span><span class="s">dst_port</span><span class="sh">'</span><span class="p">:</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">choice</span><span class="p">([</span><span class="mi">80</span><span class="p">,</span> <span class="mi">443</span><span class="p">,</span> <span class="mi">53</span><span class="p">,</span> <span class="mi">22</span><span class="p">],</span> <span class="mi">10000</span><span class="p">),</span>
    <span class="sh">'</span><span class="s">protocol</span><span class="sh">'</span><span class="p">:</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">choice</span><span class="p">([</span><span class="sh">'</span><span class="s">TCP</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">UDP</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">ICMP</span><span class="sh">'</span><span class="p">],</span> <span class="mi">10000</span><span class="p">),</span>
    <span class="sh">'</span><span class="s">bytes</span><span class="sh">'</span><span class="p">:</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">lognormal</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">10000</span><span class="p">),</span>
    <span class="sh">'</span><span class="s">packets</span><span class="sh">'</span><span class="p">:</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">poisson</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">10000</span><span class="p">),</span>
    <span class="sh">'</span><span class="s">duration</span><span class="sh">'</span><span class="p">:</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">exponential</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">10000</span><span class="p">)</span>
<span class="p">})</span>

<span class="n">detector</span><span class="p">.</span><span class="nf">train</span><span class="p">(</span><span class="n">training_data</span><span class="p">)</span>

<span class="c1"># í…ŒìŠ¤íŠ¸ ë°ì´í„°ì— ì¼ë¶€ ì´ìƒ íŠ¸ë˜í”½ í¬í•¨
</span><span class="n">test_data</span> <span class="o">=</span> <span class="n">training_data</span><span class="p">.</span><span class="nf">sample</span><span class="p">(</span><span class="mi">1000</span><span class="p">).</span><span class="nf">copy</span><span class="p">()</span>
<span class="c1"># í¬íŠ¸ ìŠ¤ìº” ì‹œë®¬ë ˆì´ì…˜
</span><span class="n">test_data</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">50</span><span class="p">,</span> <span class="sh">'</span><span class="s">dst_port</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="nf">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">51</span><span class="p">)</span>
<span class="n">test_data</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">50</span><span class="p">,</span> <span class="sh">'</span><span class="s">src_ip</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="sh">'</span><span class="s">10.0.0.100</span><span class="sh">'</span>  <span class="c1"># ì™¸ë¶€ IP
</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">detector</span><span class="p">.</span><span class="nf">detect_anomalies</span><span class="p">(</span><span class="n">test_data</span><span class="p">)</span>
<span class="n">detector</span><span class="p">.</span><span class="nf">visualize_anomalies</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>
</code></pre></div></div>

<h2 id="ë§ˆë¬´ë¦¬">ë§ˆë¬´ë¦¬</h2>

<p>ì´ ì‹œë¦¬ì¦ˆë¥¼ í†µí•´ ë„¤íŠ¸ì›Œí‚¹ì˜ ëª¨ë“  ì¸¡ë©´ì„ ë‹¤ë¤˜ìŠµë‹ˆë‹¤:</p>

<ol>
  <li><strong>Part 1</strong>: OSI 7ê³„ì¸µê³¼ TCP/IP í”„ë¡œí† ì½œ ê¸°ì´ˆ</li>
  <li><strong>Part 2</strong>: IP ì£¼ì†Œ ì²´ê³„ì™€ ì„œë¸Œë„¤íŒ…</li>
  <li><strong>Part 3</strong>: ë¼ìš°íŒ…ê³¼ ìŠ¤ìœ„ì¹­ ê³ ê¸‰ ê¸°ìˆ </li>
  <li><strong>Part 4</strong>: ë¬´ì„  ë„¤íŠ¸ì›Œí‚¹ê³¼ ìµœì‹  ê¸°ìˆ  ë™í–¥</li>
  <li><strong>Part 5</strong>: ë„¤íŠ¸ì›Œí¬ ë³´ì•ˆê³¼ ê³ ê¸‰ íŠ¸ëŸ¬ë¸”ìŠˆíŒ…</li>
</ol>

<p>ì‹¤ë¬´ì—ì„œ ì´ ì§€ì‹ë“¤ì„ ì ê·¹ í™œìš©í•˜ì—¬ ì•ˆì „í•˜ê³  íš¨ìœ¨ì ì¸ ë„¤íŠ¸ì›Œí¬ ì¸í”„ë¼ë¥¼ êµ¬ì¶•í•˜ì‹œê¸° ë°”ëë‹ˆë‹¤! ğŸŒğŸ”’</p>

<h2 id="ì¶”ì²œ-í•™ìŠµ-ìë£Œ">ì¶”ì²œ í•™ìŠµ ìë£Œ</h2>

<ul>
  <li><strong>ì„œì </strong>: â€œComputer Networking: A Top-Down Approachâ€ - Kurose &amp; Ross</li>
  <li><strong>ì‹¤ìŠµ</strong>: Packet Tracer, GNS3, EVE-NG</li>
  <li><strong>ì¸ì¦</strong>: CCNA, CCNP, CCIE (Cisco), JNCIA, JNCIP (Juniper)</li>
  <li><strong>ì˜¤í”ˆì†ŒìŠ¤</strong>: Wireshark, pfSense, OpenWrt, Suricata</li>
</ul>

<p>ë„¤íŠ¸ì›Œí¬ ë§ˆìŠ¤í„°ì˜ ê¸¸, í•¨ê»˜ ê±¸ì–´ê°€ìš”! ğŸš€</p>

  </div>

  <footer class="post-footer">
    <div class="post-navigation"><div class="nav-previous">
        <a href="/infra-blog/blog/2025/02/19/linux-security-guide-part3.html" rel="prev">
          <i class="icon-left-arrow"></i>
          <span class="nav-title">ë¦¬ëˆ…ìŠ¤ ë³´ì•ˆ ì™„ì „ ê°€ì´ë“œ 3í¸ - SELinux/AppArmorì™€ ì‹œìŠ¤í…œ í•˜ë“œë‹ | ...</span>
        </a>
      </div><div class="nav-next">
        <a href="/infra-blog/blog/2025/04/12/linux-security-guide-part4.html" rel="next">
          <span class="nav-title">ë¦¬ëˆ…ìŠ¤ ë³´ì•ˆ ì™„ì „ ê°€ì´ë“œ 4í¸ - ì¹¨ì… íƒì§€ì™€ ì‹¤ì‹œê°„ ëª¨ë‹ˆí„°ë§ | Linux Secu...</span>
          <i class="icon-right-arrow"></i>
        </a>
      </div></div>
  </footer>
  </article></div>

    </section>
    <footer class="condensed">
      <ul class="social about-footer condensed"><a href="https://github.com/leeyonghe" target="_blank">
          <li>
            <i class="icon-github-circled"></i>
          </li>
        </a><a href="https://www.linkedin.com/in/lee-yong-hee-18912454/" target="_blank">
          <li>
            <i class="icon-linkedin-squared"></i>
          </li>
        </a><!----></ul><p class="about-footer condensed">&copy;
        2025</p><div class="about-footer condensed">
        <p>Dark Mode
          <i class="icon-moon"></i>
          <label class="switch">
            <input type="checkbox" class="dark-mode-toggle">
            <span class="slider round" onclick="toggleDarkMode()"></span>
          </label>
        </p>
      </div>
    </footer>
  </main>
  
  <script type="text/javascript" src="/infra-blog/assets/js/darkmode.js"></script>
  
  <script src="/infra-blog/assets/js/simple-jekyll-search.min.js"></script>
  <script src="/infra-blog/assets/js/search.js"></script>
  
</body>

</html>
