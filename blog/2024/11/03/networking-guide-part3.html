<!DOCTYPE html>
<html lang="en">

<head><meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<link href="https://fonts.googleapis.com/css?family=Merriweather:300|Raleway:400,700" rel="stylesheet">
<link rel="stylesheet" href="/infra-blog/assets/css/style.css">
<link rel="stylesheet" href="/infra-blog/assets/css/post-detail.css">
<style>
/* Post Detail Page Styling */
.post-container article {
  background: #fff;
  border-radius: 12px;
  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
  padding: 40px;
  margin: 30px auto;
  max-width: 800px;
}

@media screen and (max-width: 768px) {
  .post-container article {
    margin: 20px;
    padding: 25px;
    border-radius: 8px;
  }
}

.post-container article .post-header {
  border-bottom: 2px solid #f5f5f5;
  padding-bottom: 25px;
  margin-bottom: 30px;
}

.post-container article .post-header .post-title {
  font-size: 2.2em;
  font-weight: 700;
  color: #2c3e50;
  line-height: 1.3;
  margin-bottom: 15px;
}

@media screen and (max-width: 768px) {
  .post-container article .post-header .post-title {
    font-size: 1.8em;
  }
}

.post-container article .post-header .post-meta {
  display: flex;
  align-items: center;
  gap: 20px;
  flex-wrap: wrap;
}

.post-container article .post-header .post-meta .post-date {
  display: flex;
  align-items: center;
  color: #666;
  font-size: 0.9em;
}

.post-container article .post-header .post-meta .post-date i {
  margin-right: 8px;
  color: #888;
}

.post-container article .post-header .post-meta .post-categories-wrapper {
  display: flex;
  align-items: center;
}

.post-container article .post-header .post-meta .post-categories-wrapper i {
  margin-right: 8px;
  color: #888;
}

.post-container article .post-header .post-meta .post-categories-wrapper .post-categories {
  display: flex;
  gap: 8px;
  list-style: none;
  margin: 0;
  padding: 0;
}

.post-container article .post-header .post-meta .post-categories-wrapper .post-categories li {
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  color: white;
  padding: 4px 12px;
  border-radius: 20px;
  font-size: 0.8em;
  font-weight: 500;
  text-transform: capitalize;
}

.post-container article .post-content {
  font-size: 1.1em;
  line-height: 1.8;
  color: #333;
}

.post-container article .post-content p {
  margin-bottom: 1.2em;
}

.post-container article .post-content h1,
.post-container article .post-content h2,
.post-container article .post-content h3,
.post-container article .post-content h4,
.post-container article .post-content h5,
.post-container article .post-content h6 {
  color: #2c3e50;
  margin: 1.5em 0 0.8em 0;
  font-weight: 600;
}

.post-container article .post-content h2 {
  font-size: 1.8em;
  border-bottom: 2px solid #3498db;
  padding-bottom: 10px;
}

.post-container article .post-content h3 {
  font-size: 1.5em;
  color: #34495e;
}

.post-container article .post-content code {
  background: #f8f9fa;
  padding: 2px 6px;
  border-radius: 4px;
  font-size: 0.9em;
  color: #e74c3c;
}

.post-container article .post-content pre {
  background: #f8f9fa;
  border: 1px solid #e9ecef;
  border-radius: 6px;
  padding: 15px;
  overflow-x: auto;
  margin: 1.5em 0;
}

.post-container article .post-content pre code {
  background: none;
  color: #333;
  padding: 0;
}

.post-container article .post-content blockquote {
  border-left: 4px solid #3498db;
  background: #f8f9fa;
  padding: 15px 20px;
  margin: 1.5em 0;
  font-style: italic;
  color: #555;
}

.post-container article .post-content img {
  max-width: 100%;
  height: auto;
  border-radius: 8px;
  margin: 1.5em 0;
  box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
}

.post-container article .post-content ul,
.post-container article .post-content ol {
  padding-left: 1.5em;
  margin-bottom: 1.2em;
}

.post-container article .post-content ul li,
.post-container article .post-content ol li {
  margin-bottom: 0.5em;
}

.post-container article .post-content a {
  color: #3498db;
  text-decoration: none;
  border-bottom: 1px solid transparent;
  transition: all 0.3s ease;
}

.post-container article .post-content a:hover {
  border-bottom-color: #3498db;
}

.post-container article .post-footer {
  border-top: 2px solid #f5f5f5;
  padding-top: 25px;
  margin-top: 40px;
}

.post-container article .post-footer .post-navigation {
  display: flex;
  justify-content: space-between;
  align-items: center;
  gap: 20px;
}

@media screen and (max-width: 768px) {
  .post-container article .post-footer .post-navigation {
    flex-direction: column;
    gap: 15px;
  }
}

.post-container article .post-footer .post-navigation .nav-previous,
.post-container article .post-footer .post-navigation .nav-next {
  flex: 1;
}

.post-container article .post-footer .post-navigation .nav-previous a,
.post-container article .post-footer .post-navigation .nav-next a {
  display: flex;
  align-items: center;
  padding: 15px 20px;
  background: #f8f9fa;
  border-radius: 8px;
  text-decoration: none;
  color: #333;
  transition: all 0.3s ease;
  border: 2px solid transparent;
}

.post-container article .post-footer .post-navigation .nav-previous a:hover,
.post-container article .post-footer .post-navigation .nav-next a:hover {
  background: #e9ecef;
  border-color: #3498db;
  transform: translateY(-2px);
}

.post-container article .post-footer .post-navigation .nav-previous a i,
.post-container article .post-footer .post-navigation .nav-next a i {
  color: #3498db;
  margin: 0 8px;
}

.post-container article .post-footer .post-navigation .nav-previous a .nav-title,
.post-container article .post-footer .post-navigation .nav-next a .nav-title {
  font-weight: 500;
}

.post-container article .post-footer .post-navigation .nav-previous a {
  justify-content: flex-start;
}

.post-container article .post-footer .post-navigation .nav-next a {
  justify-content: flex-end;
  text-align: right;
}
</style>
<title>ë„¤íŠ¸ì›Œí‚¹ ì™„ì „ ê°€ì´ë“œ 3í¸ - ë¼ìš°íŒ…ê³¼ ìŠ¤ìœ„ì¹­ ì‹¬í™” | Complete Network Guide Part 3 - Advanced Routing & Switching</title>

<script type="text/javascript" src="/infra-blog/assets/js/darkmode.js"></script>

</head><body>
  <main class="container">
    <section class="about">
      <div class="about-header condensed">
      <div class="about-title">
      <a href="/infra-blog/">
        
        <img src="/infra-blog/assets/portfolio.png" alt="Infrastructure Engineer" />
        
      </a>
      <h2 id="title">
        <a href="/infra-blog/">Infrastructure Engineer</a>
      </h2>
      </div><p class="tagline">DevOps & Cloud Infrastructure Specialist</p></div>
      
      <ul class="social about-footer condensed"><a href="https://github.com/leeyonghe" target="_blank">
          <li>
            <i class="icon-github-circled"></i>
          </li>
        </a><a href="https://www.linkedin.com/in/lee-yong-hee-18912454/" target="_blank">
          <li>
            <i class="icon-linkedin-squared"></i>
          </li>
        </a><!----></ul><p class="about-footer condensed">&copy;
        2025</p><div class="about-footer condensed">
        <p>Dark Mode
          <i class="icon-moon"></i>
          <label class="switch">
            <input type="checkbox" class="dark-mode-toggle">
            <span class="slider round" onclick="toggleDarkMode()"></span>
          </label>
        </p>
      </div>
    </section>
    <section class="content">
      <style>
/* Post Detail Page Styling - Direct Inline */
.post-container article {
  background: #fff !important;
  border: none !important;
  border-top: none !important;
  border-right: none !important;
  border-bottom: none !important;
  border-left: none !important;
  border-width: 0 !important;
  border-style: none !important;
  outline: none !important;
  border-radius: 12px !important;
  box-shadow: none !important;
  padding: 40px !important;
  margin: 30px auto !important;
  max-width: 800px !important;
}

.post-container article .post-header .post-title {
  font-size: 2.2em !important;
  font-weight: 700 !important;
  color: #2c3e50 !important;
  line-height: 1.3 !important;
}

.post-container article .post-header {
  border-bottom: none !important;
  padding-bottom: 25px !important;
  margin-bottom: 30px !important;
}

.post-container article .post-content {
  font-size: 1.1em !important;
  line-height: 1.8 !important;
  color: #333 !important;
}

.post-container article .post-content h2 {
  font-size: 1.8em !important;
  border-bottom: none !important;
  padding-bottom: 10px !important;
  color: #2c3e50 !important;
}

.post-container article .post-header .post-meta .post-categories li {
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%) !important;
  color: white !important;
  padding: 4px 12px !important;
  border-radius: 20px !important;
  font-size: 0.8em !important;
  list-style: none !important;
  display: inline-block !important;
  margin-right: 8px !important;
}

.post-container article .post-footer {
  border-top: none !important;
  padding-top: 25px !important;
  margin-top: 40px !important;
}

/* ëª¨ë“  borderì™€ box-shadow ê°•ì œ ì œê±° */
.post-container article *,
.post-container article *::before,
.post-container article *::after {
  border: none !important;
  border-top: none !important;
  border-right: none !important;
  border-bottom: none !important;
  border-left: none !important;
  border-width: 0 !important;
  border-style: none !important;
  outline: none !important;
  box-shadow: none !important;
}

/* ì½”ë“œ ë¸”ë¡ê³¼ pre íƒœê·¸ë„ border, box-shadow ì œê±° */
.post-container article pre,
.post-container article code,
.post-container article .highlight,
.post-container article .highlighter-rouge {
  border: none !important;
  outline: none !important;
  box-shadow: none !important;
}
</style><div class="post-container">
  <article>
    <header class="post-header">
    <h1 class="post-title">ë„¤íŠ¸ì›Œí‚¹ ì™„ì „ ê°€ì´ë“œ 3í¸ - ë¼ìš°íŒ…ê³¼ ìŠ¤ìœ„ì¹­ ì‹¬í™” | Complete Network Guide Part 3 - Advanced Routing &amp; Switching</h1>
    <div class="post-meta">
      <div class="post-date">
        <i class="icon-calendar"></i>
        <time datetime="2024-11-03T02:00:00+00:00">Nov 3, 2024</time>
      </div><div class="post-categories-wrapper">
        <i class="icon-tag"></i>
        <ul class="post-categories"><li>Networking</li><li>Routing-Switching</li></ul>
      </div></div>
  </header>

  <div class="post-content">
    <p>ë„¤íŠ¸ì›Œí¬ì˜ í•µì‹¬ì¸ ë¼ìš°íŒ…ê³¼ ìŠ¤ìœ„ì¹­ ê¸°ìˆ ì„ ì‹¬í™” í•™ìŠµí•˜ì—¬ ëŒ€ê·œëª¨ ë„¤íŠ¸ì›Œí¬ ìš´ì˜ ëŠ¥ë ¥ì„ ê°–ì¶°ë³´ê² ìŠµë‹ˆë‹¤.</p>

<h2 id="ë¼ìš°íŒ…-í”„ë¡œí† ì½œ--routing-protocols">ë¼ìš°íŒ… í”„ë¡œí† ì½œ | Routing Protocols</h2>

<h3 id="ï¸-ë¼ìš°íŒ…-ê¸°ë³¸-ê°œë…">ğŸ—ºï¸ ë¼ìš°íŒ… ê¸°ë³¸ ê°œë…</h3>

<p>ë¼ìš°íŒ…ì€ íŒ¨í‚·ì´ ëª©ì ì§€ê¹Œì§€ ê°€ëŠ” ìµœì ì˜ ê²½ë¡œë¥¼ ì°¾ëŠ” ê³¼ì •ì…ë‹ˆë‹¤.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># ë¼ìš°íŒ… í…Œì´ë¸” êµ¬ì„± ìš”ì†Œ</span>
ëª©ì ì§€ ë„¤íŠ¸ì›Œí¬ | ì„œë¸Œë„· ë§ˆìŠ¤í¬ | ê²Œì´íŠ¸ì›¨ì´ | ì¸í„°í˜ì´ìŠ¤ | ë©”íŠ¸ë¦­
192.168.1.0    | /24          | ì§ì ‘ì—°ê²°    | eth0      | 0
10.0.0.0       | /8           | 192.168.1.1| eth0      | 1
0.0.0.0        | /0           | 192.168.1.1| eth0      | 1 <span class="o">(</span>ê¸°ë³¸ê²½ë¡œ<span class="o">)</span>
</code></pre></div></div>

<h3 id="-ë¼ìš°íŒ…-í”„ë¡œí† ì½œ-ë¶„ë¥˜">ğŸ“Š ë¼ìš°íŒ… í”„ë¡œí† ì½œ ë¶„ë¥˜</h3>

<h4 id="distance-vector-vs-link-state">Distance Vector vs Link State</h4>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Distance Vector (ê±°ë¦¬ ë²¡í„°):
- RIP (Routing Information Protocol)
- ë²¨ë§Œ-í¬ë“œ ì•Œê³ ë¦¬ì¦˜ ì‚¬ìš©
- í™‰ ì¹´ìš´íŠ¸ ê¸°ë°˜ ë©”íŠ¸ë¦­
- ë‹¨ìˆœí•˜ì§€ë§Œ ìˆ˜ë ´ ì†ë„ ëŠë¦¼

Link State (ë§í¬ ìƒíƒœ):  
- OSPF (Open Shortest Path First)
- ë‹¤ìµìŠ¤íŠ¸ë¼ ì•Œê³ ë¦¬ì¦˜ ì‚¬ìš©
- ëŒ€ì—­í­ ê¸°ë°˜ ë©”íŠ¸ë¦­
- ë¹ ë¥¸ ìˆ˜ë ´, í™•ì¥ì„± ì¢‹ìŒ
</code></pre></div></div>

<h4 id="igp-vs-egp">IGP vs EGP</h4>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>IGP (Interior Gateway Protocol):
- ê°™ì€ ììœ¨ ì‹œìŠ¤í…œ(AS) ë‚´ë¶€
- RIP, OSPF, EIGRP

EGP (Exterior Gateway Protocol):
- ì„œë¡œ ë‹¤ë¥¸ AS ê°„
- BGP (Border Gateway Protocol)
</code></pre></div></div>

<h3 id="-rip-routing-information-protocol">ğŸ”„ RIP (Routing Information Protocol)</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Cisco ë¼ìš°í„° RIP ì„¤ì •</span>
Router<span class="o">(</span>config<span class="o">)</span><span class="c"># router rip</span>
Router<span class="o">(</span>config-router<span class="o">)</span><span class="c"># version 2</span>
Router<span class="o">(</span>config-router<span class="o">)</span><span class="c"># network 192.168.1.0</span>
Router<span class="o">(</span>config-router<span class="o">)</span><span class="c"># network 10.0.0.0</span>
Router<span class="o">(</span>config-router<span class="o">)</span><span class="c"># no auto-summary</span>
Router<span class="o">(</span>config-router<span class="o">)</span><span class="c"># passive-interface fastethernet 0/0</span>

<span class="c"># Linux Quagga/FRR RIP ì„¤ì •</span>
router rip
 version 2
 network 192.168.1.0/24
 network 10.0.0.0/8
 redistribute connected
 redistribute static

<span class="c"># RIP ì •ë³´ í™•ì¸</span>
show ip route rip
show ip rip database
debug ip rip
</code></pre></div></div>

<h4 id="ripì˜-íŠ¹ì§•ê³¼-í•œê³„">RIPì˜ íŠ¹ì§•ê³¼ í•œê³„</h4>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ì¥ì :
- êµ¬ì„±ì´ ê°„ë‹¨í•¨
- ì†Œê·œëª¨ ë„¤íŠ¸ì›Œí¬ì— ì í•©
- í‘œì¤€ í”„ë¡œí† ì½œ

ë‹¨ì :
- í™‰ ì¹´ìš´íŠ¸ ì œí•œ (15í™‰)
- ëŠë¦° ìˆ˜ë ´ ì†ë„
- ëŒ€ì—­í­ ê³ ë ¤í•˜ì§€ ì•ŠìŒ
- ë£¨í”„ ë°©ì§€ ë©”ì»¤ë‹ˆì¦˜ ì œí•œì 
</code></pre></div></div>

<h3 id="-ospf-open-shortest-path-first">ğŸŒ OSPF (Open Shortest Path First)</h3>

<p>OSPFëŠ” ëŒ€ê·œëª¨ ë„¤íŠ¸ì›Œí¬ì—ì„œ ê°€ì¥ ë„ë¦¬ ì‚¬ìš©ë˜ëŠ” ë§í¬ ìƒíƒœ ë¼ìš°íŒ… í”„ë¡œí† ì½œì…ë‹ˆë‹¤.</p>

<h4 id="ospf-ê¸°ë³¸-ê°œë…">OSPF ê¸°ë³¸ ê°œë…</h4>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># OSPF ìš©ì–´</span>
Area: ë¼ìš°í„°ë“¤ì˜ ë…¼ë¦¬ì  ê·¸ë£¹
ABR <span class="o">(</span>Area Border Router<span class="o">)</span>: Area ê²½ê³„ ë¼ìš°í„°
ASBR <span class="o">(</span>Autonomous System Boundary Router<span class="o">)</span>: AS ê²½ê³„ ë¼ìš°í„°  
DR <span class="o">(</span>Designated Router<span class="o">)</span>: ëŒ€í‘œ ë¼ìš°í„°
BDR <span class="o">(</span>Backup Designated Router<span class="o">)</span>: ë°±ì—… ëŒ€í‘œ ë¼ìš°í„°

<span class="c"># LSA (Link State Advertisement) ìœ í˜•</span>
LSA Type 1: Router LSA <span class="o">(</span>ë¼ìš°í„° ì •ë³´<span class="o">)</span>
LSA Type 2: Network LSA <span class="o">(</span>ë„¤íŠ¸ì›Œí¬ ì •ë³´<span class="o">)</span>
LSA Type 3: Summary LSA <span class="o">(</span>Area ê°„ ìš”ì•½<span class="o">)</span>
LSA Type 4: ASBR Summary LSA
LSA Type 5: External LSA <span class="o">(</span>ì™¸ë¶€ ë¼ìš°íŠ¸<span class="o">)</span>
</code></pre></div></div>

<h4 id="ospf-ì„¤ì •-ì‹¤ìŠµ">OSPF ì„¤ì • ì‹¤ìŠµ</h4>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Cisco ë¼ìš°í„° OSPF ì„¤ì •</span>
Router<span class="o">(</span>config<span class="o">)</span><span class="c"># router ospf 1</span>
Router<span class="o">(</span>config-router<span class="o">)</span><span class="c"># router-id 1.1.1.1</span>
Router<span class="o">(</span>config-router<span class="o">)</span><span class="c"># network 192.168.1.0 0.0.0.255 area 0</span>
Router<span class="o">(</span>config-router<span class="o">)</span><span class="c"># network 10.0.0.0 0.255.255.255 area 1</span>
Router<span class="o">(</span>config-router<span class="o">)</span><span class="c"># area 1 stub</span>

<span class="c"># ì¸í„°í˜ì´ìŠ¤ë³„ OSPF ì„¤ì •</span>
Router<span class="o">(</span>config<span class="o">)</span><span class="c"># interface fastethernet 0/0</span>
Router<span class="o">(</span>config-if<span class="o">)</span><span class="c"># ip ospf cost 100</span>
Router<span class="o">(</span>config-if<span class="o">)</span><span class="c"># ip ospf priority 255</span>
Router<span class="o">(</span>config-if<span class="o">)</span><span class="c"># ip ospf hello-interval 5</span>
Router<span class="o">(</span>config-if<span class="o">)</span><span class="c"># ip ospf dead-interval 20</span>

<span class="c"># Linux FRR OSPF ì„¤ì •</span>
router ospf
 ospf router-id 1.1.1.1
 network 192.168.1.0/24 area 0.0.0.0
 network 10.0.0.0/8 area 0.0.0.1
 area 0.0.0.1 stub

<span class="c"># OSPF ì •ë³´ í™•ì¸</span>
show ip ospf neighbor
show ip ospf database  
show ip ospf interface
show ip route ospf
</code></pre></div></div>

<h4 id="ospf-area-ì„¤ê³„">OSPF Area ì„¤ê³„</h4>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Multi-Area OSPF ì„¤ê³„ ì˜ˆì‹œ</span>
Area 0 <span class="o">(</span>Backbone<span class="o">)</span>: 10.0.0.0/24
â”œâ”€â”€ Area 1 <span class="o">(</span>Sales<span class="o">)</span>: 10.1.0.0/16
â”œâ”€â”€ Area 2 <span class="o">(</span>Engineering<span class="o">)</span>: 10.2.0.0/16  
â””â”€â”€ Area 3 <span class="o">(</span>Guest<span class="o">)</span>: 10.3.0.0/16

<span class="c"># Area ìœ í˜•</span>
Standard Area: ëª¨ë“  LSA í—ˆìš©
Stub Area: Type 5 LSA ì°¨ë‹¨, ê¸°ë³¸ ê²½ë¡œ ì£¼ì…
Totally Stub: Type 3,4,5 LSA ì°¨ë‹¨
NSSA: Type 5 LSAë¥¼ Type 7ë¡œ ë³€í™˜
</code></pre></div></div>

<h3 id="-bgp-border-gateway-protocol">ğŸŒ BGP (Border Gateway Protocol)</h3>

<p>BGPëŠ” ì¸í„°ë„·ì˜ ë¼ìš°íŒ…ì„ ë‹´ë‹¹í•˜ëŠ” ê²½ë¡œ ë²¡í„° í”„ë¡œí† ì½œì…ë‹ˆë‹¤.</p>

<h4 id="bgp-ê¸°ë³¸-ê°œë…">BGP ê¸°ë³¸ ê°œë…</h4>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># BGP ì†ì„±</span>
AS-Path: AS ë²ˆí˜¸ ê²½ë¡œ
Next-Hop: ë‹¤ìŒ í™‰ ì£¼ì†Œ  
Local Preference: ë¡œì»¬ ìš°ì„ ìˆœìœ„ <span class="o">(</span>ë†’ì„ìˆ˜ë¡ ì„ í˜¸<span class="o">)</span>
MED: Multi-Exit Discriminator <span class="o">(</span>ë‚®ì„ìˆ˜ë¡ ì„ í˜¸<span class="o">)</span>
Origin: ê²½ë¡œ ë°œìƒì§€ <span class="o">(</span>IGP <span class="o">&gt;</span> EGP <span class="o">&gt;</span> Incomplete<span class="o">)</span>
Community: ë¼ìš°íŒ… ì •ì±… íƒœê·¸
</code></pre></div></div>

<h4 id="bgp-ì„¤ì •-ì˜ˆì‹œ">BGP ì„¤ì • ì˜ˆì‹œ</h4>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Cisco ë¼ìš°í„° BGP ì„¤ì •</span>
Router<span class="o">(</span>config<span class="o">)</span><span class="c"># router bgp 65001</span>
Router<span class="o">(</span>config-router<span class="o">)</span><span class="c"># bgp router-id 1.1.1.1</span>
Router<span class="o">(</span>config-router<span class="o">)</span><span class="c"># neighbor 203.0.113.1 remote-as 65002</span>
Router<span class="o">(</span>config-router<span class="o">)</span><span class="c"># neighbor 203.0.113.1 description "ISP-A Connection"</span>
Router<span class="o">(</span>config-router<span class="o">)</span><span class="c"># network 192.168.0.0 mask 255.255.0.0</span>
Router<span class="o">(</span>config-router<span class="o">)</span><span class="c"># aggregate-address 192.168.0.0 255.255.0.0 summary-only</span>

<span class="c"># BGP ê²½ë¡œ ì •ì±… ì„¤ì •</span>
Router<span class="o">(</span>config<span class="o">)</span><span class="c"># ip prefix-list ALLOW-CUSTOMERS seq 10 permit 192.168.0.0/16 le 24</span>
Router<span class="o">(</span>config<span class="o">)</span><span class="c"># route-map CUSTOMER-IN permit 10</span>
Router<span class="o">(</span>config-route-map<span class="o">)</span><span class="c"># match ip address prefix-list ALLOW-CUSTOMERS</span>
Router<span class="o">(</span>config-route-map<span class="o">)</span><span class="c"># set local-preference 200</span>

Router<span class="o">(</span>config<span class="o">)</span><span class="c"># router bgp 65001  </span>
Router<span class="o">(</span>config-router<span class="o">)</span><span class="c"># neighbor 203.0.113.1 route-map CUSTOMER-IN in</span>

<span class="c"># Linux FRR BGP ì„¤ì •</span>
router bgp 65001
 bgp router-id 1.1.1.1
 neighbor 203.0.113.1 remote-as 65002
 neighbor 203.0.113.1 description ISP-A
 address-family ipv4 unicast
  network 192.168.0.0/16
  neighbor 203.0.113.1 activate
</code></pre></div></div>

<h2 id="ìŠ¤ìœ„ì¹­-ê¸°ìˆ --switching-technology">ìŠ¤ìœ„ì¹­ ê¸°ìˆ  | Switching Technology</h2>

<h3 id="-ì´ë”ë„·-ìŠ¤ìœ„ì¹­-ê¸°ë³¸">ğŸ”Œ ì´ë”ë„· ìŠ¤ìœ„ì¹­ ê¸°ë³¸</h3>

<h4 id="mac-ì£¼ì†Œ-í•™ìŠµ-ê³¼ì •">MAC ì£¼ì†Œ í•™ìŠµ ê³¼ì •</h4>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># 1ë‹¨ê³„: MAC ì£¼ì†Œ í…Œì´ë¸”ì´ ë¹„ì–´ìˆìŒ</span>
Switch# show mac address-table
          Mac Address Table
<span class="nt">-------------------------------------------</span>
Vlan    Mac Address       Type        Ports
<span class="nt">----</span>    <span class="nt">-----------</span>       <span class="nt">--------</span>    <span class="nt">-----</span>

<span class="c"># 2ë‹¨ê³„: PC-A(00:11:22:33:44:AA)ì—ì„œ PC-Bë¡œ í”„ë ˆì„ ì „ì†¡</span>
<span class="c"># ìŠ¤ìœ„ì¹˜ê°€ í¬íŠ¸ 1ì—ì„œ ìˆ˜ì‹ , MAC ì£¼ì†Œ í•™ìŠµ</span>

<span class="c"># 3ë‹¨ê³„: MAC ì£¼ì†Œ í…Œì´ë¸” ì—…ë°ì´íŠ¸  </span>
Switch# show mac address-table
          Mac Address Table
<span class="nt">-------------------------------------------</span>
Vlan    Mac Address       Type        Ports
<span class="nt">----</span>    <span class="nt">-----------</span>       <span class="nt">--------</span>    <span class="nt">-----</span>
   1    0011.2233.44aa    DYNAMIC     Fa0/1

<span class="c"># 4ë‹¨ê³„: ëª©ì ì§€ MAC ì£¼ì†Œë¥¼ ëª¨ë¥´ë¯€ë¡œ í”ŒëŸ¬ë”©</span>
<span class="c"># 5ë‹¨ê³„: PC-Bê°€ ì‘ë‹µí•˜ë©´ í¬íŠ¸ 2ì—ì„œ í•™ìŠµ</span>
</code></pre></div></div>

<h4 id="ìŠ¤ìœ„ì¹˜-í¬íŠ¸-ì„¤ì •">ìŠ¤ìœ„ì¹˜ í¬íŠ¸ ì„¤ì •</h4>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># ì•¡ì„¸ìŠ¤ í¬íŠ¸ ì„¤ì • (ë‹¨ì¼ VLAN)</span>
Switch<span class="o">(</span>config<span class="o">)</span><span class="c"># interface fastethernet 0/1</span>
Switch<span class="o">(</span>config-if<span class="o">)</span><span class="c"># switchport mode access</span>
Switch<span class="o">(</span>config-if<span class="o">)</span><span class="c"># switchport access vlan 10</span>
Switch<span class="o">(</span>config-if<span class="o">)</span><span class="c"># switchport port-security</span>
Switch<span class="o">(</span>config-if<span class="o">)</span><span class="c"># switchport port-security maximum 2</span>
Switch<span class="o">(</span>config-if<span class="o">)</span><span class="c"># switchport port-security violation shutdown</span>

<span class="c"># íŠ¸ë í¬ í¬íŠ¸ ì„¤ì • (ë‹¤ì¤‘ VLAN)</span>
Switch<span class="o">(</span>config<span class="o">)</span><span class="c"># interface fastethernet 0/24</span>
Switch<span class="o">(</span>config-if<span class="o">)</span><span class="c"># switchport mode trunk</span>
Switch<span class="o">(</span>config-if<span class="o">)</span><span class="c"># switchport trunk encapsulation dot1q</span>
Switch<span class="o">(</span>config-if<span class="o">)</span><span class="c"># switchport trunk allowed vlan 10,20,30</span>
Switch<span class="o">(</span>config-if<span class="o">)</span><span class="c"># switchport trunk native vlan 1</span>
</code></pre></div></div>

<h3 id="ï¸-vlan-virtual-local-area-network">ğŸ·ï¸ VLAN (Virtual Local Area Network)</h3>

<p>VLANì€ ë¬¼ë¦¬ì  ìœ„ì¹˜ì™€ ê´€ê³„ì—†ì´ ë…¼ë¦¬ì ìœ¼ë¡œ ë„¤íŠ¸ì›Œí¬ë¥¼ ë¶„í• í•˜ëŠ” ê¸°ìˆ ì…ë‹ˆë‹¤.</p>

<h4 id="vlan-ì„¤ì •-ë°-ê´€ë¦¬">VLAN ì„¤ì • ë° ê´€ë¦¬</h4>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># VLAN ìƒì„±</span>
Switch<span class="o">(</span>config<span class="o">)</span><span class="c"># vlan 10</span>
Switch<span class="o">(</span>config-vlan<span class="o">)</span><span class="c"># name SALES</span>
Switch<span class="o">(</span>config-vlan<span class="o">)</span><span class="c"># vlan 20  </span>
Switch<span class="o">(</span>config-vlan<span class="o">)</span><span class="c"># name ENGINEERING</span>
Switch<span class="o">(</span>config-vlan<span class="o">)</span><span class="c"># vlan 30</span>
Switch<span class="o">(</span>config-vlan<span class="o">)</span><span class="c"># name GUEST</span>

<span class="c"># VLAN ì •ë³´ í™•ì¸</span>
Switch# show vlan brief
VLAN Name                             Status    Ports
<span class="nt">----</span> <span class="nt">--------------------------------</span> <span class="nt">---------</span> <span class="nt">-------------------------------</span>
1    default                          active    Fa0/5, Fa0/6, Fa0/7, Fa0/8
10   SALES                           active    Fa0/1, Fa0/2
20   ENGINEERING                     active    Fa0/3, Fa0/4  
30   GUEST                           active    
999  UNUSED                          active    

<span class="c"># ë™ì  VLAN í• ë‹¹ (VMPS)</span>
Switch<span class="o">(</span>config<span class="o">)</span><span class="c"># vmps server 192.168.1.100</span>
Switch<span class="o">(</span>config<span class="o">)</span><span class="c"># interface range fastethernet 0/1-20</span>
Switch<span class="o">(</span>config-if-range<span class="o">)</span><span class="c"># switchport mode dynamic desirable</span>
</code></pre></div></div>

<h4 id="inter-vlan-ë¼ìš°íŒ…">Inter-VLAN ë¼ìš°íŒ…</h4>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># ë¼ìš°í„°ì˜ ì„œë¸Œì¸í„°í˜ì´ìŠ¤ ì„¤ì • (Router-on-a-Stick)</span>
Router<span class="o">(</span>config<span class="o">)</span><span class="c"># interface fastethernet 0/0</span>
Router<span class="o">(</span>config-if<span class="o">)</span><span class="c"># no shutdown</span>
Router<span class="o">(</span>config-if<span class="o">)</span><span class="c"># interface fastethernet 0/0.10</span>
Router<span class="o">(</span>config-subif<span class="o">)</span><span class="c"># encapsulation dot1Q 10</span>
Router<span class="o">(</span>config-subif<span class="o">)</span><span class="c"># ip address 192.168.10.1 255.255.255.0</span>
Router<span class="o">(</span>config-subif<span class="o">)</span><span class="c"># interface fastethernet 0/0.20</span>
Router<span class="o">(</span>config-subif<span class="o">)</span><span class="c"># encapsulation dot1Q 20  </span>
Router<span class="o">(</span>config-subif<span class="o">)</span><span class="c"># ip address 192.168.20.1 255.255.255.0</span>

<span class="c"># SVI (Switched Virtual Interface) ì„¤ì •</span>
Switch<span class="o">(</span>config<span class="o">)</span><span class="c"># ip routing</span>
Switch<span class="o">(</span>config<span class="o">)</span><span class="c"># interface vlan 10</span>
Switch<span class="o">(</span>config-if<span class="o">)</span><span class="c"># ip address 192.168.10.1 255.255.255.0</span>
Switch<span class="o">(</span>config-if<span class="o">)</span><span class="c"># no shutdown</span>
Switch<span class="o">(</span>config-if<span class="o">)</span><span class="c"># interface vlan 20</span>
Switch<span class="o">(</span>config-if<span class="o">)</span><span class="c"># ip address 192.168.20.1 255.255.255.0</span>
Switch<span class="o">(</span>config-if<span class="o">)</span><span class="c"># no shutdown</span>
</code></pre></div></div>

<h3 id="-stp-spanning-tree-protocol">ğŸŒ³ STP (Spanning Tree Protocol)</h3>

<p>STPëŠ” ìŠ¤ìœ„ì¹˜ ë„¤íŠ¸ì›Œí¬ì—ì„œ ë£¨í”„ë¥¼ ë°©ì§€í•˜ê³  ì´ì¤‘í™”ë¥¼ ì œê³µí•˜ëŠ” í”„ë¡œí† ì½œì…ë‹ˆë‹¤.</p>

<h4 id="stp-ê¸°ë³¸-ê°œë…">STP ê¸°ë³¸ ê°œë…</h4>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># STP í¬íŠ¸ ìƒíƒœ</span>
Disabled: í¬íŠ¸ ë¹„í™œì„±í™”
Blocking: ë°ì´í„° ì „ì†¡ ì°¨ë‹¨, BPDU ìˆ˜ì‹ ë§Œ
Listening: BPDU ì†¡ìˆ˜ì‹ , MAC ì£¼ì†Œ í•™ìŠµí•˜ì§€ ì•ŠìŒ
Learning: MAC ì£¼ì†Œ í•™ìŠµ, ë°ì´í„° ì „ì†¡í•˜ì§€ ì•ŠìŒ  
Forwarding: ì •ìƒ ë°ì´í„° ì „ì†¡

<span class="c"># STP í¬íŠ¸ ì—­í• </span>
Root Port: ë£¨íŠ¸ ë¸Œë¦¬ì§€ë¡œ ê°€ëŠ” ìµœë‹¨ ê²½ë¡œ
Designated Port: ì„¸ê·¸ë¨¼íŠ¸ì˜ ëŒ€í‘œ í¬íŠ¸
Alternate Port: ë£¨íŠ¸ í¬íŠ¸ì˜ ë°±ì—…
Backup Port: ê°™ì€ ìŠ¤ìœ„ì¹˜ì˜ ë‹¤ë¥¸ í¬íŠ¸ ë°±ì—…
</code></pre></div></div>

<h4 id="stp-ì„¤ì •-ë°-ìµœì í™”">STP ì„¤ì • ë° ìµœì í™”</h4>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># ë£¨íŠ¸ ë¸Œë¦¬ì§€ ì„¤ì •</span>
Switch<span class="o">(</span>config<span class="o">)</span><span class="c"># spanning-tree vlan 1 root primary</span>
Switch<span class="o">(</span>config<span class="o">)</span><span class="c"># spanning-tree vlan 1 priority 4096</span>

<span class="c"># í¬íŠ¸ ìš°ì„ ìˆœìœ„ ë° ë¹„ìš© ì„¤ì •</span>
Switch<span class="o">(</span>config<span class="o">)</span><span class="c"># interface fastethernet 0/1  </span>
Switch<span class="o">(</span>config-if<span class="o">)</span><span class="c"># spanning-tree vlan 1 port-priority 128</span>
Switch<span class="o">(</span>config-if<span class="o">)</span><span class="c"># spanning-tree vlan 1 cost 19</span>

<span class="c"># RSTP (Rapid Spanning Tree) ì„¤ì •</span>
Switch<span class="o">(</span>config<span class="o">)</span><span class="c"># spanning-tree mode rapid-pvst</span>

<span class="c"># í¬íŠ¸ ìµœì í™”</span>
Switch<span class="o">(</span>config<span class="o">)</span><span class="c"># interface range fastethernet 0/1-20</span>
Switch<span class="o">(</span>config-if-range<span class="o">)</span><span class="c"># spanning-tree portfast</span>
Switch<span class="o">(</span>config-if-range<span class="o">)</span><span class="c"># spanning-tree bpduguard enable</span>

<span class="c"># STP ì •ë³´ í™•ì¸</span>
Switch# show spanning-tree
Switch# show spanning-tree vlan 1
Switch# show spanning-tree interface fastethernet 0/1
</code></pre></div></div>

<h4 id="mst-multiple-spanning-tree">MST (Multiple Spanning Tree)</h4>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># MST ì„¤ì •</span>
Switch<span class="o">(</span>config<span class="o">)</span><span class="c"># spanning-tree mode mst</span>
Switch<span class="o">(</span>config<span class="o">)</span><span class="c"># spanning-tree mst configuration</span>
Switch<span class="o">(</span>config-mst<span class="o">)</span><span class="c"># name COMPANY  </span>
Switch<span class="o">(</span>config-mst<span class="o">)</span><span class="c"># revision 1</span>
Switch<span class="o">(</span>config-mst<span class="o">)</span><span class="c"># instance 1 vlan 10,20</span>
Switch<span class="o">(</span>config-mst<span class="o">)</span><span class="c"># instance 2 vlan 30,40</span>
Switch<span class="o">(</span>config-mst<span class="o">)</span><span class="c"># exit</span>

<span class="c"># MST ë£¨íŠ¸ ì„¤ì •</span>
Switch<span class="o">(</span>config<span class="o">)</span><span class="c"># spanning-tree mst 1 root primary</span>
Switch<span class="o">(</span>config<span class="o">)</span><span class="c"># spanning-tree mst 2 root secondary</span>
</code></pre></div></div>

<h2 id="ê³ ê¸‰-ë„¤íŠ¸ì›Œí‚¹-ê¸°ìˆ --advanced-networking">ê³ ê¸‰ ë„¤íŠ¸ì›Œí‚¹ ê¸°ìˆ  | Advanced Networking</h2>

<h3 id="-link-aggregation-etherchannel">ğŸ”— Link Aggregation (EtherChannel)</h3>

<p>ì—¬ëŸ¬ ë¬¼ë¦¬ì  ë§í¬ë¥¼ ë…¼ë¦¬ì ìœ¼ë¡œ ë¬¶ì–´ ëŒ€ì—­í­ì„ ì¦ê°€ì‹œí‚¤ê³  ì´ì¤‘í™”ë¥¼ ì œê³µí•©ë‹ˆë‹¤.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># LACP (Link Aggregation Control Protocol) ì„¤ì •</span>
Switch<span class="o">(</span>config<span class="o">)</span><span class="c"># interface range fastethernet 0/1-2</span>
Switch<span class="o">(</span>config-if-range<span class="o">)</span><span class="c"># channel-group 1 mode active</span>
Switch<span class="o">(</span>config-if-range<span class="o">)</span><span class="c"># exit</span>
Switch<span class="o">(</span>config<span class="o">)</span><span class="c"># interface port-channel 1</span>
Switch<span class="o">(</span>config-if<span class="o">)</span><span class="c"># switchport mode trunk</span>
Switch<span class="o">(</span>config-if<span class="o">)</span><span class="c"># switchport trunk allowed vlan 10,20,30</span>

<span class="c"># PAgP (Port Aggregation Protocol) ì„¤ì •  </span>
Switch<span class="o">(</span>config<span class="o">)</span><span class="c"># interface range fastethernet 0/3-4</span>
Switch<span class="o">(</span>config-if-range<span class="o">)</span><span class="c"># channel-group 2 mode desirable</span>

<span class="c"># ì •ì  EtherChannel ì„¤ì •</span>
Switch<span class="o">(</span>config<span class="o">)</span><span class="c"># interface range fastethernet 0/5-6  </span>
Switch<span class="o">(</span>config-if-range<span class="o">)</span><span class="c"># channel-group 3 mode on</span>

<span class="c"># EtherChannel í™•ì¸</span>
Switch# show etherchannel summary
Switch# show etherchannel port-channel
</code></pre></div></div>

<h3 id="-vxlan-virtual-extensible-lan">ğŸŒ VXLAN (Virtual Extensible LAN)</h3>

<p>í´ë¼ìš°ë“œ í™˜ê²½ì—ì„œ L2 ì˜¤ë²„ë ˆì´ ë„¤íŠ¸ì›Œí¬ë¥¼ êµ¬í˜„í•˜ëŠ” ê¸°ìˆ ì…ë‹ˆë‹¤.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Linuxì—ì„œ VXLAN ì„¤ì •</span>
<span class="c"># VXLAN ì¸í„°í˜ì´ìŠ¤ ìƒì„±</span>
ip <span class="nb">link </span>add vxlan10 <span class="nb">type </span>vxlan <span class="nb">id </span>10 remote 192.168.1.2 <span class="nb">local </span>192.168.1.1 dev eth0 dstport 4789

<span class="c"># VXLANì„ ë¸Œë¦¬ì§€ì— ì—°ê²°</span>
ip <span class="nb">link </span>add br0 <span class="nb">type </span>bridge
ip <span class="nb">link set </span>vxlan10 master br0
ip <span class="nb">link set </span>eth1 master br0

<span class="c"># ì¸í„°í˜ì´ìŠ¤ í™œì„±í™”</span>
ip <span class="nb">link set </span>vxlan10 up
ip <span class="nb">link set </span>br0 up

<span class="c"># ë©€í‹°ìºìŠ¤íŠ¸ VXLAN</span>
ip <span class="nb">link </span>add vxlan20 <span class="nb">type </span>vxlan <span class="nb">id </span>20 group 239.1.1.1 dev eth0 dstport 4789

<span class="c"># VXLAN ì •ë³´ í™•ì¸</span>
bridge fdb show dev vxlan10
ip <span class="nt">-d</span> <span class="nb">link </span>show vxlan10
</code></pre></div></div>

<h3 id="ï¸-ë¡œë“œ-ë°¸ëŸ°ì‹±">âš–ï¸ ë¡œë“œ ë°¸ëŸ°ì‹±</h3>

<h4 id="haproxy-ì„¤ì •">HAProxy ì„¤ì •</h4>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># HAProxy ì„¤ì • íŒŒì¼ (/etc/haproxy/haproxy.cfg)</span>
global
    daemon
    maxconn 4096
    log 127.0.0.1:514 local0

defaults
    mode http
    <span class="nb">timeout </span>connect 5000ms
    <span class="nb">timeout </span>client 50000ms
    <span class="nb">timeout </span>server 50000ms
    option httplog

frontend web_frontend
    <span class="nb">bind</span> <span class="k">*</span>:80
    <span class="nb">bind</span> <span class="k">*</span>:443 ssl crt /etc/ssl/certs/website.pem
    redirect scheme https <span class="k">if</span> <span class="o">!{</span> ssl_fc <span class="o">}</span>
    default_backend web_servers

backend web_servers
    balance roundrobin
    option httpchk GET /health
    server web1 192.168.1.10:80 check
    server web2 192.168.1.11:80 check
    server web3 192.168.1.12:80 check backup

<span class="c"># í†µê³„ í˜ì´ì§€</span>
listen stats
    <span class="nb">bind</span> <span class="k">*</span>:8080
    stats <span class="nb">enable
    </span>stats uri /stats
    stats refresh 30s
</code></pre></div></div>

<h4 id="nginx-ë¡œë“œ-ë°¸ëŸ°ì‹±">NGINX ë¡œë“œ ë°¸ëŸ°ì‹±</h4>
<div class="language-nginx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># /etc/nginx/nginx.conf</span>
<span class="k">upstream</span> <span class="s">backend</span> <span class="p">{</span>
    <span class="kn">least_conn</span><span class="p">;</span>  <span class="c1"># ë¡œë“œ ë°¸ëŸ°ì‹± ë°©ë²•</span>
    <span class="kn">server</span> <span class="nf">192.168.1.10</span><span class="p">:</span><span class="mi">80</span> <span class="s">max_fails=3</span> <span class="s">fail_timeout=30s</span><span class="p">;</span>
    <span class="kn">server</span> <span class="nf">192.168.1.11</span><span class="p">:</span><span class="mi">80</span> <span class="s">max_fails=3</span> <span class="s">fail_timeout=30s</span><span class="p">;</span>
    <span class="kn">server</span> <span class="nf">192.168.1.12</span><span class="p">:</span><span class="mi">80</span> <span class="s">backup</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">server</span> <span class="p">{</span>
    <span class="kn">listen</span> <span class="mi">80</span><span class="p">;</span>
    <span class="kn">location</span> <span class="n">/</span> <span class="p">{</span>
        <span class="kn">proxy_pass</span> <span class="s">http://backend</span><span class="p">;</span>
        <span class="kn">proxy_set_header</span> <span class="s">Host</span> <span class="nv">$host</span><span class="p">;</span>
        <span class="kn">proxy_set_header</span> <span class="s">X-Real-IP</span> <span class="nv">$remote_addr</span><span class="p">;</span>
        <span class="kn">proxy_set_header</span> <span class="s">X-Forwarded-For</span> <span class="nv">$proxy_add_x_forwarded_for</span><span class="p">;</span>
        
        <span class="c1"># í—¬ìŠ¤ ì²´í¬</span>
        <span class="kn">proxy_connect_timeout</span> <span class="s">1s</span><span class="p">;</span>
        <span class="kn">proxy_send_timeout</span> <span class="s">1s</span><span class="p">;</span>
        <span class="kn">proxy_read_timeout</span> <span class="s">1s</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="-ë„¤íŠ¸ì›Œí¬-ë³´ì•ˆ-ì‹¬í™”">ğŸ” ë„¤íŠ¸ì›Œí¬ ë³´ì•ˆ ì‹¬í™”</h3>

<h4 id="í¬íŠ¸-ë³´ì•ˆ-port-security">í¬íŠ¸ ë³´ì•ˆ (Port Security)</h4>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># MAC ì£¼ì†Œ ê¸°ë°˜ í¬íŠ¸ ë³´ì•ˆ</span>
Switch<span class="o">(</span>config<span class="o">)</span><span class="c"># interface fastethernet 0/1</span>
Switch<span class="o">(</span>config-if<span class="o">)</span><span class="c"># switchport port-security</span>
Switch<span class="o">(</span>config-if<span class="o">)</span><span class="c"># switchport port-security maximum 2</span>
Switch<span class="o">(</span>config-if<span class="o">)</span><span class="c"># switchport port-security mac-address sticky</span>
Switch<span class="o">(</span>config-if<span class="o">)</span><span class="c"># switchport port-security violation restrict</span>

<span class="c"># 802.1X ì¸ì¦ ì„¤ì •</span>
Switch<span class="o">(</span>config<span class="o">)</span><span class="c"># aaa new-model</span>
Switch<span class="o">(</span>config<span class="o">)</span><span class="c"># aaa authentication dot1x default group radius</span>
Switch<span class="o">(</span>config<span class="o">)</span><span class="c"># dot1x system-auth-control</span>
Switch<span class="o">(</span>config<span class="o">)</span><span class="c"># interface fastethernet 0/1</span>
Switch<span class="o">(</span>config-if<span class="o">)</span><span class="c"># authentication port-control auto</span>
Switch<span class="o">(</span>config-if<span class="o">)</span><span class="c"># dot1x pae authenticator</span>
</code></pre></div></div>

<h4 id="acl-access-control-list-ì‹¬í™”">ACL (Access Control List) ì‹¬í™”</h4>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># í™•ì¥ ACL</span>
Router<span class="o">(</span>config<span class="o">)</span><span class="c"># ip access-list extended BLOCK_SOCIAL</span>
Router<span class="o">(</span>config-ext-nacl<span class="o">)</span><span class="c"># deny tcp any host 23.35.67.140 eq 80</span>
Router<span class="o">(</span>config-ext-nacl<span class="o">)</span><span class="c"># deny tcp any host 23.35.67.141 eq 443  </span>
Router<span class="o">(</span>config-ext-nacl<span class="o">)</span><span class="c"># permit ip any any</span>
Router<span class="o">(</span>config-ext-nacl<span class="o">)</span><span class="c"># exit</span>
Router<span class="o">(</span>config<span class="o">)</span><span class="c"># interface fastethernet 0/1</span>
Router<span class="o">(</span>config-if<span class="o">)</span><span class="c"># ip access-group BLOCK_SOCIAL out</span>

<span class="c"># ì‹œê°„ ê¸°ë°˜ ACL</span>
Router<span class="o">(</span>config<span class="o">)</span><span class="c"># time-range WORK_HOURS</span>
Router<span class="o">(</span>config-time-range<span class="o">)</span><span class="c"># periodic weekdays 09:00 to 18:00</span>
Router<span class="o">(</span>config<span class="o">)</span><span class="c"># ip access-list extended TIME_BASED</span>
Router<span class="o">(</span>config-ext-nacl<span class="o">)</span><span class="c"># permit tcp 192.168.1.0 0.0.0.255 any eq 80 time-range WORK_HOURS</span>
Router<span class="o">(</span>config-ext-nacl<span class="o">)</span><span class="c"># deny tcp 192.168.1.0 0.0.0.255 any eq 80</span>

<span class="c"># ë°˜ì‚¬í˜• ACL (Reflexive ACL)</span>
Router<span class="o">(</span>config<span class="o">)</span><span class="c"># ip access-list extended OUTBOUND</span>
Router<span class="o">(</span>config-ext-nacl<span class="o">)</span><span class="c"># permit tcp 192.168.1.0 0.0.0.255 any reflect TCP_TRAFFIC</span>
Router<span class="o">(</span>config-ext-nacl<span class="o">)</span><span class="c"># permit icmp 192.168.1.0 0.0.0.255 any reflect ICMP_TRAFFIC</span>

Router<span class="o">(</span>config<span class="o">)</span><span class="c"># ip access-list extended INBOUND  </span>
Router<span class="o">(</span>config-ext-nacl<span class="o">)</span><span class="c"># evaluate TCP_TRAFFIC</span>
Router<span class="o">(</span>config-ext-nacl<span class="o">)</span><span class="c"># evaluate ICMP_TRAFFIC</span>
Router<span class="o">(</span>config-ext-nacl<span class="o">)</span><span class="c"># deny ip any any</span>
</code></pre></div></div>

<h2 id="ë„¤íŠ¸ì›Œí¬-ëª¨ë‹ˆí„°ë§-ë°-ë¬¸ì œ-í•´ê²°--network-monitoring--troubleshooting">ë„¤íŠ¸ì›Œí¬ ëª¨ë‹ˆí„°ë§ ë° ë¬¸ì œ í•´ê²° | Network Monitoring &amp; Troubleshooting</h2>

<h3 id="-snmp-simple-network-management-protocol">ğŸ“Š SNMP (Simple Network Management Protocol)</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># SNMP v3 ì„¤ì • (Cisco)</span>
Router<span class="o">(</span>config<span class="o">)</span><span class="c"># snmp-server view READONLY iso included</span>
Router<span class="o">(</span>config<span class="o">)</span><span class="c"># snmp-server group ADMIN v3 auth read READONLY  </span>
Router<span class="o">(</span>config<span class="o">)</span><span class="c"># snmp-server user admin ADMIN v3 auth sha password123 priv aes 128 password456</span>
Router<span class="o">(</span>config<span class="o">)</span><span class="c"># snmp-server host 192.168.1.100 version 3 auth admin</span>

<span class="c"># Linux SNMP í´ë¼ì´ì–¸íŠ¸</span>
<span class="c"># OIDë¥¼ ì´ìš©í•œ ì •ë³´ ì¡°íšŒ</span>
snmpwalk <span class="nt">-v3</span> <span class="nt">-u</span> admin <span class="nt">-a</span> SHA <span class="nt">-A</span> password123 <span class="nt">-x</span> AES <span class="nt">-X</span> password456 <span class="nt">-l</span> authPriv 192.168.1.1 1.3.6.1.2.1.1

<span class="c"># ì¸í„°í˜ì´ìŠ¤ í†µê³„ ì¡°íšŒ</span>
snmpwalk <span class="nt">-v3</span> <span class="nt">-u</span> admin <span class="nt">-a</span> SHA <span class="nt">-A</span> password123 <span class="nt">-x</span> AES <span class="nt">-X</span> password456 <span class="nt">-l</span> authPriv 192.168.1.1 1.3.6.1.2.1.2.2.1.10
</code></pre></div></div>

<h3 id="-ë„¤íŠ¸ì›Œí¬-ë¶„ì„-ë„êµ¬">ğŸ” ë„¤íŠ¸ì›Œí¬ ë¶„ì„ ë„êµ¬</h3>

<h4 id="wireshark-ê³ ê¸‰-í•„í„°">Wireshark ê³ ê¸‰ í•„í„°</h4>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># í”„ë¡œí† ì½œë³„ í•„í„°</span>
tcp.port <span class="o">==</span> 80                    <span class="c"># HTTP íŠ¸ë˜í”½</span>
tcp.flags.syn <span class="o">==</span> 1 and tcp.flags.ack <span class="o">==</span> 0  <span class="c"># TCP SYN íŒ¨í‚·</span>
icmp.type <span class="o">==</span> 8                    <span class="c"># ICMP Echo Request</span>
dns.qry.name contains <span class="s2">"google"</span>    <span class="c"># DNS ì¿¼ë¦¬</span>

<span class="c"># ë„¤íŠ¸ì›Œí¬ë³„ í•„í„°</span>
ip.src <span class="o">==</span> 192.168.1.0/24          <span class="c"># ì†ŒìŠ¤ ë„¤íŠ¸ì›Œí¬</span>
ip.dst <span class="o">==</span> 10.0.0.0/8             <span class="c"># ëª©ì ì§€ ë„¤íŠ¸ì›Œí¬</span>
eth.addr <span class="o">==</span> 00:11:22:33:44:55     <span class="c"># MAC ì£¼ì†Œ</span>

<span class="c"># ì„±ëŠ¥ ë¶„ì„</span>
tcp.analysis.retransmission       <span class="c"># TCP ì¬ì „ì†¡</span>
tcp.analysis.duplicate_ack        <span class="c"># ì¤‘ë³µ ACK</span>
tcp.analysis.zero_window          <span class="c"># ì œë¡œ ìœˆë„ìš°</span>
</code></pre></div></div>

<h4 id="ë„¤íŠ¸ì›Œí¬-ì„±ëŠ¥-ì¸¡ì •">ë„¤íŠ¸ì›Œí¬ ì„±ëŠ¥ ì¸¡ì •</h4>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># ëŒ€ì—­í­ ì¸¡ì • (iperf3)</span>
<span class="c"># ì„œë²„ ëª¨ë“œ</span>
iperf3 <span class="nt">-s</span> <span class="nt">-p</span> 5201

<span class="c"># í´ë¼ì´ì–¸íŠ¸ ëª¨ë“œ  </span>
iperf3 <span class="nt">-c</span> 192.168.1.100 <span class="nt">-p</span> 5201 <span class="nt">-t</span> 60 <span class="nt">-P</span> 4

<span class="c"># UDP ì¸¡ì •</span>
iperf3 <span class="nt">-c</span> 192.168.1.100 <span class="nt">-u</span> <span class="nt">-b</span> 100M

<span class="c"># ì§€ì—° ì‹œê°„ ì¸¡ì • (hping3)</span>
hping3 <span class="nt">-S</span> <span class="nt">-p</span> 80 <span class="nt">-c</span> 10 google.com
hping3 <span class="nt">-1</span> <span class="nt">-c</span> 100 <span class="nt">-i</span> u1000 192.168.1.1  <span class="c"># ë§ˆì´í¬ë¡œì´ˆ ê°„ê²©</span>

<span class="c"># MTU ê²½ë¡œ ë°œê²¬</span>
tracepath google.com
ping <span class="nt">-M</span> <span class="k">do</span> <span class="nt">-s</span> 1472 google.com
</code></pre></div></div>

<h2 id="2-3-iac-infrastructure-as-code--ì½”ë“œí˜•-ì¸í”„ë¼">2-3 IaC (Infrastructure as Code) | ì½”ë“œí˜• ì¸í”„ë¼</h2>

<h3 id="2-3-1-iac-ì¢…ë¥˜--types-of-iac">2-3-1 IaC ì¢…ë¥˜ | Types of IaC</h3>

<p>IaCëŠ” ì¸í”„ë¼ë¥¼ ì½”ë“œë¡œ ì •ì˜í•˜ê³  ê´€ë¦¬í•˜ëŠ” ë°©ë²•ë¡ ìœ¼ë¡œ, ë„¤íŠ¸ì›Œí¬ ì¸í”„ë¼ êµ¬ì¶•ê³¼ ê´€ë¦¬ë¥¼ ìë™í™”í•©ë‹ˆë‹¤.</p>

<h4 id="ï¸-ì£¼ìš”-iac-ë„êµ¬-ë¶„ë¥˜">ğŸ› ï¸ ì£¼ìš” IaC ë„êµ¬ ë¶„ë¥˜</h4>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># ì„ ì–¸ì  vs ëª…ë ¹ì </span>
ì„ ì–¸ì  <span class="o">(</span>Declarative<span class="o">)</span>:
- Terraform, CloudFormation, Ansible <span class="o">(</span>ì¼ë¶€<span class="o">)</span>
- ìµœì¢… ìƒíƒœë¥¼ ì •ì˜
- ë” ì•ˆì •ì ì´ê³  ì˜ˆì¸¡ ê°€ëŠ¥

ëª…ë ¹ì  <span class="o">(</span>Imperative<span class="o">)</span>:  
- Shell Scripts, Python Scripts
- ì‹¤í–‰ ë‹¨ê³„ë¥¼ ì •ì˜
- ë” ìœ ì—°í•˜ì§€ë§Œ ë³µì¡í•¨

<span class="c"># ì—ì´ì „íŠ¸ ê¸°ë°˜ vs ì—ì´ì „íŠ¸ë¦¬ìŠ¤</span>
ì—ì´ì „íŠ¸ ê¸°ë°˜:
- Puppet, Chef
- ëŒ€ìƒ ì‹œìŠ¤í…œì— ì—ì´ì „íŠ¸ ì„¤ì¹˜ í•„ìš”
- ì§€ì†ì ì¸ ìƒíƒœ ê´€ë¦¬

ì—ì´ì „íŠ¸ë¦¬ìŠ¤:
- Ansible, Terraform
- SSH/WinRM ë“±ì„ í†µí•œ ì›ê²© ì‹¤í–‰
- ì„¤ì¹˜ ë¶€ë‹´ ì—†ìŒ
</code></pre></div></div>

<h4 id="terraform">Terraform</h4>
<div class="language-hcl highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Provider ì„¤ì •</span>
<span class="nx">terraform</span> <span class="p">{</span>
  <span class="nx">required_version</span> <span class="o">=</span> <span class="s2">"&gt;= 1.0"</span>
  <span class="nx">required_providers</span> <span class="p">{</span>
    <span class="nx">aws</span> <span class="o">=</span> <span class="p">{</span>
      <span class="nx">source</span>  <span class="o">=</span> <span class="s2">"hashicorp/aws"</span>
      <span class="nx">version</span> <span class="o">=</span> <span class="s2">"~&gt; 5.0"</span>
    <span class="p">}</span>
    <span class="nx">cisco</span> <span class="o">=</span> <span class="p">{</span>
      <span class="nx">source</span>  <span class="o">=</span> <span class="s2">"CiscoDevNet/aci"</span>
      <span class="nx">version</span> <span class="o">=</span> <span class="s2">"~&gt; 2.0"</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="c1"># ë³€ìˆ˜ ì •ì˜</span>
<span class="nx">variable</span> <span class="s2">"vpc_cidr"</span> <span class="p">{</span>
  <span class="nx">description</span> <span class="o">=</span> <span class="s2">"CIDR block for VPC"</span>
  <span class="nx">type</span>        <span class="o">=</span> <span class="nx">string</span>
  <span class="nx">default</span>     <span class="o">=</span> <span class="s2">"10.0.0.0/16"</span>
<span class="p">}</span>

<span class="nx">variable</span> <span class="s2">"environment"</span> <span class="p">{</span>
  <span class="nx">description</span> <span class="o">=</span> <span class="s2">"Environment name"</span>
  <span class="nx">type</span>        <span class="o">=</span> <span class="nx">string</span>
  <span class="nx">default</span>     <span class="o">=</span> <span class="s2">"production"</span>
<span class="p">}</span>
</code></pre></div></div>

<h4 id="ansible">Ansible</h4>
<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># ë„¤íŠ¸ì›Œí¬ ì¥ë¹„ ì¸ë²¤í† ë¦¬ (/etc/ansible/hosts)</span>
<span class="pi">[</span><span class="nv">switches</span><span class="pi">]</span>
<span class="s">switch1 ansible_host=192.168.1.10 ansible_network_os=ios</span>
<span class="s">switch2 ansible_host=192.168.1.11 ansible_network_os=ios</span>

<span class="pi">[</span><span class="nv">routers</span><span class="pi">]</span>  
<span class="s">router1 ansible_host=192.168.1.1 ansible_network_os=ios</span>
<span class="s">router2 ansible_host=192.168.1.2 ansible_network_os=ios</span>

<span class="pi">[</span><span class="nv">network</span><span class="pi">:</span><span class="nv">children</span><span class="pi">]</span>
<span class="s">switches</span>
<span class="s">routers</span>

<span class="pi">[</span><span class="nv">network</span><span class="pi">:</span><span class="nv">vars</span><span class="pi">]</span>
<span class="s">ansible_user=admin</span>
<span class="s">ansible_password=password</span>
<span class="s">ansible_connection=network_cli</span>
<span class="s">ansible_become=yes</span>
<span class="s">ansible_become_method=enable</span>
</code></pre></div></div>

<h4 id="cloudformation-aws">CloudFormation (AWS)</h4>
<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># AWS ë„¤íŠ¸ì›Œí¬ ì¸í”„ë¼ í…œí”Œë¦¿</span>
<span class="na">AWSTemplateFormatVersion</span><span class="pi">:</span> <span class="s1">'</span><span class="s">2010-09-09'</span>
<span class="na">Description</span><span class="pi">:</span> <span class="s1">'</span><span class="s">Network</span><span class="nv"> </span><span class="s">Infrastructure</span><span class="nv"> </span><span class="s">Template'</span>

<span class="na">Parameters</span><span class="pi">:</span>
  <span class="na">EnvironmentName</span><span class="pi">:</span>
    <span class="na">Description</span><span class="pi">:</span> <span class="s">Environment name prefix</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s">String</span>
    <span class="na">Default</span><span class="pi">:</span> <span class="s">Production</span>

<span class="na">Resources</span><span class="pi">:</span>
  <span class="na">VPC</span><span class="pi">:</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s">AWS::EC2::VPC</span>
    <span class="na">Properties</span><span class="pi">:</span>
      <span class="na">CidrBlock</span><span class="pi">:</span> <span class="s">10.0.0.0/16</span>
      <span class="na">EnableDnsHostnames</span><span class="pi">:</span> <span class="kc">true</span>
      <span class="na">EnableDnsSupport</span><span class="pi">:</span> <span class="kc">true</span>
      <span class="na">Tags</span><span class="pi">:</span>
        <span class="pi">-</span> <span class="na">Key</span><span class="pi">:</span> <span class="s">Name</span>
          <span class="na">Value</span><span class="pi">:</span> <span class="kt">!Sub</span> <span class="s">${EnvironmentName}-VPC</span>
</code></pre></div></div>

<h4 id="pulumi">Pulumi</h4>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Pythonì„ ì´ìš©í•œ IaC
</span><span class="kn">import</span> <span class="n">pulumi</span>
<span class="kn">import</span> <span class="n">pulumi_aws</span> <span class="k">as</span> <span class="n">aws</span>

<span class="c1"># VPC ìƒì„±
</span><span class="n">vpc</span> <span class="o">=</span> <span class="n">aws</span><span class="p">.</span><span class="n">ec2</span><span class="p">.</span><span class="nc">Vpc</span><span class="p">(</span><span class="sh">"</span><span class="s">main-vpc</span><span class="sh">"</span><span class="p">,</span>
    <span class="n">cidr_block</span><span class="o">=</span><span class="sh">"</span><span class="s">10.0.0.0/16</span><span class="sh">"</span><span class="p">,</span>
    <span class="n">enable_dns_hostnames</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
    <span class="n">enable_dns_support</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
    <span class="n">tags</span><span class="o">=</span><span class="p">{</span>
        <span class="sh">"</span><span class="s">Name</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">main-vpc</span><span class="sh">"</span><span class="p">,</span>
        <span class="sh">"</span><span class="s">Environment</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">production</span><span class="sh">"</span>
    <span class="p">}</span>
<span class="p">)</span>

<span class="c1"># ì„œë¸Œë„· ìƒì„±
</span><span class="n">public_subnet</span> <span class="o">=</span> <span class="n">aws</span><span class="p">.</span><span class="n">ec2</span><span class="p">.</span><span class="nc">Subnet</span><span class="p">(</span><span class="sh">"</span><span class="s">public-subnet</span><span class="sh">"</span><span class="p">,</span>
    <span class="n">vpc_id</span><span class="o">=</span><span class="n">vpc</span><span class="p">.</span><span class="nb">id</span><span class="p">,</span>
    <span class="n">cidr_block</span><span class="o">=</span><span class="sh">"</span><span class="s">10.0.1.0/24</span><span class="sh">"</span><span class="p">,</span>
    <span class="n">availability_zone</span><span class="o">=</span><span class="sh">"</span><span class="s">us-west-2a</span><span class="sh">"</span><span class="p">,</span>
    <span class="n">map_public_ip_on_launch</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
    <span class="n">tags</span><span class="o">=</span><span class="p">{</span>
        <span class="sh">"</span><span class="s">Name</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">public-subnet</span><span class="sh">"</span><span class="p">,</span>
        <span class="sh">"</span><span class="s">Type</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">Public</span><span class="sh">"</span>
    <span class="p">}</span>
<span class="p">)</span>
</code></pre></div></div>

<h4 id="cdk-cloud-development-kit">CDK (Cloud Development Kit)</h4>
<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// TypeScriptë¥¼ ì´ìš©í•œ AWS CDK</span>
<span class="k">import</span> <span class="o">*</span> <span class="kd">as </span><span class="nx">cdk</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">aws-cdk-lib</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="o">*</span> <span class="kd">as </span><span class="nx">ec2</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">aws-cdk-lib/aws-ec2</span><span class="dl">'</span><span class="p">;</span>

<span class="k">export</span> <span class="kd">class</span> <span class="nc">NetworkStack</span> <span class="kd">extends</span> <span class="nc">cdk</span><span class="p">.</span><span class="nx">Stack</span> <span class="p">{</span>
  <span class="nf">constructor</span><span class="p">(</span><span class="nx">scope</span><span class="p">:</span> <span class="nx">cdk</span><span class="p">.</span><span class="nx">App</span><span class="p">,</span> <span class="nx">id</span><span class="p">:</span> <span class="kr">string</span><span class="p">,</span> <span class="nx">props</span><span class="p">?:</span> <span class="nx">cdk</span><span class="p">.</span><span class="nx">StackProps</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">super</span><span class="p">(</span><span class="nx">scope</span><span class="p">,</span> <span class="nx">id</span><span class="p">,</span> <span class="nx">props</span><span class="p">);</span>

    <span class="c1">// VPC ìƒì„±</span>
    <span class="kd">const</span> <span class="nx">vpc</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ec2</span><span class="p">.</span><span class="nc">Vpc</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="dl">'</span><span class="s1">MainVpc</span><span class="dl">'</span><span class="p">,</span> <span class="p">{</span>
      <span class="na">maxAzs</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
      <span class="na">cidr</span><span class="p">:</span> <span class="dl">'</span><span class="s1">10.0.0.0/16</span><span class="dl">'</span><span class="p">,</span>
      <span class="na">subnetConfiguration</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
          <span class="na">cidrMask</span><span class="p">:</span> <span class="mi">24</span><span class="p">,</span>
          <span class="na">name</span><span class="p">:</span> <span class="dl">'</span><span class="s1">Public</span><span class="dl">'</span><span class="p">,</span>
          <span class="na">subnetType</span><span class="p">:</span> <span class="nx">ec2</span><span class="p">.</span><span class="nx">SubnetType</span><span class="p">.</span><span class="nx">PUBLIC</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="p">{</span>
          <span class="na">cidrMask</span><span class="p">:</span> <span class="mi">24</span><span class="p">,</span>
          <span class="na">name</span><span class="p">:</span> <span class="dl">'</span><span class="s1">Private</span><span class="dl">'</span><span class="p">,</span>
          <span class="na">subnetType</span><span class="p">:</span> <span class="nx">ec2</span><span class="p">.</span><span class="nx">SubnetType</span><span class="p">.</span><span class="nx">PRIVATE_WITH_EGRESS</span><span class="p">,</span>
        <span class="p">}</span>
      <span class="p">]</span>
    <span class="p">});</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="2-3-2-í…Œë¼í¼ìœ¼ë¡œ-í™˜ê²½-êµ¬ì„±--environment-setup-with-terraform">2-3-2 í…Œë¼í¼ìœ¼ë¡œ í™˜ê²½ êµ¬ì„± | Environment Setup with Terraform</h3>

<p>Terraformì„ ì‚¬ìš©í•˜ì—¬ ì™„ì „í•œ ë„¤íŠ¸ì›Œí¬ í™˜ê²½ì„ êµ¬ì„±í•´ë³´ê² ìŠµë‹ˆë‹¤.</p>

<h4 id="ï¸-í”„ë¡œì íŠ¸-êµ¬ì¡°-ì„¤ê³„">ğŸ—ï¸ í”„ë¡œì íŠ¸ êµ¬ì¡° ì„¤ê³„</h4>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># ë””ë ‰í† ë¦¬ êµ¬ì¡°</span>
terraform-network/
â”œâ”€â”€ environments/
â”‚   â”œâ”€â”€ dev/
â”‚   â”‚   â”œâ”€â”€ main.tf
â”‚   â”‚   â”œâ”€â”€ variables.tf
â”‚   â”‚   â””â”€â”€ terraform.tfvars
â”‚   â”œâ”€â”€ staging/
â”‚   â””â”€â”€ production/
â”œâ”€â”€ modules/
â”‚   â”œâ”€â”€ vpc/
â”‚   â”‚   â”œâ”€â”€ main.tf
â”‚   â”‚   â”œâ”€â”€ variables.tf
â”‚   â”‚   â””â”€â”€ outputs.tf
â”‚   â”œâ”€â”€ security-groups/
â”‚   â””â”€â”€ load-balancer/
â”œâ”€â”€ global/
â”‚   â””â”€â”€ iam/
â””â”€â”€ shared/
    â””â”€â”€ data.tf
</code></pre></div></div>

<h4 id="vpc-ëª¨ë“ˆ-êµ¬í˜„">VPC ëª¨ë“ˆ êµ¬í˜„</h4>
<div class="language-hcl highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># modules/vpc/main.tf</span>
<span class="nx">resource</span> <span class="s2">"aws_vpc"</span> <span class="s2">"main"</span> <span class="p">{</span>
  <span class="nx">cidr_block</span>           <span class="o">=</span> <span class="nx">var</span><span class="p">.</span><span class="nx">cidr_block</span>
  <span class="nx">enable_dns_hostnames</span> <span class="o">=</span> <span class="nx">var</span><span class="p">.</span><span class="nx">enable_dns_hostnames</span>
  <span class="nx">enable_dns_support</span>   <span class="o">=</span> <span class="nx">var</span><span class="p">.</span><span class="nx">enable_dns_support</span>

  <span class="nx">tags</span> <span class="o">=</span> <span class="nx">merge</span><span class="p">(</span><span class="nx">var</span><span class="p">.</span><span class="nx">tags</span><span class="p">,</span> <span class="p">{</span>
    <span class="nx">Name</span> <span class="o">=</span> <span class="s2">"${var.name_prefix}-vpc"</span>
  <span class="p">})</span>
<span class="p">}</span>

<span class="c1"># ì¸í„°ë„· ê²Œì´íŠ¸ì›¨ì´</span>
<span class="nx">resource</span> <span class="s2">"aws_internet_gateway"</span> <span class="s2">"main"</span> <span class="p">{</span>
  <span class="nx">vpc_id</span> <span class="o">=</span> <span class="nx">aws_vpc</span><span class="p">.</span><span class="nx">main</span><span class="p">.</span><span class="nx">id</span>

  <span class="nx">tags</span> <span class="o">=</span> <span class="nx">merge</span><span class="p">(</span><span class="nx">var</span><span class="p">.</span><span class="nx">tags</span><span class="p">,</span> <span class="p">{</span>
    <span class="nx">Name</span> <span class="o">=</span> <span class="s2">"${var.name_prefix}-igw"</span>
  <span class="p">})</span>
<span class="p">}</span>

<span class="c1"># ê°€ìš© ì˜ì—­ë³„ í¼ë¸”ë¦­ ì„œë¸Œë„·</span>
<span class="nx">resource</span> <span class="s2">"aws_subnet"</span> <span class="s2">"public"</span> <span class="p">{</span>
  <span class="nx">count</span> <span class="o">=</span> <span class="nx">length</span><span class="p">(</span><span class="nx">var</span><span class="p">.</span><span class="nx">public_subnets</span><span class="p">)</span>

  <span class="nx">vpc_id</span>                  <span class="o">=</span> <span class="nx">aws_vpc</span><span class="p">.</span><span class="nx">main</span><span class="p">.</span><span class="nx">id</span>
  <span class="nx">cidr_block</span>              <span class="o">=</span> <span class="nx">var</span><span class="p">.</span><span class="nx">public_subnets</span><span class="p">[</span><span class="nx">count</span><span class="p">.</span><span class="nx">index</span><span class="p">]</span>
  <span class="nx">availability_zone</span>       <span class="o">=</span> <span class="nx">var</span><span class="p">.</span><span class="nx">availability_zones</span><span class="p">[</span><span class="nx">count</span><span class="p">.</span><span class="nx">index</span><span class="p">]</span>
  <span class="nx">map_public_ip_on_launch</span> <span class="o">=</span> <span class="kc">true</span>

  <span class="nx">tags</span> <span class="o">=</span> <span class="nx">merge</span><span class="p">(</span><span class="nx">var</span><span class="p">.</span><span class="nx">tags</span><span class="p">,</span> <span class="p">{</span>
    <span class="nx">Name</span> <span class="o">=</span> <span class="s2">"${var.name_prefix}-public-${count.index + 1}"</span>
    <span class="nx">Type</span> <span class="o">=</span> <span class="s2">"Public"</span>
  <span class="p">})</span>
<span class="p">}</span>

<span class="c1"># í”„ë¼ì´ë¹— ì„œë¸Œë„·</span>
<span class="nx">resource</span> <span class="s2">"aws_subnet"</span> <span class="s2">"private"</span> <span class="p">{</span>
  <span class="nx">count</span> <span class="o">=</span> <span class="nx">length</span><span class="p">(</span><span class="nx">var</span><span class="p">.</span><span class="nx">private_subnets</span><span class="p">)</span>

  <span class="nx">vpc_id</span>            <span class="o">=</span> <span class="nx">aws_vpc</span><span class="p">.</span><span class="nx">main</span><span class="p">.</span><span class="nx">id</span>
  <span class="nx">cidr_block</span>        <span class="o">=</span> <span class="nx">var</span><span class="p">.</span><span class="nx">private_subnets</span><span class="p">[</span><span class="nx">count</span><span class="p">.</span><span class="nx">index</span><span class="p">]</span>
  <span class="nx">availability_zone</span> <span class="o">=</span> <span class="nx">var</span><span class="p">.</span><span class="nx">availability_zones</span><span class="p">[</span><span class="nx">count</span><span class="p">.</span><span class="nx">index</span><span class="p">]</span>

  <span class="nx">tags</span> <span class="o">=</span> <span class="nx">merge</span><span class="p">(</span><span class="nx">var</span><span class="p">.</span><span class="nx">tags</span><span class="p">,</span> <span class="p">{</span>
    <span class="nx">Name</span> <span class="o">=</span> <span class="s2">"${var.name_prefix}-private-${count.index + 1}"</span>
    <span class="nx">Type</span> <span class="o">=</span> <span class="s2">"Private"</span>
  <span class="p">})</span>
<span class="p">}</span>

<span class="c1"># NAT ê²Œì´íŠ¸ì›¨ì´ë¥¼ ìœ„í•œ EIP</span>
<span class="nx">resource</span> <span class="s2">"aws_eip"</span> <span class="s2">"nat"</span> <span class="p">{</span>
  <span class="nx">count</span> <span class="o">=</span> <span class="nx">var</span><span class="p">.</span><span class="nx">enable_nat_gateway</span> <span class="o">?</span> <span class="nx">length</span><span class="p">(</span><span class="nx">var</span><span class="p">.</span><span class="nx">public_subnets</span><span class="p">)</span> <span class="o">:</span> <span class="mi">0</span>

  <span class="nx">domain</span> <span class="o">=</span> <span class="s2">"vpc"</span>
  <span class="nx">depends_on</span> <span class="o">=</span> <span class="p">[</span><span class="nx">aws_internet_gateway</span><span class="p">.</span><span class="nx">main</span><span class="p">]</span>

  <span class="nx">tags</span> <span class="o">=</span> <span class="nx">merge</span><span class="p">(</span><span class="nx">var</span><span class="p">.</span><span class="nx">tags</span><span class="p">,</span> <span class="p">{</span>
    <span class="nx">Name</span> <span class="o">=</span> <span class="s2">"${var.name_prefix}-nat-eip-${count.index + 1}"</span>
  <span class="p">})</span>
<span class="p">}</span>

<span class="c1"># NAT ê²Œì´íŠ¸ì›¨ì´</span>
<span class="nx">resource</span> <span class="s2">"aws_nat_gateway"</span> <span class="s2">"main"</span> <span class="p">{</span>
  <span class="nx">count</span> <span class="o">=</span> <span class="nx">var</span><span class="p">.</span><span class="nx">enable_nat_gateway</span> <span class="o">?</span> <span class="nx">length</span><span class="p">(</span><span class="nx">var</span><span class="p">.</span><span class="nx">public_subnets</span><span class="p">)</span> <span class="o">:</span> <span class="mi">0</span>

  <span class="nx">allocation_id</span> <span class="o">=</span> <span class="nx">aws_eip</span><span class="p">.</span><span class="nx">nat</span><span class="p">[</span><span class="nx">count</span><span class="p">.</span><span class="nx">index</span><span class="p">].</span><span class="nx">id</span>
  <span class="nx">subnet_id</span>     <span class="o">=</span> <span class="nx">aws_subnet</span><span class="p">.</span><span class="nx">public</span><span class="p">[</span><span class="nx">count</span><span class="p">.</span><span class="nx">index</span><span class="p">].</span><span class="nx">id</span>

  <span class="nx">tags</span> <span class="o">=</span> <span class="nx">merge</span><span class="p">(</span><span class="nx">var</span><span class="p">.</span><span class="nx">tags</span><span class="p">,</span> <span class="p">{</span>
    <span class="nx">Name</span> <span class="o">=</span> <span class="s2">"${var.name_prefix}-nat-gw-${count.index + 1}"</span>
  <span class="p">})</span>

  <span class="nx">depends_on</span> <span class="o">=</span> <span class="p">[</span><span class="nx">aws_internet_gateway</span><span class="p">.</span><span class="nx">main</span><span class="p">]</span>
<span class="p">}</span>

<span class="c1"># í¼ë¸”ë¦­ ë¼ìš°íŠ¸ í…Œì´ë¸”</span>
<span class="nx">resource</span> <span class="s2">"aws_route_table"</span> <span class="s2">"public"</span> <span class="p">{</span>
  <span class="nx">vpc_id</span> <span class="o">=</span> <span class="nx">aws_vpc</span><span class="p">.</span><span class="nx">main</span><span class="p">.</span><span class="nx">id</span>

  <span class="nx">route</span> <span class="p">{</span>
    <span class="nx">cidr_block</span> <span class="o">=</span> <span class="s2">"0.0.0.0/0"</span>
    <span class="nx">gateway_id</span> <span class="o">=</span> <span class="nx">aws_internet_gateway</span><span class="p">.</span><span class="nx">main</span><span class="p">.</span><span class="nx">id</span>
  <span class="p">}</span>

  <span class="nx">tags</span> <span class="o">=</span> <span class="nx">merge</span><span class="p">(</span><span class="nx">var</span><span class="p">.</span><span class="nx">tags</span><span class="p">,</span> <span class="p">{</span>
    <span class="nx">Name</span> <span class="o">=</span> <span class="s2">"${var.name_prefix}-public-rt"</span>
  <span class="p">})</span>
<span class="p">}</span>

<span class="c1"># í”„ë¼ì´ë¹— ë¼ìš°íŠ¸ í…Œì´ë¸”</span>
<span class="nx">resource</span> <span class="s2">"aws_route_table"</span> <span class="s2">"private"</span> <span class="p">{</span>
  <span class="nx">count</span> <span class="o">=</span> <span class="nx">var</span><span class="p">.</span><span class="nx">enable_nat_gateway</span> <span class="o">?</span> <span class="nx">length</span><span class="p">(</span><span class="nx">var</span><span class="p">.</span><span class="nx">private_subnets</span><span class="p">)</span> <span class="o">:</span> <span class="mi">1</span>

  <span class="nx">vpc_id</span> <span class="o">=</span> <span class="nx">aws_vpc</span><span class="p">.</span><span class="nx">main</span><span class="p">.</span><span class="nx">id</span>

  <span class="nx">dynamic</span> <span class="s2">"route"</span> <span class="p">{</span>
    <span class="nx">for_each</span> <span class="o">=</span> <span class="nx">var</span><span class="p">.</span><span class="nx">enable_nat_gateway</span> <span class="o">?</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">:</span> <span class="p">[]</span>
    <span class="nx">content</span> <span class="p">{</span>
      <span class="nx">cidr_block</span>     <span class="o">=</span> <span class="s2">"0.0.0.0/0"</span>
      <span class="nx">nat_gateway_id</span> <span class="o">=</span> <span class="nx">aws_nat_gateway</span><span class="p">.</span><span class="nx">main</span><span class="p">[</span><span class="nx">count</span><span class="p">.</span><span class="nx">index</span><span class="p">].</span><span class="nx">id</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="nx">tags</span> <span class="o">=</span> <span class="nx">merge</span><span class="p">(</span><span class="nx">var</span><span class="p">.</span><span class="nx">tags</span><span class="p">,</span> <span class="p">{</span>
    <span class="nx">Name</span> <span class="o">=</span> <span class="s2">"${var.name_prefix}-private-rt-${count.index + 1}"</span>
  <span class="p">})</span>
<span class="p">}</span>

<span class="c1"># ë¼ìš°íŠ¸ í…Œì´ë¸” ì—°ê²°</span>
<span class="nx">resource</span> <span class="s2">"aws_route_table_association"</span> <span class="s2">"public"</span> <span class="p">{</span>
  <span class="nx">count</span> <span class="o">=</span> <span class="nx">length</span><span class="p">(</span><span class="nx">var</span><span class="p">.</span><span class="nx">public_subnets</span><span class="p">)</span>

  <span class="nx">subnet_id</span>      <span class="o">=</span> <span class="nx">aws_subnet</span><span class="p">.</span><span class="nx">public</span><span class="p">[</span><span class="nx">count</span><span class="p">.</span><span class="nx">index</span><span class="p">].</span><span class="nx">id</span>
  <span class="nx">route_table_id</span> <span class="o">=</span> <span class="nx">aws_route_table</span><span class="p">.</span><span class="nx">public</span><span class="p">.</span><span class="nx">id</span>
<span class="p">}</span>

<span class="nx">resource</span> <span class="s2">"aws_route_table_association"</span> <span class="s2">"private"</span> <span class="p">{</span>
  <span class="nx">count</span> <span class="o">=</span> <span class="nx">length</span><span class="p">(</span><span class="nx">var</span><span class="p">.</span><span class="nx">private_subnets</span><span class="p">)</span>

  <span class="nx">subnet_id</span>      <span class="o">=</span> <span class="nx">aws_subnet</span><span class="p">.</span><span class="nx">private</span><span class="p">[</span><span class="nx">count</span><span class="p">.</span><span class="nx">index</span><span class="p">].</span><span class="nx">id</span>
  <span class="nx">route_table_id</span> <span class="o">=</span> <span class="nx">var</span><span class="p">.</span><span class="nx">enable_nat_gateway</span> <span class="o">?</span> <span class="nx">aws_route_table</span><span class="p">.</span><span class="nx">private</span><span class="p">[</span><span class="nx">count</span><span class="p">.</span><span class="nx">index</span><span class="p">].</span><span class="nx">id</span> <span class="o">:</span> <span class="nx">aws_route_table</span><span class="p">.</span><span class="nx">private</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">id</span>
<span class="p">}</span>
</code></pre></div></div>

<h4 id="vpc-ëª¨ë“ˆ-ë³€ìˆ˜">VPC ëª¨ë“ˆ ë³€ìˆ˜</h4>
<div class="language-hcl highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># modules/vpc/variables.tf</span>
<span class="nx">variable</span> <span class="s2">"name_prefix"</span> <span class="p">{</span>
  <span class="nx">description</span> <span class="o">=</span> <span class="s2">"Name prefix for all resources"</span>
  <span class="nx">type</span>        <span class="o">=</span> <span class="nx">string</span>
<span class="p">}</span>

<span class="nx">variable</span> <span class="s2">"cidr_block"</span> <span class="p">{</span>
  <span class="nx">description</span> <span class="o">=</span> <span class="s2">"CIDR block for the VPC"</span>
  <span class="nx">type</span>        <span class="o">=</span> <span class="nx">string</span>
<span class="p">}</span>

<span class="nx">variable</span> <span class="s2">"public_subnets"</span> <span class="p">{</span>
  <span class="nx">description</span> <span class="o">=</span> <span class="s2">"List of public subnet CIDR blocks"</span>
  <span class="nx">type</span>        <span class="o">=</span> <span class="nx">list</span><span class="p">(</span><span class="nx">string</span><span class="p">)</span>
<span class="p">}</span>

<span class="nx">variable</span> <span class="s2">"private_subnets"</span> <span class="p">{</span>
  <span class="nx">description</span> <span class="o">=</span> <span class="s2">"List of private subnet CIDR blocks"</span>
  <span class="nx">type</span>        <span class="o">=</span> <span class="nx">list</span><span class="p">(</span><span class="nx">string</span><span class="p">)</span>
<span class="p">}</span>

<span class="nx">variable</span> <span class="s2">"availability_zones"</span> <span class="p">{</span>
  <span class="nx">description</span> <span class="o">=</span> <span class="s2">"List of availability zones"</span>
  <span class="nx">type</span>        <span class="o">=</span> <span class="nx">list</span><span class="p">(</span><span class="nx">string</span><span class="p">)</span>
<span class="p">}</span>

<span class="nx">variable</span> <span class="s2">"enable_nat_gateway"</span> <span class="p">{</span>
  <span class="nx">description</span> <span class="o">=</span> <span class="s2">"Enable NAT Gateway for private subnets"</span>
  <span class="nx">type</span>        <span class="o">=</span> <span class="nx">bool</span>
  <span class="nx">default</span>     <span class="o">=</span> <span class="kc">true</span>
<span class="p">}</span>

<span class="nx">variable</span> <span class="s2">"enable_dns_hostnames"</span> <span class="p">{</span>
  <span class="nx">description</span> <span class="o">=</span> <span class="s2">"Enable DNS hostnames in the VPC"</span>
  <span class="nx">type</span>        <span class="o">=</span> <span class="nx">bool</span>
  <span class="nx">default</span>     <span class="o">=</span> <span class="kc">true</span>
<span class="p">}</span>

<span class="nx">variable</span> <span class="s2">"enable_dns_support"</span> <span class="p">{</span>
  <span class="nx">description</span> <span class="o">=</span> <span class="s2">"Enable DNS support in the VPC"</span>
  <span class="nx">type</span>        <span class="o">=</span> <span class="nx">bool</span>
  <span class="nx">default</span>     <span class="o">=</span> <span class="kc">true</span>
<span class="p">}</span>

<span class="nx">variable</span> <span class="s2">"tags"</span> <span class="p">{</span>
  <span class="nx">description</span> <span class="o">=</span> <span class="s2">"Tags to apply to all resources"</span>
  <span class="nx">type</span>        <span class="o">=</span> <span class="nx">map</span><span class="p">(</span><span class="nx">string</span><span class="p">)</span>
  <span class="nx">default</span>     <span class="o">=</span> <span class="p">{}</span>
<span class="p">}</span>
</code></pre></div></div>

<h4 id="vpc-ëª¨ë“ˆ-ì¶œë ¥">VPC ëª¨ë“ˆ ì¶œë ¥</h4>
<div class="language-hcl highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># modules/vpc/outputs.tf</span>
<span class="nx">output</span> <span class="s2">"vpc_id"</span> <span class="p">{</span>
  <span class="nx">description</span> <span class="o">=</span> <span class="s2">"ID of the VPC"</span>
  <span class="nx">value</span>       <span class="o">=</span> <span class="nx">aws_vpc</span><span class="p">.</span><span class="nx">main</span><span class="p">.</span><span class="nx">id</span>
<span class="p">}</span>

<span class="nx">output</span> <span class="s2">"vpc_cidr_block"</span> <span class="p">{</span>
  <span class="nx">description</span> <span class="o">=</span> <span class="s2">"CIDR block of the VPC"</span>
  <span class="nx">value</span>       <span class="o">=</span> <span class="nx">aws_vpc</span><span class="p">.</span><span class="nx">main</span><span class="p">.</span><span class="nx">cidr_block</span>
<span class="p">}</span>

<span class="nx">output</span> <span class="s2">"public_subnet_ids"</span> <span class="p">{</span>
  <span class="nx">description</span> <span class="o">=</span> <span class="s2">"IDs of the public subnets"</span>
  <span class="nx">value</span>       <span class="o">=</span> <span class="nx">aws_subnet</span><span class="p">.</span><span class="nx">public</span><span class="p">[*].</span><span class="nx">id</span>
<span class="p">}</span>

<span class="nx">output</span> <span class="s2">"private_subnet_ids"</span> <span class="p">{</span>
  <span class="nx">description</span> <span class="o">=</span> <span class="s2">"IDs of the private subnets"</span>
  <span class="nx">value</span>       <span class="o">=</span> <span class="nx">aws_subnet</span><span class="p">.</span><span class="nx">private</span><span class="p">[*].</span><span class="nx">id</span>
<span class="p">}</span>

<span class="nx">output</span> <span class="s2">"internet_gateway_id"</span> <span class="p">{</span>
  <span class="nx">description</span> <span class="o">=</span> <span class="s2">"ID of the Internet Gateway"</span>
  <span class="nx">value</span>       <span class="o">=</span> <span class="nx">aws_internet_gateway</span><span class="p">.</span><span class="nx">main</span><span class="p">.</span><span class="nx">id</span>
<span class="p">}</span>

<span class="nx">output</span> <span class="s2">"nat_gateway_ids"</span> <span class="p">{</span>
  <span class="nx">description</span> <span class="o">=</span> <span class="s2">"IDs of the NAT Gateways"</span>
  <span class="nx">value</span>       <span class="o">=</span> <span class="nx">aws_nat_gateway</span><span class="p">.</span><span class="nx">main</span><span class="p">[*].</span><span class="nx">id</span>
<span class="p">}</span>
</code></pre></div></div>

<h4 id="ë³´ì•ˆ-ê·¸ë£¹-ëª¨ë“ˆ">ë³´ì•ˆ ê·¸ë£¹ ëª¨ë“ˆ</h4>
<div class="language-hcl highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># modules/security-groups/main.tf</span>
<span class="c1"># ì›¹ ì„œë²„ ë³´ì•ˆ ê·¸ë£¹</span>
<span class="nx">resource</span> <span class="s2">"aws_security_group"</span> <span class="s2">"web"</span> <span class="p">{</span>
  <span class="nx">name_prefix</span> <span class="o">=</span> <span class="s2">"${var.name_prefix}-web-"</span>
  <span class="nx">vpc_id</span>      <span class="o">=</span> <span class="nx">var</span><span class="p">.</span><span class="nx">vpc_id</span>
  <span class="nx">description</span> <span class="o">=</span> <span class="s2">"Security group for web servers"</span>

  <span class="nx">ingress</span> <span class="p">{</span>
    <span class="nx">description</span> <span class="o">=</span> <span class="s2">"HTTP"</span>
    <span class="nx">from_port</span>   <span class="o">=</span> <span class="mi">80</span>
    <span class="nx">to_port</span>     <span class="o">=</span> <span class="mi">80</span>
    <span class="nx">protocol</span>    <span class="o">=</span> <span class="s2">"tcp"</span>
    <span class="nx">cidr_blocks</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"0.0.0.0/0"</span><span class="p">]</span>
  <span class="p">}</span>

  <span class="nx">ingress</span> <span class="p">{</span>
    <span class="nx">description</span> <span class="o">=</span> <span class="s2">"HTTPS"</span>
    <span class="nx">from_port</span>   <span class="o">=</span> <span class="mi">443</span>
    <span class="nx">to_port</span>     <span class="o">=</span> <span class="mi">443</span>
    <span class="nx">protocol</span>    <span class="o">=</span> <span class="s2">"tcp"</span>
    <span class="nx">cidr_blocks</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"0.0.0.0/0"</span><span class="p">]</span>
  <span class="p">}</span>

  <span class="nx">ingress</span> <span class="p">{</span>
    <span class="nx">description</span>     <span class="o">=</span> <span class="s2">"SSH from management"</span>
    <span class="nx">from_port</span>       <span class="o">=</span> <span class="mi">22</span>
    <span class="nx">to_port</span>         <span class="o">=</span> <span class="mi">22</span>
    <span class="nx">protocol</span>        <span class="o">=</span> <span class="s2">"tcp"</span>
    <span class="nx">security_groups</span> <span class="o">=</span> <span class="p">[</span><span class="nx">aws_security_group</span><span class="p">.</span><span class="nx">management</span><span class="p">.</span><span class="nx">id</span><span class="p">]</span>
  <span class="p">}</span>

  <span class="nx">egress</span> <span class="p">{</span>
    <span class="nx">from_port</span>   <span class="o">=</span> <span class="mi">0</span>
    <span class="nx">to_port</span>     <span class="o">=</span> <span class="mi">0</span>
    <span class="nx">protocol</span>    <span class="o">=</span> <span class="s2">"-1"</span>
    <span class="nx">cidr_blocks</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"0.0.0.0/0"</span><span class="p">]</span>
  <span class="p">}</span>

  <span class="nx">tags</span> <span class="o">=</span> <span class="nx">merge</span><span class="p">(</span><span class="nx">var</span><span class="p">.</span><span class="nx">tags</span><span class="p">,</span> <span class="p">{</span>
    <span class="nx">Name</span> <span class="o">=</span> <span class="s2">"${var.name_prefix}-web-sg"</span>
  <span class="p">})</span>

  <span class="nx">lifecycle</span> <span class="p">{</span>
    <span class="nx">create_before_destroy</span> <span class="o">=</span> <span class="kc">true</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="c1"># ë°ì´í„°ë² ì´ìŠ¤ ë³´ì•ˆ ê·¸ë£¹</span>
<span class="nx">resource</span> <span class="s2">"aws_security_group"</span> <span class="s2">"database"</span> <span class="p">{</span>
  <span class="nx">name_prefix</span> <span class="o">=</span> <span class="s2">"${var.name_prefix}-db-"</span>
  <span class="nx">vpc_id</span>      <span class="o">=</span> <span class="nx">var</span><span class="p">.</span><span class="nx">vpc_id</span>
  <span class="nx">description</span> <span class="o">=</span> <span class="s2">"Security group for database servers"</span>

  <span class="nx">ingress</span> <span class="p">{</span>
    <span class="nx">description</span>     <span class="o">=</span> <span class="s2">"MySQL/MariaDB"</span>
    <span class="nx">from_port</span>       <span class="o">=</span> <span class="mi">3306</span>
    <span class="nx">to_port</span>         <span class="o">=</span> <span class="mi">3306</span>
    <span class="nx">protocol</span>        <span class="o">=</span> <span class="s2">"tcp"</span>
    <span class="nx">security_groups</span> <span class="o">=</span> <span class="p">[</span><span class="nx">aws_security_group</span><span class="p">.</span><span class="nx">web</span><span class="p">.</span><span class="nx">id</span><span class="p">]</span>
  <span class="p">}</span>

  <span class="nx">ingress</span> <span class="p">{</span>
    <span class="nx">description</span>     <span class="o">=</span> <span class="s2">"PostgreSQL"</span>
    <span class="nx">from_port</span>       <span class="o">=</span> <span class="mi">5432</span>
    <span class="nx">to_port</span>         <span class="o">=</span> <span class="mi">5432</span>
    <span class="nx">protocol</span>        <span class="o">=</span> <span class="s2">"tcp"</span>
    <span class="nx">security_groups</span> <span class="o">=</span> <span class="p">[</span><span class="nx">aws_security_group</span><span class="p">.</span><span class="nx">web</span><span class="p">.</span><span class="nx">id</span><span class="p">]</span>
  <span class="p">}</span>

  <span class="nx">tags</span> <span class="o">=</span> <span class="nx">merge</span><span class="p">(</span><span class="nx">var</span><span class="p">.</span><span class="nx">tags</span><span class="p">,</span> <span class="p">{</span>
    <span class="nx">Name</span> <span class="o">=</span> <span class="s2">"${var.name_prefix}-db-sg"</span>
  <span class="p">})</span>
<span class="p">}</span>

<span class="c1"># ê´€ë¦¬ ë³´ì•ˆ ê·¸ë£¹</span>
<span class="nx">resource</span> <span class="s2">"aws_security_group"</span> <span class="s2">"management"</span> <span class="p">{</span>
  <span class="nx">name_prefix</span> <span class="o">=</span> <span class="s2">"${var.name_prefix}-mgmt-"</span>
  <span class="nx">vpc_id</span>      <span class="o">=</span> <span class="nx">var</span><span class="p">.</span><span class="nx">vpc_id</span>
  <span class="nx">description</span> <span class="o">=</span> <span class="s2">"Security group for management access"</span>

  <span class="nx">ingress</span> <span class="p">{</span>
    <span class="nx">description</span> <span class="o">=</span> <span class="s2">"SSH"</span>
    <span class="nx">from_port</span>   <span class="o">=</span> <span class="mi">22</span>
    <span class="nx">to_port</span>     <span class="o">=</span> <span class="mi">22</span>
    <span class="nx">protocol</span>    <span class="o">=</span> <span class="s2">"tcp"</span>
    <span class="nx">cidr_blocks</span> <span class="o">=</span> <span class="nx">var</span><span class="err">.</span><span class="nx">management_cidr_blocks</span>
  <span class="p">}</span>

  <span class="nx">ingress</span> <span class="p">{</span>
    <span class="nx">description</span> <span class="o">=</span> <span class="s2">"RDP"</span>
    <span class="nx">from_port</span>   <span class="o">=</span> <span class="mi">3389</span>
    <span class="nx">to_port</span>     <span class="o">=</span> <span class="mi">3389</span>
    <span class="nx">protocol</span>    <span class="o">=</span> <span class="s2">"tcp"</span>
    <span class="nx">cidr_blocks</span> <span class="o">=</span> <span class="nx">var</span><span class="err">.</span><span class="nx">management_cidr_blocks</span>
  <span class="p">}</span>

  <span class="nx">egress</span> <span class="p">{</span>
    <span class="nx">from_port</span>   <span class="o">=</span> <span class="mi">0</span>
    <span class="nx">to_port</span>     <span class="o">=</span> <span class="mi">0</span>
    <span class="nx">protocol</span>    <span class="o">=</span> <span class="s2">"-1"</span>
    <span class="nx">cidr_blocks</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"0.0.0.0/0"</span><span class="p">]</span>
  <span class="p">}</span>

  <span class="nx">tags</span> <span class="o">=</span> <span class="nx">merge</span><span class="p">(</span><span class="nx">var</span><span class="p">.</span><span class="nx">tags</span><span class="p">,</span> <span class="p">{</span>
    <span class="nx">Name</span> <span class="o">=</span> <span class="s2">"${var.name_prefix}-mgmt-sg"</span>
  <span class="p">})</span>
<span class="p">}</span>
</code></pre></div></div>

<h4 id="ë©”ì¸-í™˜ê²½-ì„¤ì •">ë©”ì¸ í™˜ê²½ ì„¤ì •</h4>
<div class="language-hcl highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># environments/production/main.tf</span>
<span class="nx">terraform</span> <span class="p">{</span>
  <span class="nx">required_version</span> <span class="o">=</span> <span class="s2">"&gt;= 1.0"</span>
  
  <span class="nx">backend</span> <span class="s2">"s3"</span> <span class="p">{</span>
    <span class="nx">bucket</span>         <span class="o">=</span> <span class="s2">"company-terraform-state"</span>
    <span class="nx">key</span>            <span class="o">=</span> <span class="s2">"network/production/terraform.tfstate"</span>
    <span class="nx">region</span>         <span class="o">=</span> <span class="s2">"us-west-2"</span>
    <span class="nx">encrypt</span>        <span class="o">=</span> <span class="kc">true</span>
    <span class="nx">dynamodb_table</span> <span class="o">=</span> <span class="s2">"terraform-locks"</span>
  <span class="p">}</span>

  <span class="nx">required_providers</span> <span class="p">{</span>
    <span class="nx">aws</span> <span class="o">=</span> <span class="p">{</span>
      <span class="nx">source</span>  <span class="o">=</span> <span class="s2">"hashicorp/aws"</span>
      <span class="nx">version</span> <span class="o">=</span> <span class="s2">"~&gt; 5.0"</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="nx">provider</span> <span class="s2">"aws"</span> <span class="p">{</span>
  <span class="nx">region</span> <span class="o">=</span> <span class="nx">var</span><span class="p">.</span><span class="nx">aws_region</span>
  
  <span class="nx">default_tags</span> <span class="p">{</span>
    <span class="nx">tags</span> <span class="o">=</span> <span class="p">{</span>
      <span class="nx">Environment</span>   <span class="o">=</span> <span class="nx">var</span><span class="p">.</span><span class="nx">environment</span>
      <span class="nx">Project</span>       <span class="o">=</span> <span class="nx">var</span><span class="p">.</span><span class="nx">project_name</span>
      <span class="nx">ManagedBy</span>     <span class="o">=</span> <span class="s2">"Terraform"</span>
      <span class="nx">CreatedBy</span>     <span class="o">=</span> <span class="nx">var</span><span class="p">.</span><span class="nx">created_by</span>
      <span class="nx">CostCenter</span>    <span class="o">=</span> <span class="nx">var</span><span class="p">.</span><span class="nx">cost_center</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="c1"># ë°ì´í„° ì†ŒìŠ¤</span>
<span class="nx">data</span> <span class="s2">"aws_availability_zones"</span> <span class="s2">"available"</span> <span class="p">{</span>
  <span class="nx">state</span> <span class="o">=</span> <span class="s2">"available"</span>
<span class="p">}</span>

<span class="c1"># VPC ëª¨ë“ˆ í˜¸ì¶œ</span>
<span class="nx">module</span> <span class="s2">"vpc"</span> <span class="p">{</span>
  <span class="nx">source</span> <span class="o">=</span> <span class="s2">"../../modules/vpc"</span>

  <span class="nx">name_prefix</span>        <span class="o">=</span> <span class="nx">var</span><span class="p">.</span><span class="nx">name_prefix</span>
  <span class="nx">cidr_block</span>         <span class="o">=</span> <span class="nx">var</span><span class="p">.</span><span class="nx">vpc_cidr</span>
  <span class="nx">public_subnets</span>     <span class="o">=</span> <span class="nx">var</span><span class="p">.</span><span class="nx">public_subnet_cidrs</span>
  <span class="nx">private_subnets</span>    <span class="o">=</span> <span class="nx">var</span><span class="p">.</span><span class="nx">private_subnet_cidrs</span>
  <span class="nx">availability_zones</span> <span class="o">=</span> <span class="nx">slice</span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">aws_availability_zones</span><span class="p">.</span><span class="nx">available</span><span class="p">.</span><span class="nx">names</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
  <span class="nx">enable_nat_gateway</span> <span class="o">=</span> <span class="nx">var</span><span class="p">.</span><span class="nx">enable_nat_gateway</span>

  <span class="nx">tags</span> <span class="o">=</span> <span class="nx">local</span><span class="p">.</span><span class="nx">common_tags</span>
<span class="p">}</span>

<span class="c1"># ë³´ì•ˆ ê·¸ë£¹ ëª¨ë“ˆ í˜¸ì¶œ</span>
<span class="nx">module</span> <span class="s2">"security_groups"</span> <span class="p">{</span>
  <span class="nx">source</span> <span class="o">=</span> <span class="s2">"../../modules/security-groups"</span>

  <span class="nx">name_prefix</span>             <span class="o">=</span> <span class="nx">var</span><span class="p">.</span><span class="nx">name_prefix</span>
  <span class="nx">vpc_id</span>                  <span class="o">=</span> <span class="nx">module</span><span class="p">.</span><span class="nx">vpc</span><span class="p">.</span><span class="nx">vpc_id</span>
  <span class="nx">management_cidr_blocks</span>  <span class="o">=</span> <span class="nx">var</span><span class="p">.</span><span class="nx">management_cidr_blocks</span>

  <span class="nx">tags</span> <span class="o">=</span> <span class="nx">local</span><span class="p">.</span><span class="nx">common_tags</span>
<span class="p">}</span>

<span class="c1"># ë¡œì»¬ ê°’</span>
<span class="nx">locals</span> <span class="p">{</span>
  <span class="nx">common_tags</span> <span class="o">=</span> <span class="p">{</span>
    <span class="nx">Environment</span> <span class="o">=</span> <span class="nx">var</span><span class="p">.</span><span class="nx">environment</span>
    <span class="nx">Project</span>     <span class="o">=</span> <span class="nx">var</span><span class="p">.</span><span class="nx">project_name</span>
    <span class="nx">ManagedBy</span>   <span class="o">=</span> <span class="s2">"Terraform"</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h4 id="í™˜ê²½ë³„-ë³€ìˆ˜-íŒŒì¼">í™˜ê²½ë³„ ë³€ìˆ˜ íŒŒì¼</h4>
<div class="language-hcl highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># environments/production/variables.tf</span>
<span class="nx">variable</span> <span class="s2">"aws_region"</span> <span class="p">{</span>
  <span class="nx">description</span> <span class="o">=</span> <span class="s2">"AWS region"</span>
  <span class="nx">type</span>        <span class="o">=</span> <span class="nx">string</span>
  <span class="nx">default</span>     <span class="o">=</span> <span class="s2">"us-west-2"</span>
<span class="p">}</span>

<span class="nx">variable</span> <span class="s2">"environment"</span> <span class="p">{</span>
  <span class="nx">description</span> <span class="o">=</span> <span class="s2">"Environment name"</span>
  <span class="nx">type</span>        <span class="o">=</span> <span class="nx">string</span>
  <span class="nx">default</span>     <span class="o">=</span> <span class="s2">"production"</span>
<span class="p">}</span>

<span class="nx">variable</span> <span class="s2">"project_name"</span> <span class="p">{</span>
  <span class="nx">description</span> <span class="o">=</span> <span class="s2">"Project name"</span>
  <span class="nx">type</span>        <span class="o">=</span> <span class="nx">string</span>
<span class="p">}</span>

<span class="nx">variable</span> <span class="s2">"name_prefix"</span> <span class="p">{</span>
  <span class="nx">description</span> <span class="o">=</span> <span class="s2">"Name prefix for resources"</span>
  <span class="nx">type</span>        <span class="o">=</span> <span class="nx">string</span>
<span class="p">}</span>

<span class="nx">variable</span> <span class="s2">"vpc_cidr"</span> <span class="p">{</span>
  <span class="nx">description</span> <span class="o">=</span> <span class="s2">"CIDR block for VPC"</span>
  <span class="nx">type</span>        <span class="o">=</span> <span class="nx">string</span>
<span class="p">}</span>

<span class="nx">variable</span> <span class="s2">"public_subnet_cidrs"</span> <span class="p">{</span>
  <span class="nx">description</span> <span class="o">=</span> <span class="s2">"CIDR blocks for public subnets"</span>
  <span class="nx">type</span>        <span class="o">=</span> <span class="nx">list</span><span class="p">(</span><span class="nx">string</span><span class="p">)</span>
<span class="p">}</span>

<span class="nx">variable</span> <span class="s2">"private_subnet_cidrs"</span> <span class="p">{</span>
  <span class="nx">description</span> <span class="o">=</span> <span class="s2">"CIDR blocks for private subnets"</span>
  <span class="nx">type</span>        <span class="o">=</span> <span class="nx">list</span><span class="p">(</span><span class="nx">string</span><span class="p">)</span>
<span class="p">}</span>

<span class="nx">variable</span> <span class="s2">"enable_nat_gateway"</span> <span class="p">{</span>
  <span class="nx">description</span> <span class="o">=</span> <span class="s2">"Enable NAT Gateway"</span>
  <span class="nx">type</span>        <span class="o">=</span> <span class="nx">bool</span>
  <span class="nx">default</span>     <span class="o">=</span> <span class="kc">true</span>
<span class="p">}</span>

<span class="nx">variable</span> <span class="s2">"management_cidr_blocks"</span> <span class="p">{</span>
  <span class="nx">description</span> <span class="o">=</span> <span class="s2">"CIDR blocks allowed for management access"</span>
  <span class="nx">type</span>        <span class="o">=</span> <span class="nx">list</span><span class="p">(</span><span class="nx">string</span><span class="p">)</span>
<span class="p">}</span>

<span class="nx">variable</span> <span class="s2">"created_by"</span> <span class="p">{</span>
  <span class="nx">description</span> <span class="o">=</span> <span class="s2">"Creator of the infrastructure"</span>
  <span class="nx">type</span>        <span class="o">=</span> <span class="nx">string</span>
<span class="p">}</span>

<span class="nx">variable</span> <span class="s2">"cost_center"</span> <span class="p">{</span>
  <span class="nx">description</span> <span class="o">=</span> <span class="s2">"Cost center for billing"</span>
  <span class="nx">type</span>        <span class="o">=</span> <span class="nx">string</span>
<span class="p">}</span>
</code></pre></div></div>

<h4 id="terraform-ì‹¤í–‰-ê°’">Terraform ì‹¤í–‰ ê°’</h4>
<div class="language-hcl highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># environments/production/terraform.tfvars</span>
<span class="nx">project_name</span> <span class="o">=</span> <span class="s2">"company-web-app"</span>
<span class="nx">name_prefix</span>  <span class="o">=</span> <span class="s2">"prod-webapp"</span>

<span class="nx">vpc_cidr</span> <span class="o">=</span> <span class="s2">"10.0.0.0/16"</span>

<span class="nx">public_subnet_cidrs</span> <span class="o">=</span> <span class="p">[</span>
  <span class="s2">"10.0.1.0/24"</span><span class="p">,</span>
  <span class="s2">"10.0.2.0/24"</span><span class="p">,</span> 
  <span class="s2">"10.0.3.0/24"</span>
<span class="p">]</span>

<span class="nx">private_subnet_cidrs</span> <span class="o">=</span> <span class="p">[</span>
  <span class="s2">"10.0.11.0/24"</span><span class="p">,</span>
  <span class="s2">"10.0.12.0/24"</span><span class="p">,</span>
  <span class="s2">"10.0.13.0/24"</span>
<span class="p">]</span>

<span class="nx">enable_nat_gateway</span> <span class="o">=</span> <span class="kc">true</span>

<span class="nx">management_cidr_blocks</span> <span class="o">=</span> <span class="p">[</span>
  <span class="s2">"203.0.113.0/24"</span><span class="p">,</span>  <span class="c1"># íšŒì‚¬ ì‚¬ë¬´ì‹¤</span>
  <span class="s2">"198.51.100.0/24"</span>  <span class="c1"># VPN ë„¤íŠ¸ì›Œí¬</span>
<span class="p">]</span>

<span class="nx">created_by</span>   <span class="o">=</span> <span class="s2">"devops-team"</span>
<span class="nx">cost_center</span>  <span class="o">=</span> <span class="s2">"engineering"</span>
</code></pre></div></div>

<h4 id="terraform-ì‹¤í–‰-ë°-ê´€ë¦¬">Terraform ì‹¤í–‰ ë° ê´€ë¦¬</h4>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># ì´ˆê¸°í™”</span>
terraform init

<span class="c"># ê³„íš í™•ì¸  </span>
terraform plan <span class="nt">-var-file</span><span class="o">=</span><span class="s2">"terraform.tfvars"</span>

<span class="c"># ì ìš©</span>
terraform apply <span class="nt">-var-file</span><span class="o">=</span><span class="s2">"terraform.tfvars"</span>

<span class="c"># ìƒíƒœ í™•ì¸</span>
terraform show
terraform state list

<span class="c"># ë¦¬ì†ŒìŠ¤ í™•ì¸</span>
terraform state show module.vpc.aws_vpc.main

<span class="c"># ì¶œë ¥ ê°’ í™•ì¸</span>
terraform output

<span class="c"># ë¦¬ì†ŒìŠ¤ ì‚­ì œ</span>
terraform destroy <span class="nt">-var-file</span><span class="o">=</span><span class="s2">"terraform.tfvars"</span>

<span class="c"># ì›Œí¬ìŠ¤í˜ì´ìŠ¤ ê´€ë¦¬</span>
terraform workspace new staging
terraform workspace <span class="k">select </span>production
terraform workspace list
</code></pre></div></div>

<h4 id="ê³ ê¸‰-terraform-ê¸°ëŠ¥">ê³ ê¸‰ Terraform ê¸°ëŠ¥</h4>
<div class="language-hcl highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># ì¡°ê±´ë¶€ ë¦¬ì†ŒìŠ¤ ìƒì„±</span>
<span class="nx">resource</span> <span class="s2">"aws_instance"</span> <span class="s2">"web"</span> <span class="p">{</span>
  <span class="nx">count</span> <span class="o">=</span> <span class="nx">var</span><span class="p">.</span><span class="nx">environment</span> <span class="o">==</span> <span class="s2">"production"</span> <span class="o">?</span> <span class="mi">3</span> <span class="o">:</span> <span class="mi">1</span>
  
  <span class="nx">ami</span>           <span class="o">=</span> <span class="nx">data</span><span class="p">.</span><span class="nx">aws_ami</span><span class="p">.</span><span class="nx">amazon_linux</span><span class="p">.</span><span class="nx">id</span>
  <span class="nx">instance_type</span> <span class="o">=</span> <span class="nx">var</span><span class="p">.</span><span class="nx">environment</span> <span class="o">==</span> <span class="s2">"production"</span> <span class="o">?</span> <span class="s2">"t3.medium"</span> <span class="o">:</span> <span class="s2">"t3.micro"</span>
  
  <span class="nx">tags</span> <span class="o">=</span> <span class="p">{</span>
    <span class="nx">Name</span> <span class="o">=</span> <span class="s2">"${var.name_prefix}-web-${count.index + 1}"</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="c1"># ë™ì  ë¸”ë¡</span>
<span class="nx">resource</span> <span class="s2">"aws_security_group"</span> <span class="s2">"web"</span> <span class="p">{</span>
  <span class="nx">name_prefix</span> <span class="o">=</span> <span class="s2">"${var.name_prefix}-web-"</span>
  <span class="nx">vpc_id</span>      <span class="o">=</span> <span class="nx">var</span><span class="p">.</span><span class="nx">vpc_id</span>

  <span class="nx">dynamic</span> <span class="s2">"ingress"</span> <span class="p">{</span>
    <span class="nx">for_each</span> <span class="o">=</span> <span class="nx">var</span><span class="p">.</span><span class="nx">ingress_rules</span>
    <span class="nx">content</span> <span class="p">{</span>
      <span class="nx">from_port</span>   <span class="o">=</span> <span class="nx">ingress</span><span class="p">.</span><span class="nx">value</span><span class="p">.</span><span class="nx">from_port</span>
      <span class="nx">to_port</span>     <span class="o">=</span> <span class="nx">ingress</span><span class="p">.</span><span class="nx">value</span><span class="p">.</span><span class="nx">to_port</span>
      <span class="nx">protocol</span>    <span class="o">=</span> <span class="nx">ingress</span><span class="p">.</span><span class="nx">value</span><span class="p">.</span><span class="nx">protocol</span>
      <span class="nx">cidr_blocks</span> <span class="o">=</span> <span class="nx">ingress</span><span class="p">.</span><span class="nx">value</span><span class="p">.</span><span class="nx">cidr_blocks</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="c1"># ë°ì´í„° ì†ŒìŠ¤ í™œìš©</span>
<span class="nx">data</span> <span class="s2">"aws_ami"</span> <span class="s2">"amazon_linux"</span> <span class="p">{</span>
  <span class="nx">most_recent</span> <span class="o">=</span> <span class="kc">true</span>
  <span class="nx">owners</span>      <span class="o">=</span> <span class="p">[</span><span class="s2">"amazon"</span><span class="p">]</span>

  <span class="nx">filter</span> <span class="p">{</span>
    <span class="nx">name</span>   <span class="o">=</span> <span class="s2">"name"</span>
    <span class="nx">values</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"amzn2-ami-hvm-*-x86_64-gp2"</span><span class="p">]</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="c1"># ì›ê²© ìƒíƒœ ì°¸ì¡°</span>
<span class="nx">data</span> <span class="s2">"terraform_remote_state"</span> <span class="s2">"vpc"</span> <span class="p">{</span>
  <span class="nx">backend</span> <span class="o">=</span> <span class="s2">"s3"</span>
  <span class="nx">config</span> <span class="o">=</span> <span class="p">{</span>
    <span class="nx">bucket</span> <span class="o">=</span> <span class="s2">"company-terraform-state"</span>
    <span class="nx">key</span>    <span class="o">=</span> <span class="s2">"network/production/terraform.tfstate"</span>
    <span class="nx">region</span> <span class="o">=</span> <span class="s2">"us-west-2"</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="2-4-ë‹¨ì¼-ì¥ì• -ì§€ì -ì œê±°--eliminating-single-points-of-failure">2-4 ë‹¨ì¼ ì¥ì•  ì§€ì  ì œê±° | Eliminating Single Points of Failure</h2>

<h3 id="2-4-1-spof-ì°¾ê¸°--identifying-spof">2-4-1 SPOF ì°¾ê¸° | Identifying SPOF</h3>

<p>ë‹¨ì¼ ì¥ì•  ì§€ì (SPOF)ì€ ì‹œìŠ¤í…œì˜ í•œ êµ¬ì„± ìš”ì†Œê°€ ì‹¤íŒ¨í•  ë•Œ ì „ì²´ ì‹œìŠ¤í…œì´ ì‘ë™ì„ ë©ˆì¶”ê²Œ ë˜ëŠ” ì§€ì ì„ ë§í•©ë‹ˆë‹¤. ë„¤íŠ¸ì›Œí¬ ì¸í”„ë¼ì—ì„œ SPOFë¥¼ ì‹ë³„í•˜ê³  ì œê±°í•˜ëŠ” ê²ƒì€ ê³ ê°€ìš©ì„± í™•ë³´ì˜ í•µì‹¬ì…ë‹ˆë‹¤.</p>

<h4 id="-spof-ì‹ë³„-ë°©ë²•ë¡ ">ğŸ” SPOF ì‹ë³„ ë°©ë²•ë¡ </h4>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># SPOF ë¶„ì„ ì²´í¬ë¦¬ìŠ¤íŠ¸</span>
1. ë„¤íŠ¸ì›Œí¬ í† í´ë¡œì§€ ë¶„ì„
   - ë‹¨ì¼ ì—°ê²°ì  í™•ì¸
   - ë°±ì—… ê²½ë¡œ ì¡´ì¬ ì—¬ë¶€
   - ëŒ€ì—­í­ ë³‘ëª© ì§€ì 

2. í•˜ë“œì›¨ì–´ êµ¬ì„± ìš”ì†Œ ì ê²€
   - ë‹¨ì¼ ìŠ¤ìœ„ì¹˜/ë¼ìš°í„° ì˜ì¡´ì„±
   - ì „ì› ê³µê¸‰ ì¥ì¹˜
   - ì¼€ì´ë¸”ë§ ê²½ë¡œ

3. ì„œë¹„ìŠ¤ ì˜ì¡´ì„± ë¶„ì„
   - DNS ì„œë²„
   - DHCP ì„œë²„  
   - ì¸ì¦ ì„œë²„ <span class="o">(</span>RADIUS/LDAP<span class="o">)</span>

4. ì™¸ë¶€ ì—°ê²° ê²€í† 
   - ISP ì—°ê²°
   - WAN íšŒì„ 
   - í´ë¼ìš°ë“œ ì—°ê²°
</code></pre></div></div>

<h4 id="ë„¤íŠ¸ì›Œí¬-í† í´ë¡œì§€-spof-ë¶„ì„">ë„¤íŠ¸ì›Œí¬ í† í´ë¡œì§€ SPOF ë¶„ì„</h4>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># í˜„ì¬ ë„¤íŠ¸ì›Œí¬ ìƒíƒœ í™•ì¸</span>
<span class="c"># Linux í™˜ê²½ì—ì„œ ë„¤íŠ¸ì›Œí¬ ê²½ë¡œ ë¶„ì„</span>
ip route show table main
traceroute <span class="nt">-n</span> 8.8.8.8
mtr <span class="nt">--report</span> <span class="nt">--report-cycles</span><span class="o">=</span>100 google.com

<span class="c"># ë¼ìš°íŒ… í…Œì´ë¸” ë¶„ì„</span>
netstat <span class="nt">-rn</span>
route <span class="nt">-n</span>

<span class="c"># ì¸í„°í˜ì´ìŠ¤ ìƒíƒœ í™•ì¸</span>
ip <span class="nb">link </span>show
ip addr show
ethtool eth0  <span class="c"># ë§í¬ ìƒíƒœ, ì†ë„ í™•ì¸</span>

<span class="c"># Cisco ì¥ë¹„ì—ì„œ SPOF ë¶„ì„</span>
show ip route
show interface summary  
show spanning-tree root
show etherchannel summary
show redundancy

<span class="c"># ëŒ€ì—­í­ ì‚¬ìš©ë¥  ëª¨ë‹ˆí„°ë§</span>
show interface fastethernet 0/1 | include rate
show processes cpu sorted
show memory summary
</code></pre></div></div>

<h4 id="ì¼ë°˜ì ì¸-ë„¤íŠ¸ì›Œí¬-spof-íŒ¨í„´">ì¼ë°˜ì ì¸ ë„¤íŠ¸ì›Œí¬ SPOF íŒ¨í„´</h4>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># 1. ë‹¨ì¼ ì—…ë§í¬ (Single Uplink)</span>
ë¬¸ì œ: í•˜ë‚˜ì˜ ì—…ìŠ¤íŠ¸ë¦¼ ì—°ê²°ë§Œ ì¡´ì¬
ì˜í–¥: í•´ë‹¹ ì—°ê²° ì‹¤íŒ¨ ì‹œ ì „ì²´ ë„¤íŠ¸ì›Œí¬ ë‹¨ì ˆ
í•´ê²°: ì´ì¤‘ ì—…ë§í¬ + ë¡œë“œë°¸ëŸ°ì‹±

<span class="c"># 2. ë‹¨ì¼ ì½”ì–´ ìŠ¤ìœ„ì¹˜ (Single Core Switch)  </span>
ë¬¸ì œ: ëª¨ë“  ì•¡ì„¸ìŠ¤ ìŠ¤ìœ„ì¹˜ê°€ í•˜ë‚˜ì˜ ì½”ì–´ì— ì—°ê²°
ì˜í–¥: ì½”ì–´ ìŠ¤ìœ„ì¹˜ ì‹¤íŒ¨ ì‹œ ì „ì²´ ë„¤íŠ¸ì›Œí¬ ë§ˆë¹„
í•´ê²°: ì´ì¤‘ ì½”ì–´ ìŠ¤ìœ„ì¹˜ + HSRP/VRRP

<span class="c"># 3. ë‹¨ì¼ VLAN (Single VLAN)</span>
ë¬¸ì œ: ë¸Œë¡œë“œìºìŠ¤íŠ¸ ë„ë©”ì¸ ê³¼ë¶€í•˜
ì˜í–¥: ë„¤íŠ¸ì›Œí¬ ì„±ëŠ¥ ì €í•˜, ì¥ì•  ì „íŒŒ
í•´ê²°: VLAN ë¶„í•  + Inter-VLAN ë¼ìš°íŒ…

<span class="c"># 4. ë‹¨ì¼ ISP (Single ISP)</span>
ë¬¸ì œ: í•˜ë‚˜ì˜ ì¸í„°ë„· ì„œë¹„ìŠ¤ ì œê³µì—…ì²´
ì˜í–¥: ISP ì¥ì•  ì‹œ ì¸í„°ë„· ì—°ê²° ë¶ˆê°€
í•´ê²°: ë©€í‹° ISP + BGP ë¼ìš°íŒ…
</code></pre></div></div>

<h4 id="spof-íƒì§€-ë„êµ¬ì™€-ìŠ¤í¬ë¦½íŠ¸">SPOF íƒì§€ ë„êµ¬ì™€ ìŠ¤í¬ë¦½íŠ¸</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#!/usr/bin/env python3
# spof_detector.py - ë„¤íŠ¸ì›Œí¬ SPOF íƒì§€ ë„êµ¬
</span>
<span class="kn">import</span> <span class="n">subprocess</span>
<span class="kn">import</span> <span class="n">json</span>
<span class="kn">import</span> <span class="n">sys</span>
<span class="kn">from</span> <span class="n">collections</span> <span class="kn">import</span> <span class="n">defaultdict</span>
<span class="kn">import</span> <span class="n">networkx</span> <span class="k">as</span> <span class="n">nx</span>

<span class="k">class</span> <span class="nc">SPOFDetector</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">network_graph</span> <span class="o">=</span> <span class="n">nx</span><span class="p">.</span><span class="nc">Graph</span><span class="p">()</span>
        <span class="n">self</span><span class="p">.</span><span class="n">devices</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">self</span><span class="p">.</span><span class="n">links</span> <span class="o">=</span> <span class="p">{}</span>
        
    <span class="k">def</span> <span class="nf">scan_network_topology</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">network_range</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ë„¤íŠ¸ì›Œí¬ í† í´ë¡œì§€ ìŠ¤ìº”</span><span class="sh">"""</span>
        <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Scanning network range: </span><span class="si">{</span><span class="n">network_range</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
        
        <span class="c1"># SNMPì„ í†µí•œ ë„¤íŠ¸ì›Œí¬ ë””ìŠ¤ì»¤ë²„ë¦¬
</span>        <span class="n">devices</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">discover_devices</span><span class="p">(</span><span class="n">network_range</span><span class="p">)</span>
        
        <span class="k">for</span> <span class="n">device</span> <span class="ow">in</span> <span class="n">devices</span><span class="p">:</span>
            <span class="n">self</span><span class="p">.</span><span class="nf">analyze_device</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
            
        <span class="k">return</span> <span class="n">self</span><span class="p">.</span><span class="nf">identify_spof</span><span class="p">()</span>
    
    <span class="k">def</span> <span class="nf">discover_devices</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">network_range</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">SNMPë¥¼ í†µí•œ ë„¤íŠ¸ì›Œí¬ ì¥ë¹„ ë°œê²¬</span><span class="sh">"""</span>
        <span class="n">cmd</span> <span class="o">=</span> <span class="sa">f</span><span class="sh">"</span><span class="s">nmap -sn </span><span class="si">{</span><span class="n">network_range</span><span class="si">}</span><span class="sh">"</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">subprocess</span><span class="p">.</span><span class="nf">run</span><span class="p">(</span><span class="n">cmd</span><span class="p">.</span><span class="nf">split</span><span class="p">(),</span> <span class="n">capture_output</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        
        <span class="n">devices</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">result</span><span class="p">.</span><span class="n">stdout</span><span class="p">.</span><span class="nf">split</span><span class="p">(</span><span class="sh">'</span><span class="se">\n</span><span class="sh">'</span><span class="p">):</span>
            <span class="k">if</span> <span class="sh">'</span><span class="s">Nmap scan report</span><span class="sh">'</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
                <span class="n">ip</span> <span class="o">=</span> <span class="n">line</span><span class="p">.</span><span class="nf">split</span><span class="p">()[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">devices</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">ip</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">devices</span>
    
    <span class="k">def</span> <span class="nf">analyze_device</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">device_ip</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ê°œë³„ ì¥ë¹„ ë¶„ì„</span><span class="sh">"""</span>
        <span class="n">device_info</span> <span class="o">=</span> <span class="p">{</span>
            <span class="sh">'</span><span class="s">ip</span><span class="sh">'</span><span class="p">:</span> <span class="n">device_ip</span><span class="p">,</span>
            <span class="sh">'</span><span class="s">type</span><span class="sh">'</span><span class="p">:</span> <span class="n">self</span><span class="p">.</span><span class="nf">detect_device_type</span><span class="p">(</span><span class="n">device_ip</span><span class="p">),</span>
            <span class="sh">'</span><span class="s">interfaces</span><span class="sh">'</span><span class="p">:</span> <span class="n">self</span><span class="p">.</span><span class="nf">get_interfaces</span><span class="p">(</span><span class="n">device_ip</span><span class="p">),</span>
            <span class="sh">'</span><span class="s">neighbors</span><span class="sh">'</span><span class="p">:</span> <span class="n">self</span><span class="p">.</span><span class="nf">get_neighbors</span><span class="p">(</span><span class="n">device_ip</span><span class="p">),</span>
            <span class="sh">'</span><span class="s">redundancy</span><span class="sh">'</span><span class="p">:</span> <span class="n">self</span><span class="p">.</span><span class="nf">check_redundancy</span><span class="p">(</span><span class="n">device_ip</span><span class="p">)</span>
        <span class="p">}</span>
        
        <span class="n">self</span><span class="p">.</span><span class="n">devices</span><span class="p">[</span><span class="n">device_ip</span><span class="p">]</span> <span class="o">=</span> <span class="n">device_info</span>
        <span class="n">self</span><span class="p">.</span><span class="n">network_graph</span><span class="p">.</span><span class="nf">add_node</span><span class="p">(</span><span class="n">device_ip</span><span class="p">,</span> <span class="o">**</span><span class="n">device_info</span><span class="p">)</span>
        
    <span class="k">def</span> <span class="nf">detect_device_type</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">device_ip</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ì¥ë¹„ ìœ í˜• ê°ì§€ (ë¼ìš°í„°/ìŠ¤ìœ„ì¹˜/ë°©í™”ë²½)</span><span class="sh">"""</span>
        <span class="c1"># SNMP OIDë¥¼ í†µí•œ ì¥ë¹„ ìœ í˜• í™•ì¸
</span>        <span class="n">snmp_cmd</span> <span class="o">=</span> <span class="sa">f</span><span class="sh">"</span><span class="s">snmpget -v2c -c public </span><span class="si">{</span><span class="n">device_ip</span><span class="si">}</span><span class="s"> 1.3.6.1.2.1.1.1.0</span><span class="sh">"</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">subprocess</span><span class="p">.</span><span class="nf">run</span><span class="p">(</span><span class="n">snmp_cmd</span><span class="p">.</span><span class="nf">split</span><span class="p">(),</span> <span class="n">capture_output</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="sh">'</span><span class="s">cisco</span><span class="sh">'</span> <span class="ow">in</span> <span class="n">result</span><span class="p">.</span><span class="n">stdout</span><span class="p">.</span><span class="nf">lower</span><span class="p">():</span>
            <span class="k">if</span> <span class="sh">'</span><span class="s">router</span><span class="sh">'</span> <span class="ow">in</span> <span class="n">result</span><span class="p">.</span><span class="n">stdout</span><span class="p">.</span><span class="nf">lower</span><span class="p">():</span>
                <span class="k">return</span> <span class="sh">'</span><span class="s">router</span><span class="sh">'</span>
            <span class="k">elif</span> <span class="sh">'</span><span class="s">switch</span><span class="sh">'</span> <span class="ow">in</span> <span class="n">result</span><span class="p">.</span><span class="n">stdout</span><span class="p">.</span><span class="nf">lower</span><span class="p">():</span>
                <span class="k">return</span> <span class="sh">'</span><span class="s">switch</span><span class="sh">'</span>
        
        <span class="k">return</span> <span class="sh">'</span><span class="s">unknown</span><span class="sh">'</span>
    
    <span class="k">def</span> <span class="nf">get_interfaces</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">device_ip</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ì¸í„°í˜ì´ìŠ¤ ì •ë³´ ìˆ˜ì§‘</span><span class="sh">"""</span>
        <span class="c1"># SNMPë¥¼ í†µí•œ ì¸í„°í˜ì´ìŠ¤ ìƒíƒœ í™•ì¸
</span>        <span class="n">interfaces</span> <span class="o">=</span> <span class="p">{}</span>
        
        <span class="c1"># ì¸í„°í˜ì´ìŠ¤ ì´ë¦„ (1.3.6.1.2.1.2.2.1.2)
</span>        <span class="c1"># ì¸í„°í˜ì´ìŠ¤ ìƒíƒœ (1.3.6.1.2.1.2.2.1.8)
</span>        <span class="c1"># ì¸í„°í˜ì´ìŠ¤ ì†ë„ (1.3.6.1.2.1.2.2.1.5)
</span>        
        <span class="k">return</span> <span class="n">interfaces</span>
    
    <span class="k">def</span> <span class="nf">get_neighbors</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">device_ip</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ì¸ì ‘ ì¥ë¹„ ì •ë³´ ìˆ˜ì§‘ (CDP/LLDP)</span><span class="sh">"""</span>
        <span class="n">neighbors</span> <span class="o">=</span> <span class="p">[]</span>
        
        <span class="c1"># CDP ì •ë³´ ìˆ˜ì§‘ (1.3.6.1.4.1.9.9.23.1.2.1.1.6)
</span>        <span class="c1"># LLDP ì •ë³´ ìˆ˜ì§‘ (1.0.8802.1.1.2.1.4.1.1.9)
</span>        
        <span class="k">return</span> <span class="n">neighbors</span>
    
    <span class="k">def</span> <span class="nf">check_redundancy</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">device_ip</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ì´ì¤‘í™” êµ¬ì„± í™•ì¸</span><span class="sh">"""</span>
        <span class="n">redundancy_info</span> <span class="o">=</span> <span class="p">{</span>
            <span class="sh">'</span><span class="s">power_supplies</span><span class="sh">'</span><span class="p">:</span> <span class="n">self</span><span class="p">.</span><span class="nf">check_power_supplies</span><span class="p">(</span><span class="n">device_ip</span><span class="p">),</span>
            <span class="sh">'</span><span class="s">uplinks</span><span class="sh">'</span><span class="p">:</span> <span class="n">self</span><span class="p">.</span><span class="nf">check_uplinks</span><span class="p">(</span><span class="n">device_ip</span><span class="p">),</span>
            <span class="sh">'</span><span class="s">protocols</span><span class="sh">'</span><span class="p">:</span> <span class="n">self</span><span class="p">.</span><span class="nf">check_redundancy_protocols</span><span class="p">(</span><span class="n">device_ip</span><span class="p">)</span>
        <span class="p">}</span>
        
        <span class="k">return</span> <span class="n">redundancy_info</span>
    
    <span class="k">def</span> <span class="nf">identify_spof</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">SPOF ì‹ë³„</span><span class="sh">"""</span>
        <span class="n">spof_list</span> <span class="o">=</span> <span class="p">[]</span>
        
        <span class="c1"># 1. ì—°ê²°ì„± ë¶„ì„ - ë‹¨ì¼ ì—°ê²°ì  ì°¾ê¸°
</span>        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">self</span><span class="p">.</span><span class="n">network_graph</span><span class="p">.</span><span class="nf">nodes</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">self</span><span class="p">.</span><span class="n">network_graph</span><span class="p">.</span><span class="nf">degree</span><span class="p">(</span><span class="n">node</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">spof_list</span><span class="p">.</span><span class="nf">append</span><span class="p">({</span>
                    <span class="sh">'</span><span class="s">type</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">single_connection</span><span class="sh">'</span><span class="p">,</span>
                    <span class="sh">'</span><span class="s">device</span><span class="sh">'</span><span class="p">:</span> <span class="n">node</span><span class="p">,</span>
                    <span class="sh">'</span><span class="s">risk</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">high</span><span class="sh">'</span><span class="p">,</span>
                    <span class="sh">'</span><span class="s">description</span><span class="sh">'</span><span class="p">:</span> <span class="sa">f</span><span class="sh">'</span><span class="s">Device </span><span class="si">{</span><span class="n">node</span><span class="si">}</span><span class="s"> has only one connection</span><span class="sh">'</span>
                <span class="p">})</span>
        
        <span class="c1"># 2. ë¸Œë¦¬ì§€ í¬ì¸íŠ¸ ë¶„ì„
</span>        <span class="n">bridges</span> <span class="o">=</span> <span class="nf">list</span><span class="p">(</span><span class="n">nx</span><span class="p">.</span><span class="nf">bridges</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">network_graph</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">bridge</span> <span class="ow">in</span> <span class="n">bridges</span><span class="p">:</span>
            <span class="n">spof_list</span><span class="p">.</span><span class="nf">append</span><span class="p">({</span>
                <span class="sh">'</span><span class="s">type</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">bridge_link</span><span class="sh">'</span><span class="p">,</span>
                <span class="sh">'</span><span class="s">link</span><span class="sh">'</span><span class="p">:</span> <span class="n">bridge</span><span class="p">,</span>
                <span class="sh">'</span><span class="s">risk</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">critical</span><span class="sh">'</span><span class="p">,</span>
                <span class="sh">'</span><span class="s">description</span><span class="sh">'</span><span class="p">:</span> <span class="sa">f</span><span class="sh">'</span><span class="s">Link between </span><span class="si">{</span><span class="n">bridge</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s"> and </span><span class="si">{</span><span class="n">bridge</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s"> is critical</span><span class="sh">'</span>
            <span class="p">})</span>
        
        <span class="c1"># 3. ì ˆë‹¨ì  ë¶„ì„ (Articulation Points)
</span>        <span class="n">articulation_points</span> <span class="o">=</span> <span class="nf">list</span><span class="p">(</span><span class="n">nx</span><span class="p">.</span><span class="nf">articulation_points</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">network_graph</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">point</span> <span class="ow">in</span> <span class="n">articulation_points</span><span class="p">:</span>
            <span class="n">spof_list</span><span class="p">.</span><span class="nf">append</span><span class="p">({</span>
                <span class="sh">'</span><span class="s">type</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">articulation_point</span><span class="sh">'</span><span class="p">,</span>
                <span class="sh">'</span><span class="s">device</span><span class="sh">'</span><span class="p">:</span> <span class="n">point</span><span class="p">,</span>
                <span class="sh">'</span><span class="s">risk</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">critical</span><span class="sh">'</span><span class="p">,</span>
                <span class="sh">'</span><span class="s">description</span><span class="sh">'</span><span class="p">:</span> <span class="sa">f</span><span class="sh">'</span><span class="s">Device </span><span class="si">{</span><span class="n">point</span><span class="si">}</span><span class="s"> is a critical junction point</span><span class="sh">'</span>
            <span class="p">})</span>
        
        <span class="k">return</span> <span class="n">spof_list</span>
    
    <span class="k">def</span> <span class="nf">generate_report</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">spof_list</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">SPOF ë¶„ì„ ë³´ê³ ì„œ ìƒì„±</span><span class="sh">"""</span>
        <span class="n">report</span> <span class="o">=</span> <span class="p">{</span>
            <span class="sh">'</span><span class="s">timestamp</span><span class="sh">'</span><span class="p">:</span> <span class="n">subprocess</span><span class="p">.</span><span class="nf">run</span><span class="p">([</span><span class="sh">'</span><span class="s">date</span><span class="sh">'</span><span class="p">],</span> <span class="n">capture_output</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="bp">True</span><span class="p">).</span><span class="n">stdout</span><span class="p">.</span><span class="nf">strip</span><span class="p">(),</span>
            <span class="sh">'</span><span class="s">total_devices</span><span class="sh">'</span><span class="p">:</span> <span class="nf">len</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">devices</span><span class="p">),</span>
            <span class="sh">'</span><span class="s">total_spof_issues</span><span class="sh">'</span><span class="p">:</span> <span class="nf">len</span><span class="p">(</span><span class="n">spof_list</span><span class="p">),</span>
            <span class="sh">'</span><span class="s">critical_issues</span><span class="sh">'</span><span class="p">:</span> <span class="nf">len</span><span class="p">([</span><span class="n">s</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">spof_list</span> <span class="k">if</span> <span class="n">s</span><span class="p">[</span><span class="sh">'</span><span class="s">risk</span><span class="sh">'</span><span class="p">]</span> <span class="o">==</span> <span class="sh">'</span><span class="s">critical</span><span class="sh">'</span><span class="p">]),</span>
            <span class="sh">'</span><span class="s">high_issues</span><span class="sh">'</span><span class="p">:</span> <span class="nf">len</span><span class="p">([</span><span class="n">s</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">spof_list</span> <span class="k">if</span> <span class="n">s</span><span class="p">[</span><span class="sh">'</span><span class="s">risk</span><span class="sh">'</span><span class="p">]</span> <span class="o">==</span> <span class="sh">'</span><span class="s">high</span><span class="sh">'</span><span class="p">]),</span>
            <span class="sh">'</span><span class="s">spof_details</span><span class="sh">'</span><span class="p">:</span> <span class="n">spof_list</span><span class="p">,</span>
            <span class="sh">'</span><span class="s">recommendations</span><span class="sh">'</span><span class="p">:</span> <span class="n">self</span><span class="p">.</span><span class="nf">generate_recommendations</span><span class="p">(</span><span class="n">spof_list</span><span class="p">)</span>
        <span class="p">}</span>
        
        <span class="k">return</span> <span class="n">report</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="k">if</span> <span class="nf">len</span><span class="p">(</span><span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
        <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Usage: python3 spof_detector.py &lt;network_range&gt;</span><span class="sh">"</span><span class="p">)</span>
        <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Example: python3 spof_detector.py 192.168.1.0/24</span><span class="sh">"</span><span class="p">)</span>
        <span class="n">sys</span><span class="p">.</span><span class="nf">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    
    <span class="n">network_range</span> <span class="o">=</span> <span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">detector</span> <span class="o">=</span> <span class="nc">SPOFDetector</span><span class="p">()</span>
    
    <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Starting SPOF detection...</span><span class="sh">"</span><span class="p">)</span>
    <span class="n">spof_list</span> <span class="o">=</span> <span class="n">detector</span><span class="p">.</span><span class="nf">scan_network_topology</span><span class="p">(</span><span class="n">network_range</span><span class="p">)</span>
    
    <span class="n">report</span> <span class="o">=</span> <span class="n">detector</span><span class="p">.</span><span class="nf">generate_report</span><span class="p">(</span><span class="n">spof_list</span><span class="p">)</span>
    
    <span class="c1"># JSON í˜•íƒœë¡œ ê²°ê³¼ ì¶œë ¥
</span>    <span class="nf">print</span><span class="p">(</span><span class="n">json</span><span class="p">.</span><span class="nf">dumps</span><span class="p">(</span><span class="n">report</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
    
    <span class="c1"># ìš”ì•½ ì¶œë ¥
</span>    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="se">\n</span><span class="s">=== SPOF Detection Summary ===</span><span class="sh">"</span><span class="p">)</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Total devices scanned: </span><span class="si">{</span><span class="n">report</span><span class="p">[</span><span class="sh">'</span><span class="s">total_devices</span><span class="sh">'</span><span class="p">]</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">SPOF issues found: </span><span class="si">{</span><span class="n">report</span><span class="p">[</span><span class="sh">'</span><span class="s">total_spof_issues</span><span class="sh">'</span><span class="p">]</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Critical issues: </span><span class="si">{</span><span class="n">report</span><span class="p">[</span><span class="sh">'</span><span class="s">critical_issues</span><span class="sh">'</span><span class="p">]</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">High risk issues: </span><span class="si">{</span><span class="n">report</span><span class="p">[</span><span class="sh">'</span><span class="s">high_issues</span><span class="sh">'</span><span class="p">]</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="sh">"</span><span class="s">__main__</span><span class="sh">"</span><span class="p">:</span>
    <span class="nf">main</span><span class="p">()</span>
</code></pre></div></div>

<h4 id="ansibleì„-ì´ìš©í•œ-spof-ì ê²€-ìë™í™”">Ansibleì„ ì´ìš©í•œ SPOF ì ê²€ ìë™í™”</h4>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nn">---</span>
<span class="c1"># spof_check.yml - SPOF ì ê²€ í”Œë ˆì´ë¶</span>
<span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Network SPOF Assessment</span>
  <span class="na">hosts</span><span class="pi">:</span> <span class="s">network_devices</span>
  <span class="na">gather_facts</span><span class="pi">:</span> <span class="s">no</span>
  <span class="na">vars</span><span class="pi">:</span>
    <span class="na">spof_report</span><span class="pi">:</span> <span class="pi">[]</span>
    
  <span class="na">tasks</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Check device redundancy status</span>
      <span class="na">ios_command</span><span class="pi">:</span>
        <span class="na">commands</span><span class="pi">:</span>
          <span class="pi">-</span> <span class="s">show redundancy</span>
          <span class="pi">-</span> <span class="s">show environment power</span>
          <span class="pi">-</span> <span class="s">show interface summary</span>
          <span class="pi">-</span> <span class="s">show spanning-tree root</span>
          <span class="pi">-</span> <span class="s">show etherchannel summary</span>
      <span class="na">register</span><span class="pi">:</span> <span class="s">device_status</span>
      
    <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Analyze redundancy configuration</span>
      <span class="na">set_fact</span><span class="pi">:</span>
        <span class="na">redundancy_analysis</span><span class="pi">:</span> <span class="s2">"</span><span class="s">"</span>
        
    <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Check for single uplinks</span>
      <span class="na">ios_command</span><span class="pi">:</span>
        <span class="na">commands</span><span class="pi">:</span>
          <span class="pi">-</span> <span class="s">show cdp neighbors</span>
          <span class="pi">-</span> <span class="s">show interface trunk</span>
      <span class="na">register</span><span class="pi">:</span> <span class="s">uplink_status</span>
      
    <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Identify SPOF risks</span>
      <span class="na">set_fact</span><span class="pi">:</span>
        <span class="na">spof_risks</span><span class="pi">:</span> <span class="s2">"</span><span class="s">"</span>
      <span class="na">loop</span><span class="pi">:</span>
        <span class="pi">-</span> <span class="s2">"</span><span class="s">Single</span><span class="nv"> </span><span class="s">uplink</span><span class="nv"> </span><span class="s">detected"</span>
        <span class="pi">-</span> <span class="s2">"</span><span class="s">No</span><span class="nv"> </span><span class="s">redundant</span><span class="nv"> </span><span class="s">power"</span>
        <span class="pi">-</span> <span class="s2">"</span><span class="s">No</span><span class="nv"> </span><span class="s">EtherChannel"</span>
      <span class="na">vars</span><span class="pi">:</span>
        <span class="na">uplink_count</span><span class="pi">:</span> <span class="s2">"</span><span class="s">"</span>
        <span class="na">power_supplies</span><span class="pi">:</span> <span class="s2">"</span><span class="s">"</span>
        <span class="na">etherchannel_count</span><span class="pi">:</span> <span class="s2">"</span><span class="s">"</span>
        
    <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Generate SPOF report</span>
      <span class="na">template</span><span class="pi">:</span>
        <span class="na">src</span><span class="pi">:</span> <span class="s">spof_report.j2</span>
        <span class="na">dest</span><span class="pi">:</span> <span class="s2">"</span><span class="s">/tmp/spof_report_.html"</span>
      <span class="na">vars</span><span class="pi">:</span>
        <span class="na">device_name</span><span class="pi">:</span> <span class="s2">"</span><span class="s">"</span>
        <span class="na">check_date</span><span class="pi">:</span> <span class="s2">"</span><span class="s">"</span>
        
    <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Send SPOF alert if critical issues found</span>
      <span class="na">mail</span><span class="pi">:</span>
        <span class="na">to</span><span class="pi">:</span> <span class="s2">"</span><span class="s">"</span>
        <span class="na">subject</span><span class="pi">:</span> <span class="s2">"</span><span class="s">CRITICAL:</span><span class="nv"> </span><span class="s">SPOF</span><span class="nv"> </span><span class="s">detected</span><span class="nv"> </span><span class="s">on</span><span class="nv"> </span><span class="s">"</span>
        <span class="na">body</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Critical</span><span class="nv"> </span><span class="s">single</span><span class="nv"> </span><span class="s">points</span><span class="nv"> </span><span class="s">of</span><span class="nv"> </span><span class="s">failure</span><span class="nv"> </span><span class="s">detected.</span><span class="nv"> </span><span class="s">See</span><span class="nv"> </span><span class="s">attached</span><span class="nv"> </span><span class="s">report."</span>
        <span class="na">attach</span><span class="pi">:</span> <span class="s2">"</span><span class="s">/tmp/spof_report_.html"</span>
      <span class="na">when</span><span class="pi">:</span> <span class="s2">"</span><span class="s">'Single</span><span class="nv"> </span><span class="s">uplink</span><span class="nv"> </span><span class="s">detected'</span><span class="nv"> </span><span class="s">in</span><span class="nv"> </span><span class="s">spof_risks</span><span class="nv"> </span><span class="s">or</span><span class="nv"> </span><span class="s">'No</span><span class="nv"> </span><span class="s">redundant</span><span class="nv"> </span><span class="s">power'</span><span class="nv"> </span><span class="s">in</span><span class="nv"> </span><span class="s">spof_risks"</span>
</code></pre></div></div>

<h4 id="ë„¤íŠ¸ì›Œí¬-í† í´ë¡œì§€-ì‹œê°í™”">ë„¤íŠ¸ì›Œí¬ í† í´ë¡œì§€ ì‹œê°í™”</h4>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Graphvizë¥¼ ì´ìš©í•œ ë„¤íŠ¸ì›Œí¬ í† í´ë¡œì§€ ìƒì„±</span>
<span class="c">#!/bin/bash</span>
<span class="c"># generate_network_topology.sh</span>

<span class="c"># SNMPë¥¼ í†µí•œ ë„¤íŠ¸ì›Œí¬ ë§µ ìƒì„±</span>
generate_dot_file<span class="o">()</span> <span class="o">{</span>
    <span class="nb">echo</span> <span class="s2">"digraph network {"</span> <span class="o">&gt;</span> network.dot
    <span class="nb">echo</span> <span class="s2">"  rankdir=TB;"</span> <span class="o">&gt;&gt;</span> network.dot
    <span class="nb">echo</span> <span class="s2">"  node [shape=box];"</span> <span class="o">&gt;&gt;</span> network.dot
    
    <span class="c"># ê° ì¥ë¹„ ì •ë³´ ìˆ˜ì§‘</span>
    <span class="k">for </span>ip <span class="k">in</span> <span class="si">$(</span>nmap <span class="nt">-sn</span> 192.168.1.0/24 | <span class="nb">grep</span> <span class="s2">"Nmap scan report"</span> | <span class="nb">awk</span> <span class="s1">'{print $5}'</span><span class="si">)</span><span class="p">;</span> <span class="k">do
        </span><span class="nv">device_name</span><span class="o">=</span><span class="si">$(</span>snmpget <span class="nt">-v2c</span> <span class="nt">-c</span> public <span class="nv">$ip</span> 1.3.6.1.2.1.1.5.0 2&gt;/dev/null | <span class="nb">cut</span> <span class="nt">-d</span><span class="s1">'"'</span> <span class="nt">-f2</span><span class="si">)</span>
        <span class="k">if</span> <span class="o">[</span> <span class="o">!</span> <span class="nt">-z</span> <span class="s2">"</span><span class="nv">$device_name</span><span class="s2">"</span> <span class="o">]</span><span class="p">;</span> <span class="k">then
            </span><span class="nb">echo</span> <span class="s2">"  </span><span class="se">\"</span><span class="nv">$device_name</span><span class="se">\"</span><span class="s2"> [label=</span><span class="se">\"</span><span class="nv">$device_name</span><span class="se">\\</span><span class="s2">n</span><span class="nv">$ip</span><span class="se">\"</span><span class="s2">];"</span> <span class="o">&gt;&gt;</span> network.dot
            
            <span class="c"># CDP ì •ë³´ë¡œ ì—°ê²° ê´€ê³„ í™•ì¸</span>
            <span class="nv">cdp_neighbors</span><span class="o">=</span><span class="si">$(</span>snmpwalk <span class="nt">-v2c</span> <span class="nt">-c</span> public <span class="nv">$ip</span> 1.3.6.1.4.1.9.9.23.1.2.1.1.6 2&gt;/dev/null<span class="si">)</span>
            <span class="k">while </span><span class="nb">read</span> <span class="nt">-r</span> neighbor<span class="p">;</span> <span class="k">do
                </span><span class="nv">neighbor_name</span><span class="o">=</span><span class="si">$(</span><span class="nb">echo</span> <span class="nv">$neighbor</span> | <span class="nb">cut</span> <span class="nt">-d</span><span class="s1">'"'</span> <span class="nt">-f2</span><span class="si">)</span>
                <span class="k">if</span> <span class="o">[</span> <span class="o">!</span> <span class="nt">-z</span> <span class="s2">"</span><span class="nv">$neighbor_name</span><span class="s2">"</span> <span class="o">]</span><span class="p">;</span> <span class="k">then
                    </span><span class="nb">echo</span> <span class="s2">"  </span><span class="se">\"</span><span class="nv">$device_name</span><span class="se">\"</span><span class="s2"> -&gt; </span><span class="se">\"</span><span class="nv">$neighbor_name</span><span class="se">\"</span><span class="s2">;"</span> <span class="o">&gt;&gt;</span> network.dot
                <span class="k">fi
            done</span> <span class="o">&lt;&lt;&lt;</span> <span class="s2">"</span><span class="nv">$cdp_neighbors</span><span class="s2">"</span>
        <span class="k">fi
    done
    
    </span><span class="nb">echo</span> <span class="s2">"}"</span> <span class="o">&gt;&gt;</span> network.dot
<span class="o">}</span>

<span class="c"># DOT íŒŒì¼ì„ ì´ë¯¸ì§€ë¡œ ë³€í™˜</span>
generate_dot_file
dot <span class="nt">-Tpng</span> network.dot <span class="nt">-o</span> network_topology.png
dot <span class="nt">-Tsvg</span> network.dot <span class="nt">-o</span> network_topology.svg

<span class="nb">echo</span> <span class="s2">"Network topology generated: network_topology.png"</span>

<span class="c"># SPOF í•˜ì´ë¼ì´íŠ¸ ë²„ì „ ìƒì„±</span>
<span class="nb">sed</span> <span class="s1">'s/node \[shape=box\];/node [shape=box]; edge [color=red, penwidth=3];/'</span> network.dot <span class="o">&gt;</span> network_spof.dot
dot <span class="nt">-Tpng</span> network_spof.dot <span class="nt">-o</span> network_spof.png

<span class="nb">echo</span> <span class="s2">"SPOF highlighted topology: network_spof.png"</span>
</code></pre></div></div>

<h4 id="ì‹¤ì‹œê°„-spof-ëª¨ë‹ˆí„°ë§">ì‹¤ì‹œê°„ SPOF ëª¨ë‹ˆí„°ë§</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># spof_monitor.py - ì‹¤ì‹œê°„ SPOF ëª¨ë‹ˆí„°ë§
</span><span class="kn">import</span> <span class="n">time</span>
<span class="kn">import</span> <span class="n">threading</span>
<span class="kn">import</span> <span class="n">logging</span>
<span class="kn">from</span> <span class="n">prometheus_client</span> <span class="kn">import</span> <span class="n">start_http_server</span><span class="p">,</span> <span class="n">Gauge</span><span class="p">,</span> <span class="n">Counter</span>

<span class="k">class</span> <span class="nc">SPOFMonitor</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">spof_gauge</span> <span class="o">=</span> <span class="nc">Gauge</span><span class="p">(</span><span class="sh">'</span><span class="s">network_spof_count</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Number of detected SPOFs</span><span class="sh">'</span><span class="p">)</span>
        <span class="n">self</span><span class="p">.</span><span class="n">link_status_gauge</span> <span class="o">=</span> <span class="nc">Gauge</span><span class="p">(</span><span class="sh">'</span><span class="s">network_link_status</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Link status</span><span class="sh">'</span><span class="p">,</span> <span class="p">[</span><span class="sh">'</span><span class="s">device</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">interface</span><span class="sh">'</span><span class="p">])</span>
        <span class="n">self</span><span class="p">.</span><span class="n">spof_alert_counter</span> <span class="o">=</span> <span class="nc">Counter</span><span class="p">(</span><span class="sh">'</span><span class="s">network_spof_alerts_total</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Total SPOF alerts</span><span class="sh">'</span><span class="p">)</span>
        
        <span class="n">logging</span><span class="p">.</span><span class="nf">basicConfig</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="p">.</span><span class="n">INFO</span><span class="p">)</span>
        <span class="n">self</span><span class="p">.</span><span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="p">.</span><span class="nf">getLogger</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>
        
    <span class="k">def</span> <span class="nf">monitor_links</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ë§í¬ ìƒíƒœ ëª¨ë‹ˆí„°ë§</span><span class="sh">"""</span>
        <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">devices</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">get_monitored_devices</span><span class="p">()</span>
                
                <span class="k">for</span> <span class="n">device</span> <span class="ow">in</span> <span class="n">devices</span><span class="p">:</span>
                    <span class="n">interfaces</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">get_device_interfaces</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
                    
                    <span class="k">for</span> <span class="n">interface</span> <span class="ow">in</span> <span class="n">interfaces</span><span class="p">:</span>
                        <span class="n">status</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">check_interface_status</span><span class="p">(</span><span class="n">device</span><span class="p">,</span> <span class="n">interface</span><span class="p">)</span>
                        <span class="n">self</span><span class="p">.</span><span class="n">link_status_gauge</span><span class="p">.</span><span class="nf">labels</span><span class="p">(</span>
                            <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">[</span><span class="sh">'</span><span class="s">name</span><span class="sh">'</span><span class="p">],</span> 
                            <span class="n">interface</span><span class="o">=</span><span class="n">interface</span>
                        <span class="p">).</span><span class="nf">set</span><span class="p">(</span><span class="mi">1</span> <span class="k">if</span> <span class="n">status</span> <span class="o">==</span> <span class="sh">'</span><span class="s">up</span><span class="sh">'</span> <span class="k">else</span> <span class="mi">0</span><span class="p">)</span>
                        
                        <span class="k">if</span> <span class="n">status</span> <span class="o">==</span> <span class="sh">'</span><span class="s">down</span><span class="sh">'</span><span class="p">:</span>
                            <span class="n">self</span><span class="p">.</span><span class="nf">check_spof_impact</span><span class="p">(</span><span class="n">device</span><span class="p">,</span> <span class="n">interface</span><span class="p">)</span>
                
                <span class="n">time</span><span class="p">.</span><span class="nf">sleep</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span>  <span class="c1"># 30ì´ˆë§ˆë‹¤ ì²´í¬
</span>                
            <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="n">self</span><span class="p">.</span><span class="n">logger</span><span class="p">.</span><span class="nf">error</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Monitoring error: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
                <span class="n">time</span><span class="p">.</span><span class="nf">sleep</span><span class="p">(</span><span class="mi">60</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">check_spof_impact</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">device</span><span class="p">,</span> <span class="n">failed_interface</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ì¥ì•  ë°œìƒ ì‹œ SPOF ì˜í–¥ ë¶„ì„</span><span class="sh">"""</span>
        <span class="n">remaining_paths</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">calculate_remaining_paths</span><span class="p">(</span><span class="n">device</span><span class="p">,</span> <span class="n">failed_interface</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">remaining_paths</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">self</span><span class="p">.</span><span class="n">logger</span><span class="p">.</span><span class="nf">critical</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">SPOF ALERT: </span><span class="si">{</span><span class="n">device</span><span class="p">[</span><span class="sh">'</span><span class="s">name</span><span class="sh">'</span><span class="p">]</span><span class="si">}</span><span class="s"> </span><span class="si">{</span><span class="n">failed_interface</span><span class="si">}</span><span class="s"> failure causes network partition</span><span class="sh">"</span><span class="p">)</span>
            <span class="n">self</span><span class="p">.</span><span class="n">spof_alert_counter</span><span class="p">.</span><span class="nf">inc</span><span class="p">()</span>
            <span class="n">self</span><span class="p">.</span><span class="nf">send_alert</span><span class="p">(</span><span class="n">device</span><span class="p">,</span> <span class="n">failed_interface</span><span class="p">,</span> <span class="sh">'</span><span class="s">SPOF_CRITICAL</span><span class="sh">'</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">remaining_paths</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">self</span><span class="p">.</span><span class="n">logger</span><span class="p">.</span><span class="nf">warning</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">SPOF WARNING: </span><span class="si">{</span><span class="n">device</span><span class="p">[</span><span class="sh">'</span><span class="s">name</span><span class="sh">'</span><span class="p">]</span><span class="si">}</span><span class="s"> </span><span class="si">{</span><span class="n">failed_interface</span><span class="si">}</span><span class="s"> creates single path</span><span class="sh">"</span><span class="p">)</span>
            <span class="n">self</span><span class="p">.</span><span class="nf">send_alert</span><span class="p">(</span><span class="n">device</span><span class="p">,</span> <span class="n">failed_interface</span><span class="p">,</span> <span class="sh">'</span><span class="s">SPOF_WARNING</span><span class="sh">'</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">start_monitoring</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ëª¨ë‹ˆí„°ë§ ì‹œì‘</span><span class="sh">"""</span>
        <span class="c1"># Prometheus ë©”íŠ¸ë¦­ ì„œë²„ ì‹œì‘
</span>        <span class="nf">start_http_server</span><span class="p">(</span><span class="mi">8000</span><span class="p">)</span>
        
        <span class="c1"># ë§í¬ ëª¨ë‹ˆí„°ë§ ì“°ë ˆë“œ ì‹œì‘
</span>        <span class="n">monitor_thread</span> <span class="o">=</span> <span class="n">threading</span><span class="p">.</span><span class="nc">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">self</span><span class="p">.</span><span class="n">monitor_links</span><span class="p">)</span>
        <span class="n">monitor_thread</span><span class="p">.</span><span class="n">daemon</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="n">monitor_thread</span><span class="p">.</span><span class="nf">start</span><span class="p">()</span>
        
        <span class="n">self</span><span class="p">.</span><span class="n">logger</span><span class="p">.</span><span class="nf">info</span><span class="p">(</span><span class="sh">"</span><span class="s">SPOF monitoring started on port 8000</span><span class="sh">"</span><span class="p">)</span>
        
        <span class="c1"># ë©”ì¸ ë£¨í”„
</span>        <span class="k">try</span><span class="p">:</span>
            <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
                <span class="n">time</span><span class="p">.</span><span class="nf">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">except</span> <span class="nb">KeyboardInterrupt</span><span class="p">:</span>
            <span class="n">self</span><span class="p">.</span><span class="n">logger</span><span class="p">.</span><span class="nf">info</span><span class="p">(</span><span class="sh">"</span><span class="s">Monitoring stopped</span><span class="sh">"</span><span class="p">)</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="sh">"</span><span class="s">__main__</span><span class="sh">"</span><span class="p">:</span>
    <span class="n">monitor</span> <span class="o">=</span> <span class="nc">SPOFMonitor</span><span class="p">()</span>
    <span class="n">monitor</span><span class="p">.</span><span class="nf">start_monitoring</span><span class="p">()</span>
</code></pre></div></div>

<h4 id="spof-ì œê±°-ìš°ì„ ìˆœìœ„-ë§¤íŠ¸ë¦­ìŠ¤">SPOF ì œê±° ìš°ì„ ìˆœìœ„ ë§¤íŠ¸ë¦­ìŠ¤</h4>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># SPOF ìœ„í—˜ë„ í‰ê°€ ë§¤íŠ¸ë¦­ìŠ¤</span>
ìœ„í—˜ë„ <span class="o">=</span> <span class="o">(</span>ì˜í–¥ë„ Ã— ë°œìƒê°€ëŠ¥ì„±<span class="o">)</span> / ëŒ€ì‘ì‹œê°„

ì˜í–¥ë„ ì ìˆ˜:
- ì „ì²´ ë„¤íŠ¸ì›Œí¬ ë‹¨ì ˆ: 10
- ë¶€ë¶„ ë„¤íŠ¸ì›Œí¬ ë‹¨ì ˆ: 7  
- ì„±ëŠ¥ ì €í•˜: 4
- ì¼ë¶€ ì„œë¹„ìŠ¤ ì˜í–¥: 2

ë°œìƒê°€ëŠ¥ì„± ì ìˆ˜:
- ë§¤ìš° ë†’ìŒ <span class="o">(</span>ì›” 1íšŒ ì´ìƒ<span class="o">)</span>: 10
- ë†’ìŒ <span class="o">(</span>ë¶„ê¸° 1íšŒ<span class="o">)</span>: 7
- ë³´í†µ <span class="o">(</span>ì—° 2-3íšŒ<span class="o">)</span>: 4  
- ë‚®ìŒ <span class="o">(</span>ì—° 1íšŒ ì´í•˜<span class="o">)</span>: 2

ëŒ€ì‘ì‹œê°„ ì ìˆ˜:
- 4ì‹œê°„ ì´ìƒ: 1
- 2-4ì‹œê°„: 2
- 1-2ì‹œê°„: 4
- 1ì‹œê°„ ì´í•˜: 7

<span class="c"># ìš°ì„ ìˆœìœ„ ê²°ì •</span>
ìš°ì„ ìˆœìœ„ 1 <span class="o">(</span>ì¦‰ì‹œ<span class="o">)</span>: ìœ„í—˜ë„ <span class="o">&gt;</span> 35
ìš°ì„ ìˆœìœ„ 2 <span class="o">(</span>1ê°œì›”<span class="o">)</span>: ìœ„í—˜ë„ 20-35
ìš°ì„ ìˆœìœ„ 3 <span class="o">(</span>3ê°œì›”<span class="o">)</span>: ìœ„í—˜ë„ 10-20  
ìš°ì„ ìˆœìœ„ 4 <span class="o">(</span>1ë…„<span class="o">)</span>: ìœ„í—˜ë„ &lt; 10
</code></pre></div></div>

  </div>

  <footer class="post-footer">
    <div class="post-navigation"><div class="nav-previous">
        <a href="/infra-blog/blog/2024/10/26/linux-security-guide-part1.html" rel="prev">
          <i class="icon-left-arrow"></i>
          <span class="nav-title">ë¦¬ëˆ…ìŠ¤ ë³´ì•ˆ ì™„ì „ ê°€ì´ë“œ 1í¸ - ê¸°ì´ˆ ë³´ì•ˆ ì„¤ì • | Linux Security Gu...</span>
        </a>
      </div><div class="nav-next">
        <a href="/infra-blog/blog/2024/11/04/deployment-strategies-guide.html" rel="next">
          <span class="nav-title">ë°°í¬ ì „ëµ ì™„ì „ ê°€ì´ë“œ | Complete Deployment Strategies G...</span>
          <i class="icon-right-arrow"></i>
        </a>
      </div></div>
  </footer>
  </article></div>

    </section>
    <footer class="condensed">
      <ul class="social about-footer condensed"><a href="https://github.com/leeyonghe" target="_blank">
          <li>
            <i class="icon-github-circled"></i>
          </li>
        </a><a href="https://www.linkedin.com/in/lee-yong-hee-18912454/" target="_blank">
          <li>
            <i class="icon-linkedin-squared"></i>
          </li>
        </a><!----></ul><p class="about-footer condensed">&copy;
        2025</p><div class="about-footer condensed">
        <p>Dark Mode
          <i class="icon-moon"></i>
          <label class="switch">
            <input type="checkbox" class="dark-mode-toggle">
            <span class="slider round" onclick="toggleDarkMode()"></span>
          </label>
        </p>
      </div>
    </footer>
  </main>
  
  <script type="text/javascript" src="/infra-blog/assets/js/darkmode.js"></script>
  
  <script src="/infra-blog/assets/js/simple-jekyll-search.min.js"></script>
  <script src="/infra-blog/assets/js/search.js"></script>
  
</body>

</html>
