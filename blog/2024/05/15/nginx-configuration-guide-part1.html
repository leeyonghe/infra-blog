<!DOCTYPE html>
<html lang="en">

<head><meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<link href="https://fonts.googleapis.com/css?family=Merriweather:300|Raleway:400,700" rel="stylesheet">
<link rel="stylesheet" href="/infra-blog/assets/css/style.css">
<link rel="stylesheet" href="/infra-blog/assets/css/post-detail.css">
<style>
/* Post Detail Page Styling */
.post-container article {
  background: #fff;
  border-radius: 12px;
  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
  padding: 40px;
  margin: 30px auto;
  max-width: 800px;
}

@media screen and (max-width: 768px) {
  .post-container article {
    margin: 20px;
    padding: 25px;
    border-radius: 8px;
  }
}

.post-container article .post-header {
  border-bottom: 2px solid #f5f5f5;
  padding-bottom: 25px;
  margin-bottom: 30px;
}

.post-container article .post-header .post-title {
  font-size: 2.2em;
  font-weight: 700;
  color: #2c3e50;
  line-height: 1.3;
  margin-bottom: 15px;
}

@media screen and (max-width: 768px) {
  .post-container article .post-header .post-title {
    font-size: 1.8em;
  }
}

.post-container article .post-header .post-meta {
  display: flex;
  align-items: center;
  gap: 20px;
  flex-wrap: wrap;
}

.post-container article .post-header .post-meta .post-date {
  display: flex;
  align-items: center;
  color: #666;
  font-size: 0.9em;
}

.post-container article .post-header .post-meta .post-date i {
  margin-right: 8px;
  color: #888;
}

.post-container article .post-header .post-meta .post-categories-wrapper {
  display: flex;
  align-items: center;
}

.post-container article .post-header .post-meta .post-categories-wrapper i {
  margin-right: 8px;
  color: #888;
}

.post-container article .post-header .post-meta .post-categories-wrapper .post-categories {
  display: flex;
  gap: 8px;
  list-style: none;
  margin: 0;
  padding: 0;
}

.post-container article .post-header .post-meta .post-categories-wrapper .post-categories li {
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  color: white;
  padding: 4px 12px;
  border-radius: 20px;
  font-size: 0.8em;
  font-weight: 500;
  text-transform: capitalize;
}

.post-container article .post-content {
  font-size: 1.1em;
  line-height: 1.8;
  color: #333;
}

.post-container article .post-content p {
  margin-bottom: 1.2em;
}

.post-container article .post-content h1,
.post-container article .post-content h2,
.post-container article .post-content h3,
.post-container article .post-content h4,
.post-container article .post-content h5,
.post-container article .post-content h6 {
  color: #2c3e50;
  margin: 1.5em 0 0.8em 0;
  font-weight: 600;
}

.post-container article .post-content h2 {
  font-size: 1.8em;
  border-bottom: 2px solid #3498db;
  padding-bottom: 10px;
}

.post-container article .post-content h3 {
  font-size: 1.5em;
  color: #34495e;
}

.post-container article .post-content code {
  background: #f8f9fa;
  padding: 2px 6px;
  border-radius: 4px;
  font-size: 0.9em;
  color: #e74c3c;
}

.post-container article .post-content pre {
  background: #f8f9fa;
  border: 1px solid #e9ecef;
  border-radius: 6px;
  padding: 15px;
  overflow-x: auto;
  margin: 1.5em 0;
}

.post-container article .post-content pre code {
  background: none;
  color: #333;
  padding: 0;
}

.post-container article .post-content blockquote {
  border-left: 4px solid #3498db;
  background: #f8f9fa;
  padding: 15px 20px;
  margin: 1.5em 0;
  font-style: italic;
  color: #555;
}

.post-container article .post-content img {
  max-width: 100%;
  height: auto;
  border-radius: 8px;
  margin: 1.5em 0;
  box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
}

.post-container article .post-content ul,
.post-container article .post-content ol {
  padding-left: 1.5em;
  margin-bottom: 1.2em;
}

.post-container article .post-content ul li,
.post-container article .post-content ol li {
  margin-bottom: 0.5em;
}

.post-container article .post-content a {
  color: #3498db;
  text-decoration: none;
  border-bottom: 1px solid transparent;
  transition: all 0.3s ease;
}

.post-container article .post-content a:hover {
  border-bottom-color: #3498db;
}

.post-container article .post-footer {
  border-top: 2px solid #f5f5f5;
  padding-top: 25px;
  margin-top: 40px;
}

.post-container article .post-footer .post-navigation {
  display: flex;
  justify-content: space-between;
  align-items: center;
  gap: 20px;
}

@media screen and (max-width: 768px) {
  .post-container article .post-footer .post-navigation {
    flex-direction: column;
    gap: 15px;
  }
}

.post-container article .post-footer .post-navigation .nav-previous,
.post-container article .post-footer .post-navigation .nav-next {
  flex: 1;
}

.post-container article .post-footer .post-navigation .nav-previous a,
.post-container article .post-footer .post-navigation .nav-next a {
  display: flex;
  align-items: center;
  padding: 15px 20px;
  background: #f8f9fa;
  border-radius: 8px;
  text-decoration: none;
  color: #333;
  transition: all 0.3s ease;
  border: 2px solid transparent;
}

.post-container article .post-footer .post-navigation .nav-previous a:hover,
.post-container article .post-footer .post-navigation .nav-next a:hover {
  background: #e9ecef;
  border-color: #3498db;
  transform: translateY(-2px);
}

.post-container article .post-footer .post-navigation .nav-previous a i,
.post-container article .post-footer .post-navigation .nav-next a i {
  color: #3498db;
  margin: 0 8px;
}

.post-container article .post-footer .post-navigation .nav-previous a .nav-title,
.post-container article .post-footer .post-navigation .nav-next a .nav-title {
  font-weight: 500;
}

.post-container article .post-footer .post-navigation .nav-previous a {
  justify-content: flex-start;
}

.post-container article .post-footer .post-navigation .nav-next a {
  justify-content: flex-end;
  text-align: right;
}
</style>
<title>Nginx 기본 설정 가이드 Part 1 - 설치부터 기본 서버 블록까지</title>

<script type="text/javascript" src="/infra-blog/assets/js/darkmode.js"></script>

</head><body>
  <main class="container">
    <section class="about">
      <div class="about-header condensed">
      <div class="about-title">
      <a href="/infra-blog/">
        
        <img src="/infra-blog/assets/portfolio.png" alt="Infrastructure Engineer" />
        
      </a>
      <h2 id="title">
        <a href="/infra-blog/">Infrastructure Engineer</a>
      </h2>
      </div><p class="tagline">DevOps & Cloud Infrastructure Specialist</p></div>
      
      <ul class="social about-footer condensed"><a href="https://github.com/leeyonghe" target="_blank">
          <li>
            <i class="icon-github-circled"></i>
          </li>
        </a><a href="https://www.linkedin.com/in/lee-yong-hee-18912454/" target="_blank">
          <li>
            <i class="icon-linkedin-squared"></i>
          </li>
        </a><!----></ul><p class="about-footer condensed">&copy;
        2025</p><div class="about-footer condensed">
        <p>Dark Mode
          <i class="icon-moon"></i>
          <label class="switch">
            <input type="checkbox" class="dark-mode-toggle">
            <span class="slider round" onclick="toggleDarkMode()"></span>
          </label>
        </p>
      </div>
    </section>
    <section class="content">
      <style>
/* Post Detail Page Styling - Direct Inline */
.post-container article {
  background: #fff !important;
  border: none !important;
  border-top: none !important;
  border-right: none !important;
  border-bottom: none !important;
  border-left: none !important;
  border-width: 0 !important;
  border-style: none !important;
  outline: none !important;
  border-radius: 12px !important;
  box-shadow: none !important;
  padding: 40px !important;
  margin: 30px auto !important;
  max-width: 800px !important;
}

.post-container article .post-header .post-title {
  font-size: 2.2em !important;
  font-weight: 700 !important;
  color: #2c3e50 !important;
  line-height: 1.3 !important;
}

.post-container article .post-header {
  border-bottom: none !important;
  padding-bottom: 25px !important;
  margin-bottom: 30px !important;
}

.post-container article .post-content {
  font-size: 1.1em !important;
  line-height: 1.8 !important;
  color: #333 !important;
}

.post-container article .post-content h2 {
  font-size: 1.8em !important;
  border-bottom: none !important;
  padding-bottom: 10px !important;
  color: #2c3e50 !important;
}

.post-container article .post-header .post-meta .post-categories li {
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%) !important;
  color: white !important;
  padding: 4px 12px !important;
  border-radius: 20px !important;
  font-size: 0.8em !important;
  list-style: none !important;
  display: inline-block !important;
  margin-right: 8px !important;
}

.post-container article .post-footer {
  border-top: none !important;
  padding-top: 25px !important;
  margin-top: 40px !important;
}

/* 모든 border와 box-shadow 강제 제거 */
.post-container article *,
.post-container article *::before,
.post-container article *::after {
  border: none !important;
  border-top: none !important;
  border-right: none !important;
  border-bottom: none !important;
  border-left: none !important;
  border-width: 0 !important;
  border-style: none !important;
  outline: none !important;
  box-shadow: none !important;
}

/* 코드 블록과 pre 태그도 border, box-shadow 제거 */
.post-container article pre,
.post-container article code,
.post-container article .highlight,
.post-container article .highlighter-rouge {
  border: none !important;
  outline: none !important;
  box-shadow: none !important;
}
</style><div class="post-container">
  <article>
    <header class="post-header">
    <h1 class="post-title">Nginx 기본 설정 가이드 Part 1 - 설치부터 기본 서버 블록까지</h1>
    <div class="post-meta">
      <div class="post-date">
        <i class="icon-calendar"></i>
        <time datetime="2024-05-15T00:00:00+00:00">May 15, 2024</time>
      </div><div class="post-categories-wrapper">
        <i class="icon-tag"></i>
        <ul class="post-categories"><li>Infrastructure</li><li>Nginx</li><li>Configuration</li></ul>
      </div></div>
  </header>

  <div class="post-content">
    <h1 id="nginx-기본-설정-가이드-part-1">Nginx 기본 설정 가이드 Part 1</h1>

<p>Nginx는 높은 성능과 안정성으로 널리 사용되는 웹 서버이자 리버스 프록시입니다. 이 시리즈에서는 Nginx의 설치부터 고급 설정까지 단계별로 다루겠습니다.</p>

<!--more-->

<h2 id="목차">목차</h2>
<ol>
  <li><a href="#nginx-소개">Nginx 소개</a></li>
  <li><a href="#설치">설치</a></li>
  <li><a href="#디렉토리-구조">디렉토리 구조</a></li>
  <li><a href="#설정-파일-구조">설정 파일 구조</a></li>
  <li><a href="#기본-서버-블록-설정">기본 서버 블록 설정</a></li>
  <li><a href="#설정-테스트-및-서비스-관리">설정 테스트 및 서비스 관리</a></li>
</ol>

<h2 id="nginx-소개">Nginx 소개</h2>

<h3 id="특징">특징</h3>
<ul>
  <li><strong>고성능</strong>: 이벤트 기반 비동기 아키텍처</li>
  <li><strong>낮은 메모리 사용량</strong>: 효율적인 리소스 관리</li>
  <li><strong>높은 동시성</strong>: 수천 개의 연결 동시 처리</li>
  <li><strong>모듈식 구조</strong>: 필요한 기능만 선택적 로드</li>
</ul>

<h3 id="주요-용도">주요 용도</h3>
<ul>
  <li>정적 파일 서빙</li>
  <li>리버스 프록시</li>
  <li>로드 밸런서</li>
  <li>HTTP 캐시</li>
  <li>API 게이트웨이</li>
</ul>

<h2 id="설치">설치</h2>

<h3 id="ubuntudebian">Ubuntu/Debian</h3>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># 패키지 업데이트</span>
<span class="nb">sudo </span>apt update

<span class="c"># Nginx 설치</span>
<span class="nb">sudo </span>apt <span class="nb">install </span>nginx

<span class="c"># 서비스 시작 및 자동 시작 설정</span>
<span class="nb">sudo </span>systemctl start nginx
<span class="nb">sudo </span>systemctl <span class="nb">enable </span>nginx
</code></pre></div></div>

<h3 id="centosrhel">CentOS/RHEL</h3>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># EPEL 저장소 설치 (CentOS 7)</span>
<span class="nb">sudo </span>yum <span class="nb">install </span>epel-release

<span class="c"># Nginx 설치</span>
<span class="nb">sudo </span>yum <span class="nb">install </span>nginx

<span class="c"># 서비스 시작 및 자동 시작 설정</span>
<span class="nb">sudo </span>systemctl start nginx
<span class="nb">sudo </span>systemctl <span class="nb">enable </span>nginx

<span class="c"># 방화벽 설정</span>
<span class="nb">sudo </span>firewall-cmd <span class="nt">--permanent</span> <span class="nt">--zone</span><span class="o">=</span>public <span class="nt">--add-service</span><span class="o">=</span>http
<span class="nb">sudo </span>firewall-cmd <span class="nt">--permanent</span> <span class="nt">--zone</span><span class="o">=</span>public <span class="nt">--add-service</span><span class="o">=</span>https
<span class="nb">sudo </span>firewall-cmd <span class="nt">--reload</span>
</code></pre></div></div>

<h3 id="소스-컴파일-설치">소스 컴파일 설치</h3>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># 의존성 설치</span>
<span class="nb">sudo </span>apt <span class="nb">install </span>build-essential libpcre3-dev libssl-dev zlib1g-dev

<span class="c"># 소스 다운로드</span>
wget http://nginx.org/download/nginx-1.24.0.tar.gz
<span class="nb">tar</span> <span class="nt">-zxvf</span> nginx-1.24.0.tar.gz
<span class="nb">cd </span>nginx-1.24.0

<span class="c"># 컴파일 옵션 설정</span>
./configure <span class="se">\</span>
    <span class="nt">--prefix</span><span class="o">=</span>/etc/nginx <span class="se">\</span>
    <span class="nt">--sbin-path</span><span class="o">=</span>/usr/sbin/nginx <span class="se">\</span>
    <span class="nt">--conf-path</span><span class="o">=</span>/etc/nginx/nginx.conf <span class="se">\</span>
    <span class="nt">--error-log-path</span><span class="o">=</span>/var/log/nginx/error.log <span class="se">\</span>
    <span class="nt">--http-log-path</span><span class="o">=</span>/var/log/nginx/access.log <span class="se">\</span>
    <span class="nt">--pid-path</span><span class="o">=</span>/var/run/nginx.pid <span class="se">\</span>
    <span class="nt">--lock-path</span><span class="o">=</span>/var/run/nginx.lock <span class="se">\</span>
    <span class="nt">--with-http_ssl_module</span> <span class="se">\</span>
    <span class="nt">--with-http_v2_module</span> <span class="se">\</span>
    <span class="nt">--with-http_realip_module</span> <span class="se">\</span>
    <span class="nt">--with-http_gzip_static_module</span>

<span class="c"># 컴파일 및 설치</span>
make
<span class="nb">sudo </span>make <span class="nb">install</span>
</code></pre></div></div>

<h2 id="디렉토리-구조">디렉토리 구조</h2>

<h3 id="주요-디렉토리">주요 디렉토리</h3>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/etc/nginx/                 # 설정 파일 디렉토리
├── nginx.conf             # 메인 설정 파일
├── mime.types             # MIME 타입 정의
├── conf.d/                # 추가 설정 파일들
├── sites-available/       # 사용 가능한 사이트 설정 (Ubuntu/Debian)
├── sites-enabled/         # 활성화된 사이트 설정 (Ubuntu/Debian)
└── modules-enabled/       # 활성화된 모듈들

/var/log/nginx/            # 로그 디렉토리
├── access.log             # 접근 로그
└── error.log              # 에러 로그

/var/www/html/             # 기본 웹 루트 디렉토리
/usr/share/nginx/html/     # CentOS/RHEL 기본 웹 루트

/var/run/nginx.pid         # PID 파일
</code></pre></div></div>

<h2 id="설정-파일-구조">설정 파일 구조</h2>

<h3 id="nginxconf-기본-구조">nginx.conf 기본 구조</h3>
<div class="language-nginx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># 전역 컨텍스트</span>
<span class="k">user</span> <span class="s">nginx</span><span class="p">;</span>
<span class="k">worker_processes</span> <span class="s">auto</span><span class="p">;</span>
<span class="k">error_log</span> <span class="n">/var/log/nginx/error.log</span><span class="p">;</span>
<span class="k">pid</span> <span class="n">/run/nginx.pid</span><span class="p">;</span>

<span class="c1"># 이벤트 컨텍스트</span>
<span class="k">events</span> <span class="p">{</span>
    <span class="kn">worker_connections</span> <span class="mi">1024</span><span class="p">;</span>
    <span class="kn">use</span> <span class="s">epoll</span><span class="p">;</span>
    <span class="kn">multi_accept</span> <span class="no">on</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1"># HTTP 컨텍스트</span>
<span class="k">http</span> <span class="p">{</span>
    <span class="c1"># 기본 설정</span>
    <span class="kn">include</span> <span class="n">/etc/nginx/mime.types</span><span class="p">;</span>
    <span class="kn">default_type</span> <span class="nc">application/octet-stream</span><span class="p">;</span>
    
    <span class="c1"># 로그 형식</span>
    <span class="kn">log_format</span> <span class="s">main</span> <span class="s">'</span><span class="nv">$remote_addr</span> <span class="s">-</span> <span class="nv">$remote_user</span> <span class="s">[</span><span class="nv">$time_local</span><span class="s">]</span> <span class="s">"</span><span class="nv">$request</span><span class="s">"</span> <span class="s">'</span>
                    <span class="s">'</span><span class="nv">$status</span> <span class="nv">$body_bytes_sent</span> <span class="s">"</span><span class="nv">$http_referer</span><span class="s">"</span> <span class="s">'</span>
                    <span class="s">'"</span><span class="nv">$http_user_agent</span><span class="s">"</span> <span class="s">"</span><span class="nv">$http_x_forwarded_for</span><span class="s">"'</span><span class="p">;</span>
    
    <span class="kn">access_log</span> <span class="n">/var/log/nginx/access.log</span> <span class="s">main</span><span class="p">;</span>
    
    <span class="c1"># 성능 최적화</span>
    <span class="kn">sendfile</span> <span class="no">on</span><span class="p">;</span>
    <span class="kn">tcp_nopush</span> <span class="no">on</span><span class="p">;</span>
    <span class="kn">tcp_nodelay</span> <span class="no">on</span><span class="p">;</span>
    <span class="kn">keepalive_timeout</span> <span class="mi">65</span><span class="p">;</span>
    <span class="kn">types_hash_max_size</span> <span class="mi">2048</span><span class="p">;</span>
    
    <span class="c1"># 서버 블록들</span>
    <span class="kn">include</span> <span class="n">/etc/nginx/conf.d/*.conf</span><span class="p">;</span>
    <span class="kn">include</span> <span class="n">/etc/nginx/sites-enabled/*</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="컨텍스트-계층">컨텍스트 계층</h3>
<ol>
  <li><strong>Main Context</strong>: 전역 설정</li>
  <li><strong>Events Context</strong>: 연결 처리 설정</li>
  <li><strong>HTTP Context</strong>: HTTP 관련 설정</li>
  <li><strong>Server Context</strong>: 가상 호스트 설정</li>
  <li><strong>Location Context</strong>: 특정 URI 처리</li>
</ol>

<h2 id="기본-서버-블록-설정">기본 서버 블록 설정</h2>

<h3 id="기본-웹사이트-설정">기본 웹사이트 설정</h3>
<div class="language-nginx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># /etc/nginx/sites-available/default</span>
<span class="k">server</span> <span class="p">{</span>
    <span class="kn">listen</span> <span class="mi">80</span> <span class="s">default_server</span><span class="p">;</span>
    <span class="kn">listen</span> <span class="s">[::]:80</span> <span class="s">default_server</span><span class="p">;</span>
    
    <span class="kn">server_name</span> <span class="s">_</span><span class="p">;</span>
    <span class="kn">root</span> <span class="n">/var/www/html</span><span class="p">;</span>
    <span class="kn">index</span> <span class="s">index.html</span> <span class="s">index.htm</span> <span class="s">index.nginx-debian.html</span><span class="p">;</span>
    
    <span class="c1"># 기본 location</span>
    <span class="kn">location</span> <span class="n">/</span> <span class="p">{</span>
        <span class="kn">try_files</span> <span class="nv">$uri</span> <span class="nv">$uri</span><span class="n">/</span> <span class="p">=</span><span class="mi">404</span><span class="p">;</span>
    <span class="p">}</span>
    
    <span class="c1"># 에러 페이지</span>
    <span class="kn">error_page</span> <span class="mi">404</span> <span class="n">/404.html</span><span class="p">;</span>
    <span class="kn">error_page</span> <span class="mi">500</span> <span class="mi">502</span> <span class="mi">503</span> <span class="mi">504</span> <span class="n">/50x.html</span><span class="p">;</span>
    
    <span class="kn">location</span> <span class="p">=</span> <span class="n">/50x.html</span> <span class="p">{</span>
        <span class="kn">root</span> <span class="n">/usr/share/nginx/html</span><span class="p">;</span>
    <span class="p">}</span>
    
    <span class="c1"># 로그 설정</span>
    <span class="kn">access_log</span> <span class="n">/var/log/nginx/access.log</span><span class="p">;</span>
    <span class="kn">error_log</span> <span class="n">/var/log/nginx/error.log</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="커스텀-사이트-설정">커스텀 사이트 설정</h3>
<div class="language-nginx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># /etc/nginx/sites-available/example.com</span>
<span class="k">server</span> <span class="p">{</span>
    <span class="kn">listen</span> <span class="mi">80</span><span class="p">;</span>
    <span class="kn">server_name</span> <span class="s">example.com</span> <span class="s">www.example.com</span><span class="p">;</span>
    <span class="kn">root</span> <span class="n">/var/www/example.com</span><span class="p">;</span>
    <span class="kn">index</span> <span class="s">index.html</span> <span class="s">index.php</span><span class="p">;</span>
    
    <span class="c1"># 보안 헤더</span>
    <span class="kn">add_header</span> <span class="s">X-Frame-Options</span> <span class="s">"SAMEORIGIN"</span> <span class="s">always</span><span class="p">;</span>
    <span class="kn">add_header</span> <span class="s">X-XSS-Protection</span> <span class="s">"1</span><span class="p">;</span> <span class="kn">mode=block"</span> <span class="s">always</span><span class="p">;</span>
    <span class="kn">add_header</span> <span class="s">X-Content-Type-Options</span> <span class="s">"nosniff"</span> <span class="s">always</span><span class="p">;</span>
    
    <span class="c1"># 정적 파일 캐싱</span>
    <span class="kn">location</span> <span class="p">~</span><span class="sr">*</span> <span class="err">\</span><span class="s">.(jpg|jpeg|png|gif|ico|css|js)</span>$ <span class="p">{</span>
        <span class="kn">expires</span> <span class="s">1y</span><span class="p">;</span>
        <span class="kn">add_header</span> <span class="s">Cache-Control</span> <span class="s">"public,</span> <span class="s">immutable"</span><span class="p">;</span>
    <span class="p">}</span>
    
    <span class="c1"># PHP 처리 (필요시)</span>
    <span class="kn">location</span> <span class="p">~</span> <span class="sr">\.php$</span> <span class="p">{</span>
        <span class="kn">include</span> <span class="nc">snippets/fastcgi-php</span><span class="s">.conf</span><span class="p">;</span>
        <span class="kn">fastcgi_pass</span> <span class="s">unix:/var/run/php/php8.1-fpm.sock</span><span class="p">;</span>
    <span class="p">}</span>
    
    <span class="c1"># 숨겨진 파일 접근 차단</span>
    <span class="kn">location</span> <span class="p">~</span> <span class="sr">/\.</span> <span class="p">{</span>
        <span class="kn">deny</span> <span class="s">all</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="서버-블록-주요-지시어">서버 블록 주요 지시어</h3>

<h4 id="listen">listen</h4>
<div class="language-nginx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">listen</span> <span class="mi">80</span><span class="p">;</span>                    <span class="c1"># IPv4 80번 포트</span>
<span class="k">listen</span> <span class="s">[::]:80</span><span class="p">;</span>              <span class="c1"># IPv6 80번 포트</span>
<span class="k">listen</span> <span class="mi">80</span> <span class="s">default_server</span><span class="p">;</span>    <span class="c1"># 기본 서버</span>
<span class="k">listen</span> <span class="mi">443</span> <span class="s">ssl</span> <span class="s">http2</span><span class="p">;</span>        <span class="c1"># HTTPS with HTTP/2</span>
</code></pre></div></div>

<h4 id="server_name">server_name</h4>
<div class="language-nginx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">server_name</span> <span class="s">example.com</span><span class="p">;</span>                    <span class="c1"># 정확한 도메인</span>
<span class="k">server_name</span> <span class="s">*.example.com</span><span class="p">;</span>                  <span class="c1"># 와일드카드</span>
<span class="k">server_name</span> <span class="s">example.com</span> <span class="s">www.example.com</span><span class="p">;</span>    <span class="c1"># 여러 도메인</span>
<span class="k">server_name</span> <span class="p">~</span><span class="sr">^(\w+)\.example\.com$;</span>        <span class="c1"># 정규식</span>
</code></pre></div></div>

<h4 id="root와-index">root와 index</h4>
<div class="language-nginx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">root</span> <span class="n">/var/www/html</span><span class="p">;</span>                         <span class="c1"># 문서 루트</span>
<span class="k">index</span> <span class="s">index.html</span> <span class="s">index.htm</span> <span class="s">index.php</span><span class="p">;</span>      <span class="c1"># 인덱스 파일 우선순위</span>
</code></pre></div></div>

<h2 id="설정-테스트-및-서비스-관리">설정 테스트 및 서비스 관리</h2>

<h3 id="설정-파일-테스트">설정 파일 테스트</h3>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># 문법 검사</span>
<span class="nb">sudo </span>nginx <span class="nt">-t</span>

<span class="c"># 설정 덤프</span>
<span class="nb">sudo </span>nginx <span class="nt">-T</span>

<span class="c"># 특정 설정 파일 테스트</span>
<span class="nb">sudo </span>nginx <span class="nt">-t</span> <span class="nt">-c</span> /etc/nginx/nginx.conf
</code></pre></div></div>

<h3 id="서비스-관리">서비스 관리</h3>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># 서비스 시작</span>
<span class="nb">sudo </span>systemctl start nginx

<span class="c"># 서비스 중지</span>
<span class="nb">sudo </span>systemctl stop nginx

<span class="c"># 서비스 재시작</span>
<span class="nb">sudo </span>systemctl restart nginx

<span class="c"># 설정 리로드 (무중단)</span>
<span class="nb">sudo </span>systemctl reload nginx
<span class="nb">sudo </span>nginx <span class="nt">-s</span> reload

<span class="c"># 서비스 상태 확인</span>
<span class="nb">sudo </span>systemctl status nginx

<span class="c"># 서비스 활성화/비활성화</span>
<span class="nb">sudo </span>systemctl <span class="nb">enable </span>nginx
<span class="nb">sudo </span>systemctl disable nginx
</code></pre></div></div>

<h3 id="프로세스-신호">프로세스 신호</h3>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># 정상 종료</span>
<span class="nb">sudo </span>nginx <span class="nt">-s</span> quit

<span class="c"># 즉시 종료</span>
<span class="nb">sudo </span>nginx <span class="nt">-s</span> stop

<span class="c"># 설정 리로드</span>
<span class="nb">sudo </span>nginx <span class="nt">-s</span> reload

<span class="c"># 로그 파일 재오픈</span>
<span class="nb">sudo </span>nginx <span class="nt">-s</span> reopen
</code></pre></div></div>

<h2 id="기본-보안-설정">기본 보안 설정</h2>

<h3 id="서버-정보-숨기기">서버 정보 숨기기</h3>
<div class="language-nginx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># /etc/nginx/nginx.conf</span>
<span class="k">http</span> <span class="p">{</span>
    <span class="kn">server_tokens</span> <span class="no">off</span><span class="p">;</span>
    
    <span class="c1"># 커스텀 서버 헤더</span>
    <span class="kn">more_set_headers</span> <span class="s">"Server:</span> <span class="s">MyServer/1.0"</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="기본-보안-헤더">기본 보안 헤더</h3>
<div class="language-nginx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">server</span> <span class="p">{</span>
    <span class="c1"># 보안 헤더 추가</span>
    <span class="kn">add_header</span> <span class="s">X-Frame-Options</span> <span class="s">"SAMEORIGIN"</span> <span class="s">always</span><span class="p">;</span>
    <span class="kn">add_header</span> <span class="s">X-XSS-Protection</span> <span class="s">"1</span><span class="p">;</span> <span class="kn">mode=block"</span> <span class="s">always</span><span class="p">;</span>
    <span class="kn">add_header</span> <span class="s">X-Content-Type-Options</span> <span class="s">"nosniff"</span> <span class="s">always</span><span class="p">;</span>
    <span class="kn">add_header</span> <span class="s">Referrer-Policy</span> <span class="s">"no-referrer-when-downgrade"</span> <span class="s">always</span><span class="p">;</span>
    <span class="kn">add_header</span> <span class="s">Content-Security-Policy</span> <span class="s">"default-src</span> <span class="s">'self'</span> <span class="s">http:</span> <span class="s">https:</span> <span class="s">data:</span> <span class="s">blob:</span> <span class="s">'unsafe-inline'"</span> <span class="s">always</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="실습-예제">실습 예제</h2>

<h3 id="1-기본-html-사이트-구축">1. 기본 HTML 사이트 구축</h3>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># 웹 디렉토리 생성</span>
<span class="nb">sudo mkdir</span> <span class="nt">-p</span> /var/www/mysite

<span class="c"># HTML 파일 작성</span>
<span class="nb">sudo tee</span> /var/www/mysite/index.html <span class="o">&gt;</span> /dev/null <span class="o">&lt;&lt;</span> <span class="sh">'</span><span class="no">EOF</span><span class="sh">'
&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;title&gt;My Nginx Site&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;h1&gt;Welcome to My Nginx Site&lt;/h1&gt;
    &lt;p&gt;Server is running on Nginx!&lt;/p&gt;
&lt;/body&gt;
&lt;/html&gt;
</span><span class="no">EOF

</span><span class="c"># 사이트 설정 파일 생성</span>
<span class="nb">sudo tee</span> /etc/nginx/sites-available/mysite <span class="o">&gt;</span> /dev/null <span class="o">&lt;&lt;</span> <span class="sh">'</span><span class="no">EOF</span><span class="sh">'
server {
    listen 80;
    server_name mysite.local;
    root /var/www/mysite;
    index index.html;
    
    location / {
        try_files </span><span class="nv">$uri</span><span class="sh"> </span><span class="nv">$uri</span><span class="sh">/ =404;
    }
}
</span><span class="no">EOF

</span><span class="c"># 사이트 활성화</span>
<span class="nb">sudo ln</span> <span class="nt">-s</span> /etc/nginx/sites-available/mysite /etc/nginx/sites-enabled/

<span class="c"># 설정 테스트 및 리로드</span>
<span class="nb">sudo </span>nginx <span class="nt">-t</span>
<span class="nb">sudo </span>systemctl reload nginx
</code></pre></div></div>

<h3 id="2-로그-분석을-위한-커스텀-로그-형식">2. 로그 분석을 위한 커스텀 로그 형식</h3>
<div class="language-nginx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">http</span> <span class="p">{</span>
    <span class="kn">log_format</span> <span class="s">detailed</span> <span class="s">'</span><span class="nv">$remote_addr</span> <span class="s">-</span> <span class="nv">$remote_user</span> <span class="s">[</span><span class="nv">$time_local</span><span class="s">]</span> <span class="s">'</span>
                       <span class="s">'"</span><span class="nv">$request</span><span class="s">"</span> <span class="nv">$status</span> <span class="nv">$body_bytes_sent</span> <span class="s">'</span>
                       <span class="s">'"</span><span class="nv">$http_referer</span><span class="s">"</span> <span class="s">"</span><span class="nv">$http_user_agent</span><span class="s">"</span> <span class="s">'</span>
                       <span class="s">'</span><span class="nv">$request_time</span> <span class="nv">$upstream_response_time</span><span class="s">'</span><span class="p">;</span>
    
    <span class="kn">server</span> <span class="p">{</span>
        <span class="kn">access_log</span> <span class="n">/var/log/nginx/detailed.log</span> <span class="s">detailed</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="문제-해결">문제 해결</h2>

<h3 id="일반적인-오류들">일반적인 오류들</h3>

<h4 id="1-포트-바인딩-실패">1. 포트 바인딩 실패</h4>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># 포트 사용 확인</span>
<span class="nb">sudo </span>netstat <span class="nt">-tlnp</span> | <span class="nb">grep</span> :80
<span class="nb">sudo </span>lsof <span class="nt">-i</span> :80

<span class="c"># 다른 웹 서버 중지</span>
<span class="nb">sudo </span>systemctl stop apache2
</code></pre></div></div>

<h4 id="2-권한-문제">2. 권한 문제</h4>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># 파일 권한 설정</span>
<span class="nb">sudo chown</span> <span class="nt">-R</span> www-data:www-data /var/www/
<span class="nb">sudo chmod</span> <span class="nt">-R</span> 755 /var/www/

<span class="c"># SELinux 문제 (CentOS/RHEL)</span>
<span class="nb">sudo </span>setsebool <span class="nt">-P</span> httpd_can_network_connect 1
<span class="nb">sudo </span>restorecon <span class="nt">-R</span> /var/www/
</code></pre></div></div>

<h4 id="3-설정-파일-오류">3. 설정 파일 오류</h4>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># 상세한 오류 확인</span>
<span class="nb">sudo </span>nginx <span class="nt">-t</span> 2&gt;&amp;1

<span class="c"># 로그 확인</span>
<span class="nb">sudo tail</span> <span class="nt">-f</span> /var/log/nginx/error.log
</code></pre></div></div>

<h2 id="다음-단계">다음 단계</h2>

<p>이번 포스트에서는 Nginx의 기본 설치와 설정에 대해 알아보았습니다. 다음 포스트에서는:</p>

<ul>
  <li>Virtual Host 설정</li>
  <li>로드 밸런싱 구성</li>
  <li>SSL/TLS 설정</li>
  <li>업스트림 서버 설정</li>
</ul>

<p>에 대해 자세히 다루겠습니다.</p>

<h2 id="참고-자료">참고 자료</h2>

<ul>
  <li><a href="https://nginx.org/en/docs/">Nginx 공식 문서</a></li>
  <li><a href="https://www.nginx.com/resources/wiki/start/">Nginx 설정 가이드</a></li>
  <li><a href="https://github.com/trimstray/nginx-admins-handbook">Nginx 보안 가이드</a></li>
</ul>

  </div>

  <footer class="post-footer">
    <div class="post-navigation"><div class="nav-previous">
        <a href="/infra-blog/blog/2024/03/26/aws-cloudformation-iac-cicd.html" rel="prev">
          <i class="icon-left-arrow"></i>
          <span class="nav-title">AWS 완전 정복 가이드 4편 - CloudFormation IaC와 CI/CD 파이...</span>
        </a>
      </div><div class="nav-next">
        <a href="/infra-blog/blog/2024/05/16/nginx-configuration-guide-part2.html" rel="next">
          <span class="nav-title">Nginx 설정 가이드 Part 2 - Virtual Host, 로드 밸런싱, SSL...</span>
          <i class="icon-right-arrow"></i>
        </a>
      </div></div>
  </footer>
  </article></div>

    </section>
    <footer class="condensed">
      <ul class="social about-footer condensed"><a href="https://github.com/leeyonghe" target="_blank">
          <li>
            <i class="icon-github-circled"></i>
          </li>
        </a><a href="https://www.linkedin.com/in/lee-yong-hee-18912454/" target="_blank">
          <li>
            <i class="icon-linkedin-squared"></i>
          </li>
        </a><!----></ul><p class="about-footer condensed">&copy;
        2025</p><div class="about-footer condensed">
        <p>Dark Mode
          <i class="icon-moon"></i>
          <label class="switch">
            <input type="checkbox" class="dark-mode-toggle">
            <span class="slider round" onclick="toggleDarkMode()"></span>
          </label>
        </p>
      </div>
    </footer>
  </main>
  
  <script type="text/javascript" src="/infra-blog/assets/js/darkmode.js"></script>
  
  <script src="/infra-blog/assets/js/simple-jekyll-search.min.js"></script>
  <script src="/infra-blog/assets/js/search.js"></script>
  
</body>

</html>
